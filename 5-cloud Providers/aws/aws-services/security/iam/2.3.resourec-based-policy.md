# **Resource-Based Policies in AWS** ðŸ”’

Resource-based policies are policies that are directly attached to AWS resources, rather than being assigned to IAM identities such as users, groups, or roles. These policies define **who** (the principal) can access the resource and what actions they can perform on it.

## Key Features of Resource-Based Policies:

- **Attach to Resources**: They are applied to specific AWS resources like S3 buckets, Lambda functions, SQS queues, etc.
- **Principal Element**: The `Principal` element identifies the AWS identities (users, roles, services) that are allowed or denied access to the resource.
- **Cross-Account Access**: Resource-based policies allow sharing of resources across different AWS accounts.
- **Inline Policies**: Resource policies are inline (not managed) policies, meaning they exist only on the resource they are attached to.

## Example of a Resource-Based Policy

### 1. **S3 Bucket Policy**

```json
/* This policy allows all users (public access) to read objects from the S3 bucket named example_bucket. This is useful for static website hosting or sharing publicly accessible files.*/

{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": "*",
      "Action": "s3:GetObject",
      "Resource": "arn:aws:s3:::example_bucket/*"
    }
  ]
}
```

```json
/* this policy allows a specific IAM user (`bob`) from a different AWS account to upload objects to the `example-bucket`*/
{
  "Version": "2012-10-17",
  "Statement": {
    "Effect": "Allow",
    "Principal": { "AWS": "arn:aws:iam::777788889999:user/bob" },
    "Action": ["s3:PutObject", "s3:PutObjectAcl"],
    "Resource": "arn:aws:s3:::example-bucket/*"
  }
}
```

### 2. **AWS Lambda Function Policy**

```json
/* This policy allows an Amazon S3 bucket to invoke a Lambda function named example_function whenever a new object is created in the bucket. This is useful for triggering Lambda functions based on S3 events.*/

{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
        "Service": "s3.amazonaws.com"
      },
      "Action": "lambda:InvokeFunction",
      "Resource": "arn:aws:lambda:us-west-2:123456789012:function:example_function",
      "Condition": {
        "StringEquals": {
          "AWS:SourceAccount": "123456789012"
        },
        "ArnLike": {
          "AWS:SourceArn": "arn:aws:s3:::example_bucket"
        }
      }
    }
  ]
}
```

### 3. **SNS Topic Policy**

```json
/* This policy allows an AWS account (with account ID 987654321098) to publish messages to an SNS topic named example_topic. This is useful for cross-account communication or integrating services from different AWS accounts.*/

{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::987654321098:root"
      },
      "Action": "sns:Publish",
      "Resource": "arn:aws:sns:us-west-2:123456789012:example_topic"
    }
  ]
}
```

## **IAM Resource-Based Policies vs. IAM Roles for Cross-Account Access** ðŸ”„

### **Difference between Resource-Based Policies and IAM Roles**

- **Resource-Based Policies**: A resource-based policy directly allows or denies actions on a resource (e.g., an S3 bucket or SQS queue) for specific principals (such as users, roles, or services). The principal does not need to give up its permissions when accessing the resource, as the policy is directly tied to the resource itself.

- **IAM Roles for Cross-Account Access**: When using IAM roles for cross-account access, the principal temporarily assumes the permissions granted by the IAM role, meaning it "gives up" its original permissions to inherit those of the role.

### **When to Use Resource-Based Policies**

Resource-based policies are ideal when you want to share a resource across different accounts without needing to reassign the principalâ€™s permissions. For example, you might want to allow a user in another AWS account to upload objects to your S3 bucket.

## **Conclusion** ðŸŒŸ

Resource-Based Policies are essential for controlling access to AWS resources, especially for cross-account scenarios or when a resource needs to share access across different identities. By using these policies, you can ensure secure and granular access control without the need for IAM role assumptions. Additionally, **Permissions Boundaries** and the **IAM Policy Evaluation Logic** provide advanced control over what permissions are granted, ensuring your AWS environment is both flexible and secure.
