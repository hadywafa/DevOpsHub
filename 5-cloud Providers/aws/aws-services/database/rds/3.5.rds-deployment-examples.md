# **AWS RDS architecture design**

## **ğŸ“Œ Design 1: Multi-AZ Deployment + Read Replica (Cross-Region Replication)**

### **ğŸ–¼ï¸ Image 1**

<div style="text-align: center;">
  <img src="images/read-replicas-for-multi-az.png" style="border-radius: 10px;" alt="Multi-AZ Deployment + Read Replica">
</div>

### **ğŸ” Overview**

- **Primary DB Instance (M)**
- **Standby DB Instance (S) (Multi-AZ - Sync Replication)**
- **Read Replica (R) in the Same Region (Async Replication)**
- **Cross-Region Read Replica (R) in a different region (Async Replication)**

### âœ… **Key Features**

- **Synchronous Replication** between **Primary (M) and Standby (S)** for high availability.
- **Asynchronous Replication** for **Read Replicas (R)** for read scaling.
- **Cross-Region Read Replica** for **disaster recovery**.

---

### **ğŸ›  How to Implement**

#### **1ï¸âƒ£ Enable Multi-AZ Deployment**

**AWS Console Steps**:

1. Navigate to **RDS Console** â†’ Select your **DB Instance**.
2. Click **Modify** â†’ Enable **Multi-AZ Deployment**.
3. Apply the changes (**No downtime required**).

**AWS CLI Command**:

```sh
aws rds modify-db-instance \
    --db-instance-identifier mydb \
    --multi-az \
    --apply-immediately
```

---

#### **2ï¸âƒ£ Create Read Replica in the Same Region**

**AWS Console Steps**:

1. Navigate to **RDS Console** â†’ Select your **Primary DB Instance**.
2. Click **Actions** â†’ **Create Read Replica**.
3. Choose **same AWS region**.
4. Configure instance type and storage â†’ Click **Create**.

**AWS CLI Command**:

```sh
aws rds create-db-instance-read-replica \
    --db-instance-identifier my-read-replica \
    --source-db-instance-identifier mydb \
    --region us-east-1
```

---

#### **3ï¸âƒ£ Create Cross-Region Read Replica**

**AWS Console Steps**:

1. Navigate to **RDS Console** â†’ Select your **Primary DB Instance**.
2. Click **Actions** â†’ **Create Read Replica**.
3. Choose a **different AWS region**.
4. Configure instance type and storage â†’ Click **Create**.

**AWS CLI Command**:

```sh
aws rds create-db-instance-read-replica \
    --db-instance-identifier my-cross-region-replica \
    --source-db-instance-identifier mydb \
    --region us-west-2
```

---

### **ğŸ“Œ Supported Engines**

âœ” **MySQL**  
âœ” **PostgreSQL**  
âœ” **MariaDB**  
âœ” **Oracle**  
âœ” **Amazon Aurora (MySQL-Compatible)**  
âœ” **Amazon Aurora (PostgreSQL-Compatible)**

---

## **ğŸ“Œ Design 2: Single-AZ Deployment + Read Replicas**

### **ğŸ–¼ï¸ Image 2**

![Single-AZ Deployment + Read Replica](images/read-replicas-for-standalone.png)

### **ğŸ” Overview**

- **Primary DB Instance (M)**
- **Two Read Replicas (R) (Same Region & Cross-Region)**
- **No Standby Instance (Not Multi-AZ)**

### âœ… **Key Features**

- **Asynchronous Replication** to Read Replicas.
- **No automatic failover** (because it's Single-AZ).
- **Cross-Region Read Replica** for **disaster recovery**.

---

### **ğŸ›  How to Implement**

#### **1ï¸âƒ£ Create a Single-AZ RDS Instance**

**AWS Console Steps**:

1. Go to **RDS Console** â†’ Click **Create Database**.
2. Choose **Single-AZ Deployment**.
3. Configure instance type, storage, and database settings â†’ Click **Create**.

**AWS CLI Command**:

```sh
aws rds create-db-instance \
    --db-instance-identifier mydb \
    --db-instance-class db.t3.medium \
    --engine mysql \
    --allocated-storage 20 \
    --no-multi-az
```

---

#### **2ï¸âƒ£ Create Read Replica in the Same Region**

**AWS Console Steps**:

1. Go to **RDS Console** â†’ Select your **Primary DB Instance**.
2. Click **Actions** â†’ **Create Read Replica**.
3. Choose **same AWS region**.
4. Click **Create**.

**AWS CLI Command**:

```sh
aws rds create-db-instance-read-replica \
    --db-instance-identifier my-read-replica \
    --source-db-instance-identifier mydb \
    --region us-east-1
```

---

#### **3ï¸âƒ£ Create Cross-Region Read Replica**

**AWS Console Steps**:

1. Go to **RDS Console** â†’ Select your **Primary DB Instance**.
2. Click **Actions** â†’ **Create Read Replica**.
3. Choose a **different AWS region**.
4. Click **Create**.

**AWS CLI Command**:

```sh
aws rds create-db-instance-read-replica \
    --db-instance-identifier my-cross-region-replica \
    --source-db-instance-identifier mydb \
    --region us-west-2
```

---

### **ğŸ“Œ Supported Engines**

âœ” **MySQL**  
âœ” **PostgreSQL**  
âœ” **MariaDB**  
âœ” **Oracle**  
âœ” **Amazon Aurora (MySQL-Compatible)**  
âœ” **Amazon Aurora (PostgreSQL-Compatible)**

---

## **ğŸ“Œ Design 3: Cross-Region Read Replica with Multi-AZ** ğŸŒ

### **ğŸ–¼ï¸ Architecture Diagram**

![Cross-Region Multi-AZ Read Replica](images/read-replicas-with-multi-az.png)

---

### **ğŸ” Overview**

This architecture enhances **disaster recovery** by deploying a **cross-region read replica with Multi-AZ enabled**, allowing **automatic failover within the secondary region** while maintaining high availability.

#### **ğŸ“Œ Components**

- **Primary DB Instance (M) â€“ Region A**
- **Standby DB Instance (S) â€“ Region A** (**Multi-AZ, Synchronous Replication**)
- **Read Replica (R) â€“ Region A** (**Async Replication for Scaling Reads**)
- **Cross-Region Read Replica (R) â€“ Region B** (**Async Replication for Disaster Recovery**)
- **Cross-Region Read Replica (R) with Multi-AZ â€“ Region B** (**Automatic Failover in the Secondary Region**)

---

#### **âœ… Key Features**

âœ” **High Availability & Disaster Recovery** â€“ Ensures automatic failover within **both primary and secondary regions**.  
âœ” **Synchronous Replication in Primary Region** â€“ Ensures zero data loss between **Primary (M) and Standby (S)**.  
âœ” **Asynchronous Replication for Read Replicas** â€“ Offloads read traffic and provides **cross-region failover capability**.  
âœ” **Cross-Region Read Replica with Multi-AZ** â€“ Ensures high availability in **Region B** in case of a failure in **Region A**.  
âœ” **Failover to the Cross-Region Replica is Manual** â€“ AWS does **not** automatically promote cross-region read replicas.

---

### **ğŸ›  How to Implement**

#### **1ï¸âƒ£ Enable Multi-AZ for the Primary Instance**

1. **AWS Console Steps**:

   - Navigate to **RDS Console** â†’ Select **Primary DB Instance**.
   - Click **Modify** â†’ Enable **Multi-AZ Deployment**.
   - Apply changes (**No downtime required**).

2. **AWS CLI Command**:

```sh
aws rds modify-db-instance \
    --db-instance-identifier mydb \
    --multi-az \
    --apply-immediately
```

---

#### **2ï¸âƒ£ Create a Read Replica in the Same Region (Region A)**

1. **AWS Console Steps**:

   - Navigate to **RDS Console** â†’ Select **Primary DB Instance**.
   - Click **Actions** â†’ **Create Read Replica**.
   - Choose **Same AWS Region (Region A)**.
   - Configure instance type and storage â†’ Click **Create**.

2. **AWS CLI Command**:

```sh
aws rds create-db-instance-read-replica \
    --db-instance-identifier my-read-replica \
    --source-db-instance-identifier mydb \
    --region us-east-1
```

---

#### **3ï¸âƒ£ Create a Cross-Region Read Replica (Region B)**

1. **AWS Console Steps**:

   - Navigate to **RDS Console** â†’ Select **Primary DB Instance**.
   - Click **Actions** â†’ **Create Read Replica**.
   - Choose a **Different AWS Region (Region B)**.
   - Configure instance type and storage â†’ Click **Create**.

2. **AWS CLI Command**:

```sh
aws rds create-db-instance-read-replica \
    --db-instance-identifier my-cross-region-replica \
    --source-db-instance-identifier mydb \
    --region us-west-2
```

---

#### **4ï¸âƒ£ Enable Multi-AZ for the Cross-Region Read Replica**

1. **AWS Console Steps**:

   - Navigate to **RDS Console** â†’ Select the **Cross-Region Read Replica**.
   - Click **Modify** â†’ Enable **Multi-AZ Deployment**.
   - Apply changes (**No downtime required**).

2. **AWS CLI Command**:

```sh
aws rds modify-db-instance \
    --db-instance-identifier my-cross-region-replica \
    --multi-az \
    --apply-immediately
```

---

#### **5ï¸âƒ£ (Optional) Promote Cross-Region Read Replica as New Primary**

ğŸš¨ **If the primary region fails, manual intervention is required to promote the Cross-Region Read Replica to a standalone primary database.**

1. **AWS Console Steps**:

   - Navigate to **RDS Console** â†’ Select **Cross-Region Read Replica**.
   - Click **Actions** â†’ **Promote Read Replica**.
   - Confirm the action (**This process is irreversible**).

2. **AWS CLI Command**:

```sh
aws rds promote-read-replica \
    --db-instance-identifier my-cross-region-replica
```

### **ğŸ“Œ Supported Engines**

âœ” **MySQL**  
âœ” **PostgreSQL**  
âœ” **MariaDB**  
âœ” **Oracle**  
âœ” **Amazon Aurora (MySQL-Compatible)**  
âœ” **Amazon Aurora (PostgreSQL-Compatible)**

---

## **ğŸ“Š Final Comparison Table**

| Feature              | **Multi-AZ + Read Replica**      | **Single-AZ + Read Replica** | **Cross-Region Read Replica (Multi-AZ)**      |
| -------------------- | -------------------------------- | ---------------------------- | --------------------------------------------- |
| **Replication Type** | Sync (Standby) + Async (Replica) | Async Only                   | Sync (Multi-AZ in Region B) + Async (Replica) |
| **Read Traffic**     | âœ… Yes (Replica)                 | âœ… Yes                       | âœ… Yes (Replica)                              |
| **Failover Support** | âœ… Automatic (Multi-AZ Standby)  | âŒ No                        | âœ… Automatic (Multi-AZ Replica in Region B)   |
| **Cross-Region DR**  | âŒ No                            | âŒ No                        | âœ… Yes (Read Replica in Region B)             |
| **Use Case**         | HA + Scaling                     | Scaling                      | HA + Global DR                                |

---

## **ğŸ¯ Summary**

âœ… **Multi-AZ Standby is within the same AWS region** (synchronous replication).  
âœ… **Cross-Region Read Replicas use asynchronous replication**, ensuring **disaster recovery**.  
âœ… **Cross-Region Read Replicas can be Multi-AZ**, improving high availability in the secondary region.  
âœ… **Failover to a Cross-Region Read Replica is manual**â€”AWS does not automatically promote it.

ğŸš€ **With this architecture, you get high availability, scalability, and disaster recovery across regions!**
