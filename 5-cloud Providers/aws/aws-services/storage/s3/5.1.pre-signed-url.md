# 🔗 **Amazon S3 Pre-Signed URLs**

## 📌 **Definition**

A **Pre-Signed S3 URL** is a **temporary URL** that provides **secure access to an S3 object** without requiring authentication. It allows users, applications, or AWS services to **upload or download files** to/from Amazon S3 for a limited time.

👉 **Key Features of Pre-Signed URLs**:  
✅ **Temporary Access** – Only valid for a set duration (e.g., 15 minutes, 1 hour).  
✅ **Secure** – Only authorized users with the URL can access the object.  
✅ **No Need for AWS Credentials** – The user doesn’t need an AWS IAM role or access keys.  
✅ **Supports Uploads and Downloads** – You can create a **pre-signed URL for PUT (upload) or GET (download)** operations.

---

## 🔒 **Overview of S3 Pre-Signed URLs**

- **🔐 Private by Default:**

  - All objects in Amazon S3 are **private** by default, ensuring that only authorized users can access them.

- **🔗 Secure Sharing:**

  - The **object owner** can share access by creating a **pre-signed URL** using their own security credentials.

- **🔑 Object-Specific:**

  - **Signed URLs** are **object-specific**, granting access to a single object per URL.

- **👥 Versatile Creation Entities:**

  - The entity that creates the signed URL can be an **IAM user**, **root account**, **EC2 instance/application**, or anyone with an **STS token**.

- **🔓 Private Bucket Compatibility:**
  - Pre-Signed URLs work even with **private buckets** and **private objects**, providing controlled access without altering bucket permissions.

---

## 🕒 **How S3 Pre-Signed URLs Work**

Amazon S3 generates a URL that grants temporary access to an object. This URL includes authentication parameters, ensuring that only users with the URL can access the object within the specified time frame.

### **🔄 Access Control:**

- **📅 Expiration Management:**

  - Amazon S3 checks the **expiration date and time** of a signed URL during each HTTP request to ensure its validity.

- **⏰ Validity Duration:**
  - Depending on the generation method (**CLI**, **SDK**, **Console**), the **signed URL** can be valid for up to **7 days**.

### **📤 Upload Capabilities:**

- **🔄 Pre-Signed URLs for Uploads:**
  - Pre-Signed URLs can also be used to **upload objects** to a private bucket. This can be done **through SDKs only**.

---

## 🛠️ **How to Generate Pre-Signed URLs**

### 🔧 **Using the AWS Management Console**

1. **Navigate to the S3 Console:**

   - Log in to the [AWS Management Console](https://console.aws.amazon.com/s3/) and open the **S3** service.

2. **Select the Object:**

   - Browse to your bucket and select the object you want to share.

3. **Generate Pre-Signed URL:**

   - Click on the **"Share"** button or **"Actions"** dropdown.
   - Select **"Create Pre-Signed URL"**.
   - Set the **expiration time** for the URL.
   - Click **"Generate URL"**.

4. **Share the URL:**
   - Copy the generated URL and share it with the intended recipients.

### 🖥️ **Using the AWS CLI**

1. **Install AWS CLI:**

   - Ensure you have the [AWS CLI](https://aws.amazon.com/cli/) installed and configured with the necessary permissions.

2. **Generate Pre-Signed URL:**

   - Use the following command to generate a pre-signed URL for downloading an object:

     ```bash
     aws s3 presign s3://your-bucket-name/your-object-key --expires-in 3600
     ```

     - Replace `your-bucket-name` with your bucket's name.
     - Replace `your-object-key` with the object's key.
     - `--expires-in` specifies the URL's validity in seconds (e.g., `3600` seconds = 1 hour).

3. **Upload Using Pre-Signed URL:**

   - To generate a pre-signed URL for uploading an object:

     ```bash
     aws s3 presign s3://your-bucket-name/your-object-key --expires-in 3600 --http-method PUT
     ```

     - Use the generated URL to upload the object via HTTP PUT request.

### 🛠 **Using Python (Boto3)**

To generate a pre-signed URL, you need **AWS SDK (Boto3 in Python)**:

#### 🎯 **Example 1: Generate a Pre-Signed URL for Uploading a File**

This generates a URL valid for **60 minutes** that allows a user to upload a file to S3.

```python
import boto3

s3_client = boto3.client('s3')

bucket_name = "my-example-bucket"
object_key = "uploads/myfile.txt"

# Generate a pre-signed URL for file upload (PUT request)
upload_url = s3_client.generate_presigned_url(
    'put_object',
    Params={'Bucket': bucket_name, 'Key': object_key},
    ExpiresIn=3600  # 1 hour
)

print("Pre-Signed URL for Upload:", upload_url)
```

💡 **How It Works**:

- The function `generate_presigned_url()` creates a **PUT request URL**.
- The generated **upload URL** is valid for **1 hour**.
- Any client can now **upload a file** to this URL **without needing AWS credentials**.

**Client Uploads the File Using cURL:**

Once the **pre-signed URL** is generated, you can use `cURL` or any HTTP client to **upload the file**:

```sh
curl -X PUT -T myfile.txt "https://my-example-bucket.s3.amazonaws.com/uploads/myfile.txt?AWSAccessKeyId=...&Signature=..."
```

---

#### 🎯 **Example 2: Generate a Pre-Signed URL for Downloading a File**

This generates a **temporary URL** for downloading a file.

```python
download_url = s3_client.generate_presigned_url(
    'get_object',
    Params={'Bucket': bucket_name, 'Key': object_key},
    ExpiresIn=600  # 10 minutes
)

print("Pre-Signed URL for Download:", download_url)
```

💡 **Now, anyone with the URL can download the file within 10 minutes!**

---

## 📝 **Important Notes**

- **⏳ Expiration Management:**

  - Ensure that the expiration time aligns with your security and access requirements.

- **🔑 Security Best Practices:**

  - Generate pre-signed URLs using secure methods and manage IAM permissions carefully to prevent unauthorized access.

- **🔄 Version Control:**

  - Pre-signed URLs are tied to specific object versions, ensuring access to the intended data.

- **🚫 HTTPS Limitation for Glacier:**
  - S3 Select on Glacier does not support HTTPS; use CloudFront for secure access if needed.
