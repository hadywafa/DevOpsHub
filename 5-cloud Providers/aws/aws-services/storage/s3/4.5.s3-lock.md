# ğŸ”’ **Amazon S3 Object Lock**

Amazon S3 **Object Lock** is a powerful feature that provides a **Write Once Read Many (WORM)** storage model. It helps you **prevent data from being deleted or overwritten** for a fixed time or indefinitely. This is critical for industries that need to meet strict **regulatory compliance**, retain immutable logs, or enforce legal holds.

<div align="center">
  <img src="images/s3-object-lock.png" style="border-radius: 10px;" alt="s3-object-lock">
</div>

---

## ğŸŒŸ **What is Amazon S3 Object Lock?**

S3 Object Lock lets you store objects in S3 in a way that **prevents deletion or overwrite**. You can enforce this at:

- ğŸ”¹ **Object Level** â€” Specific objects can be locked
- ğŸ”¹ **Bucket Level** â€” All objects in the bucket are protected by default

ğŸ” **Versioning is required** for Object Lock to work.

---

## ğŸ§© **Key Features**

| Feature                    | Description                                                   |
| -------------------------- | ------------------------------------------------------------- |
| ğŸ›¡ï¸ **WORM Protection**     | Enforces data immutability for compliance and data protection |
| ğŸ“ **Scope**               | Object-level or bucket-level protection                       |
| ğŸ”— **Replication Support** | Works with CRR/SRR to replicate locked data securely          |
| ğŸ”„ **Versioning Required** | Versioning must be enabled for any Object Lock to take effect |

---

## ğŸ“œ **Retention Modes**

### ğŸ›¡ï¸ **Governance Mode**

- Prevents most users from deleting/modifying data.
- Admins with `s3:BypassGovernanceRetention` can override.
- Good for internal data protection.

### ğŸ” **Compliance Mode**

- Even the root user cannot delete or overwrite the object.
- Cannot shorten or remove lock before the expiration.
- Perfect for strict legal/regulatory compliance (e.g., SEC, FINRA).

---

## â³ **Retention Controls**

### ğŸ“… **Retention Period**

- You can define a **specific period** for object protection.
- During this period, the object **cannot be modified or deleted**.

### ğŸ“‘ **Legal Hold**

- Prevents deletion **indefinitely** until manually removed.
- Doesnâ€™t require a set duration.

âœ… **You can combine both Retention + Legal Hold for layered protection.**

---

## âš™ï¸ **How to Enable Object Lock**

### ğŸ”§ **Step-by-Step:**

1ï¸âƒ£ **Enable at Bucket Creation**

- Must be turned on when the bucket is created â€” canâ€™t enable it later.

2ï¸âƒ£ **Enable Versioning**

- Mandatory for Object Lock to work.

3ï¸âƒ£ **Set Retention Mode & Period**

- Choose Governance or Compliance.
- Specify retention duration (days/years).

4ï¸âƒ£ **Apply Legal Hold (Optional)**

```json
{
  "LegalHold": "ON"
}
```

---

## â„ï¸ **Object Lock for Glacier Vaults**

S3 Glacier Vaults support similar immutability through **Vault Lock Policies**:

- ğŸ” Archives can be made immutable for legal retention.
- ğŸ“… Retain archives for set duration (e.g., 365 days).
- ğŸ•µï¸â€â™€ï¸ Block deletion based on tags for audits/legal cases.

---

## âœ… **Benefits of Object Lock**

### ğŸ” **Data Protection**

- Prevents accidental deletion or overwriting.
- Enables immutable backups and logs.

### ğŸ“‹ **Compliance**

- Supports standards like **SEC 17a-4**, **HIPAA**, **FINRA**.
- Enforces immutability using technology, not policy.

### ğŸ’° **Cost Optimization**

- Use Lifecycle Policies to move non-current versions to cheaper tiers (Glacier, Deep Archive).

---

## ğŸ“ **Important Notes**

- âš ï¸ **Locks are irreversible** â€” once set, you can't shorten or remove before expiration (unless in Governance Mode with override).
- ğŸ”’ **Secure IAM roles** â€” Only allow trusted roles to apply/remove legal holds or change lock settings.
- ğŸŒ **Replication Compatibility** â€” Ensure destination buckets also have versioning enabled to replicate Object Lock settings correctly.

---

## ğŸ“¦ **Real-Life Use Case: Terraform State Locking**

Want to protect your Terraform remote state?

- Store backend state in S3
- Use **DynamoDB table for state locking**
- Pair with S3 Object Lock for extra immutability

[ğŸ”— Guide: Setup Terraform S3 Backend with Locking](https://devopscube.com/setup-terraform-remote-state-s3-dynamodb/)

<div align="center">
  <img src="images/lock-terraform-state-with-dynamodb.gif" style="border-radius: 10px;" alt="lock-terraform-state-with-dynamodb">
</div>
