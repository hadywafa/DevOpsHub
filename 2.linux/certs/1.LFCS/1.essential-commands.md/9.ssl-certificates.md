# ğŸ” **What is SSL/TLS?**

SSL/TLS provides **encryption** and **identity verification** for network communication.

HTTPS = HTTP + TLS
SSH = Secure Shell
SMTP/TLS, FTPS, etc.

TLS uses:

- **Private key** â†’ your secret
- **Certificate** â†’ your public identity
- **CA certificate** â†’ trust anchor issued by Certificate Authority

---

## ğŸ§© **Three Components You MUST Understand**

Every SSL system has 3 parts:

### 1ï¸âƒ£ **Private Key (.key)**

- Secret
- Must never be shared
- Used to sign data
- Proves server identity

### 2ï¸âƒ£ **CSR (.csr)** (_Certificate Signing Request_)

- Contains public key + metadata
- Sent to a CA to request a certificate

### 3ï¸âƒ£ **Certificate (.crt, .pem)**

- Contains public key + identity
- Signed by CA
- Given to clients to trust your server

---

## ğŸ›ï¸ **Certificate Authority (CA)**

### ğŸ“Œ Root CA

Top-level, trusted by browsers (e.g., DigiCert, GlobalSign).

### ğŸ“Œ Intermediate CA

Issued by root CA.
Used to sign server certificates.

### ğŸ“Œ Server Certificate

Signed by intermediate â†’ installed on webserver.

---

## ğŸ§  Trust Chain (Never Forget)

```ini
Root CA
   â†“ signs
Intermediate CA
   â†“ signs
Server Certificate (yoursite.com)
```

Browser trusts server because it trusts the chain.

---

## ğŸŸ¦ **1. Generate a Private Key (OpenSSL)**

### 1. Generate RSA private key (2048 bits)

```bash
openssl genrsa -out server.key 2048
```

### 2. Generate RSA private key (4096 bits)

```bash
openssl genrsa -out server.key 4096
```

### 3. Generate modern ECDSA private key (recommended)

```bash
openssl ecparam -genkey -name prime256v1 -out server.key
```

---

## ğŸŸ© **2. Generate CSR (Certificate Signing Request)**

Using an existing key:

```bash
openssl req -new -key server.key -out server.csr
```

You will be asked:

- Country
- State
- Organization
- Common Name (â†’ your domain: **example.com**)

### Non-interactive CSR creation:

```ini
openssl req -new -key server.key -out server.csr \
    -subj "/C=US/ST=CA/L=LA/O=MyCompany/OU=IT/CN=example.com"
```

---

## ğŸŸ¥ **3. Generate a Self-Signed Certificate (no CA needed)**

Great for:

- Testing
- Local development
- Internal services

```bash
openssl req -x509 -new -nodes \
  -key server.key \
  -sha256 -days 365 \
  -out server.crt
```

Creates:

- `server.key` â†’ private key
- `server.crt` â†’ certificate

---

## ğŸ›ï¸ **Create Your Own Root CA (For Learning & Internal PKI)**

### 1. Generate root CA key:

```bash
openssl genrsa -out rootCA.key 4096
```

### 2. Generate root CA certificate:

```bash
openssl req -x509 -new -nodes -key rootCA.key \
  -sha256 -days 3650 -out rootCA.pem
```

This root CA can now sign certificates.

---

## ğŸ–‹ï¸ **Sign a Server Certificate Using Your Own CA**

### 1. Create server key:

```bash
openssl genrsa -out server.key 2048
```

### 2. Create CSR:

```bash
openssl req -new -key server.key -out server.csr
```

### 3. Sign CSR with root CA:

```bash
openssl x509 -req \
  -in server.csr \
  -CA rootCA.pem \
  -CAkey rootCA.key \
  -CAcreateserial \
  -out server.crt \
  -days 825 \
  -sha256
```

Now you have a **trusted chain** using your CA.

---

## ğŸ‘€ **View or Inspect Certificates**

### View certificate details:

```bash
openssl x509 -in server.crt -text -noout
```

### View CSR details:

```bash
openssl req -in server.csr -text -noout
```

### View private key:

```bash
openssl rsa -in server.key -check
```

---

## ğŸ§ª **Test SSL Connectivity to a Server**

### Check certificate from remote server:

```bash
openssl s_client -connect example.com:443
```

Shows:

- certificate chain
- TLS handshake
- cipher used
- expiration dates

---

## ğŸ§® **Convert Certificate Formats**

### PEM â†’ DER

```ini
openssl x509 -in cert.pem -out cert.der -outform der
```

### DER â†’ PEM

```ini
openssl x509 -in cert.der -inform der -out cert.pem
```

---

### Create PKCS#12 / PFX file (for Windows/IIS)

```ini
openssl pkcs12 -export \
  -out bundle.pfx \
  -inkey server.key \
  -in server.crt \
  -certfile intermediate.crt
```

---

## ğŸŸ« **Create Full Chain File (often required for Apache/Nginx)**

Concatenate:

```ini
cat server.crt intermediate.crt > fullchain.pem
```

---

## ğŸŸª **SSL Certificate File Types (Never Forget)**

| Extension   | Meaning                          |
| ----------- | -------------------------------- |
| `.key`      | private key                      |
| `.csr`      | signing request                  |
| `.crt`      | certificate                      |
| `.pem`      | Base64 encoded cert/key          |
| `.cer`      | same as .crt                     |
| `.der`      | binary certificate               |
| `.pfx/.p12` | certificate + private key bundle |

---

## ğŸ“ **Real DevOps Examples**

### âœ” Renewing SSL for Nginx (self-signed)

```ini
openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365
```

### âœ” Validate certificate expiration

```ini
openssl x509 -in cert.pem -noout -enddate
```

### âœ” Check if private key matches certificate

```ini
openssl rsa -noout -modulus -in server.key | openssl md5
openssl x509 -noout -modulus -in server.crt | openssl md5
```

If both hashes match â†’ correct pair.

---

## ğŸ¯ Final Cheat Sheet

| Task             | Command                                             |
| ---------------- | --------------------------------------------------- |
| Generate key     | `openssl genrsa -out server.key 2048`               |
| Generate CSR     | `openssl req -new -key server.key -out server.csr`  |
| Self-signed cert | `openssl req -x509 -key server.key -out server.crt` |
| Inspect cert     | `openssl x509 -in server.crt -text -noout`          |
| Test TLS         | `openssl s_client -connect domain:443`              |
| Convert PEMâ†’PFX  | `openssl pkcs12 -export -out out.pfx`               |
