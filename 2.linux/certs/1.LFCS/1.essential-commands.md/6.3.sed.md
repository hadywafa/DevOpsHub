# ðŸ§© **What is `sed`?**

`sed` = **Stream EDitor**.

It reads input **line by line**, applies transformations, and outputs the result.
Perfect for:

- Editing files automatically
- Scripting
- CI/CD pipelines
- Config transformations
- Log cleanup
- Mass replacements

Syntax:

```bash
sed 'COMMAND' file
```

or multiple:

```bash
sed -e 'command1' -e 'command2' file
```

---

## ðŸ“Œ **Important Notes Before We Begin**

- `sed` **does not change the file** unless you use:

  ```bash
  sed -i '...' file   # in-place edit
  ```

- Most commands use **regex**
- **Addresses** (line numbers or patterns) can target specific lines

---

## ðŸŸ¥ 1. FIND & REPLACE (`s///`)

Basic syntax:

```bash
sed 's/pattern/replacement/' file
```

---

### ðŸ”¹ Replace first occurrence per line

```bash
sed 's/error/ERROR/' file.txt
```

---

### ðŸ”¹ Replace ALL occurrences per line (`g` flag)

```bash
sed 's/error/ERROR/g' file.txt
```

---

### ðŸ”¹ Case-insensitive replace

```bash
sed 's/error/ERROR/gi' file.txt
```

---

### ðŸ”¹ In-place replacement (modify file)

```bash
sed -i 's/localhost/127.0.0.1/' config.txt
```

---

### ðŸ”¹ Using capture groups (regex)

#### Replace numbers with [NUMBER]

```bash
sed 's/[0-9]\+/[NUMBER]/g' file.txt
```

---

#### Swap two words

```bash
sed 's/\(first\) \(second\)/\2 \1/' file.txt
```

---

## ðŸŸ§ 2. DELETE LINES (`d`)

Syntax:

```bash
sed 'PATTERN d' file
```

---

### ðŸ”¹ Delete lines containing a word

```bash
sed '/DEBUG/d' app.log
```

---

### ðŸ”¹ Delete empty lines

```bash
sed '/^$/d' file.txt
```

---

### ðŸ”¹ Delete lines by number

Delete line **3**:

```bash
sed '3d' file.txt
```

Delete lines 3 to 7:

```bash
sed '3,7d' file.txt
```

Delete from line 5 to end:

```bash
sed '5,$d' file.txt
```

---

## ðŸŸ¨ 3. INSERT & APPEND (`i`, `a`)

- **Insert (i)** â†’ before the matched line
- **Append (a)** â†’ after the matched line

---

### ðŸ”¹ Insert before line number

```bash
sed '3i This is inserted BEFORE line 3' file.txt
```

---

### ðŸ”¹ Append after line number

```bash
sed '3a This is inserted AFTER line 3' file.txt
```

---

### ðŸ”¹ Insert before lines matching a pattern

```bash
sed '/ERROR/i ----- ERROR FOUND BELOW -----' log.txt
```

---

### ðŸ”¹ Append after pattern

```bash
sed '/ERROR/a ----- END OF ERROR -----' log.txt
```

---

## ðŸŸ© 4. CHANGE CONTENT OF A LINE (`c`)

Change replaces **the entire line**.

---

### ðŸ”¹ Replace entire line containing "DEBUG"

```bash
sed '/DEBUG/c This line was replaced' file.txt
```

---

### ðŸ”¹ Replace a specific line number

```bash
sed '5c This is the NEW line 5' file.txt
```

---

## ðŸŸ¦ 5. PRINTING (`p`)

By default, `sed` prints all lines.
`p` prints specific lines.

---

### ðŸ”¹ Print only matched lines

```bash
sed -n '/ERROR/p' file.txt
```

`-n` â†’ suppress automatic printing

---

### ðŸ”¹ Print specific line number

```bash
sed -n '5p' file.txt
```

---

### ðŸ”¹ Print a range

```bash
sed -n '10,20p' file.txt
```

---

## ðŸŸª 6. MULTI-LINE PROCESSING

`sed` is line-based by default, but can use the **hold space** to combine lines.

---

### ðŸ”¹ Replace text across two lines

Example file:

```ini
username:
admin
```

Replace that with:

```ini
username: admin
```

```bash
sed ':a;N;$!ba;s/\nadmin/: admin/' file.txt
```

Explanation:

- `N` â†’ append next line
- `ba` â†’ loop
- Whole file becomes one line â†’ then processed

---

### ðŸ”¹ Remove line breaks (join lines)

```bash
sed ':a;N;$!ba;s/\n/ /g' file.txt
```

---

### ðŸ”¹ Append next line to current line

```bash
sed 'N;s/\n/ /' file.txt
```

---

## ðŸŸ« SED REGEX CHEATSHEET

### Basic

| Regex     | Meaning             |
| --------- | ------------------- |
| `.`       | any char            |
| `*`       | 0 or more           |
| `+`       | 1 or more           |
| `?`       | maybe 1             |
| `[a-z]`   | range               |
| `^word`   | starts with word    |
| `word$`   | ends with word      |
| `\(`â€¦`\)` | capture group       |
| `\|`      | OR (extended regex) |

Enable extended regex:

```bash
sed -E 's/a|b/c/' file
```

---

## ðŸ”¥ REAL DEVOPS USE CASES

### âœ” 1. Replace env variable in configuration

```bash
sed -i 's/DB_HOST=.*/DB_HOST=prod-db/' .env
```

Before:

```ini
DB_HOST=localhost
```

After:

```ini
DB_HOST=prod-db
```

---

### âœ” 2. Comment out a line in config

```bash
sed -i '/^Listen 80/s/^/#/' httpd.conf
```

---

### âœ” 3. Remove all comments

```bash
sed '/^#/d' config.conf
```

---

### âœ” 4. Extract only IP addresses from log

```bash
sed -n 's/.*IP: \([0-9\.]*\).*/\1/p' app.log
```

---

### âœ” 5. Change JSON values (yes, sed can do it)

```bash
sed -i 's/"replicas": [0-9]\+/"replicas": 5/' deployment.json
```

---

### âœ” 6. Remove ANSI color codes from logs

```bash
sed 's/\x1b\[[0-9;]*m//g' logfile
```

---

## ðŸ§  SUMMARY TABLE

| Action               | sed command          |
| -------------------- | -------------------- |
| Replace text         | `s/old/new/`         |
| Replace globally     | `s/old/new/g`        |
| In-place edit        | `sed -i`             |
| Delete lines         | `/pattern/d` or `3d` |
| Insert               | `/pat/i text`        |
| Append               | `/pat/a text`        |
| Change entire line   | `/pat/c text`        |
| Print only matches   | `sed -n '/pat/p'`    |
| Multi-line join      | `N; s/\n/ /`         |
| Replace across lines | `:a;N;$!ba; s/.../`  |
