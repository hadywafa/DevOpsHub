
# ğŸ”¥ Linux File Comparison & Deduplication Tools

Today we cover two powerful tools:

* **`uniq`** â†’ remove duplicate *lines*
* **`diff`** â†’ compare two files (or directories)

Used heavily in:

* Log processing
* Sorting & data analysis
* DevOps CI/CD validation
* Config comparison
* Git conflict debugging
* Backup verification

Letâ€™s go deep ğŸš€

---

# ğŸŸ¨ 1. `uniq` â€” Remove Duplicate Lines (Very Useful After `sort`)

`uniq` removes duplicate **consecutive** repeated lines.

ğŸ“Œ **Important:** It only removes duplicates that are next to each other.
Thatâ€™s why we often do:

```bash
sort file.txt | uniq
```

---

# ğŸ§© 1.1 Basic Syntax

```bash
uniq file
uniq input.txt output.txt
```

---

# ğŸŸ¦ 1.2 Basic Usage

Given a file:

```
apple
apple
banana
banana
banana
orange
```

### â–¶ï¸ Remove duplicates:

```bash
uniq fruits.txt
```

ğŸ“¤ Output:

```
apple
banana
orange
```

---

# ğŸŸ© 1.3 Count duplicates (`-c`)

```bash
uniq -c fruits.txt
```

ğŸ“¤ Output:

```
  2 apple
  3 banana
  1 orange
```

---

# ğŸŸª 1.4 Show ONLY duplicate lines (`-d`)

```bash
uniq -d fruits.txt
```

ğŸ“¤ Output:

```
apple
banana
```

---

# ğŸŸ« 1.5 Show ONLY unique (non-duplicate) lines (`-u`)

```bash
uniq -u fruits.txt
```

ğŸ“¤ Output:

```
orange
```

(because only `orange` appears once)

---

# ğŸŸ§ 1.6 Case-insensitive (`-i`)

```bash
uniq -i file.txt
```

---

# ğŸŸ¥ 1.7 Filter duplicate words after `sort`

Example file:

```
error
info
error
warning
info
```

### Without sorting:

```bash
uniq file.txt
```

Output: âŒ incorrect

```
error
info
error
warning
info
```

### With sorting:

```bash
sort file.txt | uniq
```

Correct output:

```
error
info
warning
```

---

# ğŸ§  Real DevOps Use: Count Unique IPs in Logs

```bash
awk '{print $1}' access.log | sort | uniq -c
```

---

# ğŸŸ¨ 2. `diff` â€” Compare Files (Line by Line)

`diff` shows differences between **two files** or **two directories**.

---

# ğŸ§© 2.1 Basic Syntax

```bash
diff file1 file2
```

---

# ğŸŸ¦ 2.2 Output Example

File1:

```
apple
banana
orange
```

File2:

```
apple
banana
grape
orange
```

### â–¶ï¸ Run:

```bash
diff file1.txt file2.txt
```

ğŸ“¤ Output:

```
3c3
< orange
---
> grape
```

Meaning:

* Line 3 changed
* `<` shows old value
* `>` shows new value

---

# ğŸŸ¥ 2.3 Symbols in diff

| Symbol | Meaning         |
| ------ | --------------- |
| `a`    | added           |
| `c`    | changed         |
| `d`    | deleted         |
| `<`    | line from file1 |
| `>`    | line from file2 |

---

# ğŸŸ© 2.4 Unified Diff Format (`-u`) â€” Git-style

The most common and readable format:

```bash
diff -u file1.txt file2.txt
```

ğŸ“¤ Output:

```
--- file1.txt
+++ file2.txt
@@ -1,3 +1,4 @@
 apple
 banana
-orange
+grape
 orange
```

This is the SAME output style used by Git.

---

# ğŸŸª 2.5 Side-by-side Comparison (`-y`)

```bash
diff -y file1.txt file2.txt
```

ğŸ“¤ Output:

```
apple     apple
banana    banana
orange  | grape
         orange
```

`|` highlights differences.

---

# ğŸŸ« 2.6 Suppress identical lines (`--suppress-common-lines`)

```bash
diff -y --suppress-common-lines file1 file2
```

Only differences appear.

---

# ğŸŸ§ 2.7 Compare Directories (recursive)

```bash
diff -r dir1 dir2
```

Useful for checking config drift.

---

# ğŸŸ¨ 2.8 Ignore whitespace changes (`-w`)

```bash
diff -w file1 file2
```

Great for comparing code with formatting differences.

---

# ğŸŸ¥ 2.9 Ignore case

```bash
diff -i file1 file2
```

---

# ğŸ§  2.10 Real DevOps Examples

---

## âœ” Compare two versions of a config file

```bash
diff -u config.old config.new
```

---

## âœ” Check differences between two deployment templates

```bash
diff -r deploy-v1/ deploy-v2/
```

---

## âœ” Verify only a few lines changed

```bash
diff -uN old new
```

`-N` treats missing files as empty.

---

## âœ” Compare K8s manifest before and after CI pipeline modification

```bash
diff -u <(kubectl get deploy myapp -o yaml) new.yaml
```

---

## âœ” Compare secrets in a secure environment

```bash
diff <(echo "$OLD_SECRET") <(echo "$NEW_SECRET")
```

---

# ğŸ§© 3. Summary Cheat Sheet (Your Style)

| Tool      | Purpose                | Example               |       |
| --------- | ---------------------- | --------------------- | ----- |
| `uniq`    | Remove duplicate lines | `sort users.txt       | uniq` |
| `uniq -c` | Count duplicates       | `uniq -c items.txt`   |       |
| `uniq -d` | Show only duplicates   | `uniq -d items.txt`   |       |
| `uniq -u` | Unique lines only      | `uniq -u items.txt`   |       |
| `diff`    | Compare files          | `diff f1 f2`          |       |
| `diff -u` | Unified diff           | `diff -u old new`     |       |
| `diff -y` | Side-by-side diff      | `diff -y a b`         |       |
| `diff -r` | Compare directories    | `diff -r dir1 dir2`   |       |
| `diff -w` | Ignore whitespace      | `diff -w code1 code2` |       |

---

# ğŸš€ Want the next topic?

I can continue with:

âœ… **Full guide for `cut`, `sort`, `uniq`, `wc` (the text toolbox)**
âœ… **Full guide for `awk` (professional level)**
âœ… **Full guide for `tr`, `xargs`**
Just tell me!