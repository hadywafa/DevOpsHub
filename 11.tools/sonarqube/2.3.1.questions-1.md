# ğŸ¤” So... Does SonarQube Actually _Fail_ Pipelines?

âœ… **Yes â€” it can!**  
SonarQube is not just a â€œreport viewer.â€
It can **automatically fail your Azure DevOps pipeline** if your code breaks the **Quality Gate** rules.

---

## ğŸ§© Think of it this way

Your CI/CD pipeline has multiple â€œjudgesâ€ ğŸ‘‡

| Step         | Judge        | What it checks                               | Can it fail pipeline? |
| ------------ | ------------ | -------------------------------------------- | --------------------- |
| âœ… Build     | Compiler     | Does the code compile?                       | Yes                   |
| âœ… Test      | Test runner  | Do unit tests pass?                          | Yes                   |
| âœ… SonarQube | Quality Gate | Is the code clean, secure, and maintainable? | Yes (if configured)   |

So, **SonarQube is another gatekeeper** like tests or linting â€” but focused on **code quality, security, and maintainability**.

---

## ğŸ§  How the â€œFailureâ€ Happens

In your Azure DevOps YAML pipeline, you usually have this final step:

```yaml
- task: SonarQubePublish@5
  displayName: "Publish Quality Gate Result"
  inputs:
    pollingTimeoutSec: "300"
```

### Hereâ€™s what happens:

1. This task **asks SonarQube** for the projectâ€™s latest analysis result.
2. SonarQube checks the **Quality Gate** (bugs, vulnerabilities, coverage, duplication).
3. If **any condition fails**, the gate status = âŒ FAILED.
4. The pipeline **marks the build as failed** in Azure DevOps.

---

## ğŸ§± Example

### ğŸ”´ Failing Gate Example:

Your Quality Gate rules say:

- No new **critical** or **blocker** bugs.
- Code coverage â‰¥ 80%.
- Duplications â‰¤ 3%.

After analysis, SonarQube finds:

- 2 Critical Bugs
- Coverage = 55%
- Duplications = 5%

ğŸ’¥ **Result:** Quality Gate failed.
Azure DevOps shows:

```ini
##[error] SonarQube quality gate failed: FAILED
```

Pipeline = âŒ FAILED
Deployment stage = ğŸš« Blocked

---

## ğŸŸ¢ Passing Gate Example:

- 0 Critical Bugs
- Coverage = 87%
- Duplications = 1%

âœ… **Result:** Quality Gate passed
Pipeline continues to next stage (deploy, etc.)

---

## ğŸ§­ Simplified Pipeline Logic

```mermaid
flowchart TD
A[Build + Test] --> B[SonarQube Analysis]
B --> C{Quality Gate Pass?}
C -->|Yes| D[Continue to Deploy ğŸš€]
C -->|No| E[Fail Pipeline âŒ]
```

---

## ğŸ’¡ Important Notes

- By default, **SonarQubePublish@5** will fail the pipeline **only** if the Quality Gate = FAILED.
- The **failure is based on metrics**, not only test results.
- You can configure gates to check:

  - Bugs
  - Vulnerabilities
  - Code Smells
  - Coverage %
  - Duplications
  - Security Hotspots

---

## ğŸ” In short:

| Task                   | Purpose                        |
| ---------------------- | ------------------------------ |
| `DotNetCoreCLI@2 test` | Fails if tests fail âŒ         |
| `SonarQubePublish@5`   | Fails if code quality fails âŒ |

ğŸ‘‰ So yes, **SonarQube can make your build fail â€” just like failing tests â€” if your code violates quality or security rules.**
