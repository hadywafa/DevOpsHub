# ğŸ›ï¸ **Jenkins Architecture**

## ğŸ“– What Is Jenkins Really? (The Human Explanation)

Jenkins is not just a CI/CD tool. Think of it as:

> **ğŸ”¥ A brain (controller) that manages a global army of workers (agents) to run automated tasks (builds, tests, deployments).**

Every task you configure in Jenkins becomes a workflow (Pipeline).
Every worker (agent) is a compute node that executes parts of that workflow.
The controller orchestrates everything: scheduling jobs, storing configs, managing plugins, logs, credentials, and build queues.

---

## ğŸ›ï¸ High-Level Architecture Overview

### ğŸ¯ Core Components

- **Jenkins Controller (Master)**
  The central management server. It _decides_ what to run, but should not _do_ the heavy work.

- **Jenkins Agents (Nodes/Slaves)**
  Machines that perform builds, tests, deployments, and scripts.

- **Build Queue**
  A waiting area for jobs before an agent becomes available.

- **Executors**
  Virtual "threads" on each agent that run jobs.

- **Plugins**
  Extend Jenkins' abilities for Git, Docker, Kubernetes, pipelines, notifications, cloud integration, and more.

Letâ€™s visualize this.

---

### ğŸ–¼ï¸ Jenkins Architecture Diagram (Visualized)

<div align="center" style="background-color:#fff; border-radius: 10px; border: 2px solid">
   <img src="image/1765291306538.png" alt="GitHub Actions Matrix Build" style="width: 80%">
   <img src="image/1765291362673.png" alt="GitHub Actions Matrix Build" style="width: 80%">
</div>

---

## ğŸ§  Jenkins Controller (Master)

The Jenkins Controller handles **ALL coordination**, **NO heavy lifting**.

### ğŸ”§ Responsibilities of the Controller

#### ğŸ—‚ï¸ 1. Manages configuration

- Pipeline definitions (Jenkinsfiles)
- Credentials management
- Plugins management
- System settings (security, agents, tools)

#### ğŸ“† 2. Schedules build jobs

- Keeps a **build queue**
- Chooses the best agent
- Dispatches tasks to available executors

#### ğŸ”Œ 3. Manages plugins

Plugins transform Jenkins from "just CI" into:

- CI/CD platform
- Docker automation engine
- Kubernetes orchestrator
- Security scanner
- ChatOps bot
- And much more

#### ğŸ“Š 4. Stores logs, metadata, and job history

Jenkins keeps:

- Console output
- Artifacts
- Test reports
- Build artifacts

#### ğŸ§© Should the controller run builds?

Technically yes.  
Practically NO.  
Best practice: **zero executors on the controller** using only agents for builds.

---

## ğŸ‘·ğŸ»â€â™‚ï¸ Jenkins Agents (Nodes)

Agents are where the builds ACTUALLY run.

They can be:

### ğŸ–¥ï¸ â€¢ Static Agents

Long-running VMs or bare-metal servers.

### âœ¨ â€¢ Dynamic Agents

Ephemeral instances created on demand by:

- Docker
- Kubernetes
- AWS EC2
- Azure VMSS
- Google Cloud

### ğŸ”„ Agent Connections

Agents connect to the controller via:

| Protocol              | Notes                                         |
| --------------------- | --------------------------------------------- |
| **JNLP**              | Java Web Start agent (legacy)                 |
| **SSH**               | Most common for Linux agents                  |
| **Inbound TCP**       | Firewall-friendly, agent initiates connection |
| **Kubernetes Plugin** | Spins up pod agents automatically             |

Each agent contains:

- **Executors**
- **Workspace**
- **Tools** (JDK, Maven, .NET, Node, Docker, etc.)

---

<div align="center" style="background-color:#F8F8F8; border-radius: 10px; border: 2px solid">
   <img src="image/jenkins-architecture-1.gif" alt="GitHub Actions Matrix Build" style="width: 80%">
</div>

---

## ğŸ§µ Executors â€” The Workers Inside the Worker

An agent may run **multiple builds concurrently**, controlled by _executors_.

Example:

| Agent            | Executors | Meaning                         |
| ---------------- | --------- | ------------------------------- |
| Linux-Agent-01   | 4         | Can run 4 parallel jobs         |
| Windows-Agent-01 | 2         | Can run 2 jobs at the same time |

Executors allow Jenkins to fully consume hardware resources.

---

## ğŸ”„ Job Execution Lifecycle

Let's walk through what happens when you click â€œBuild Nowâ€.

```mermaid
sequenceDiagram
    participant Dev as ğŸ‘¨â€ğŸ’» Developer
    participant JC as ğŸ§  Jenkins Controller
    participant Q as ğŸ“¥ Build Queue
    participant A as ğŸ§° Agent
    participant EX as ğŸ§µ Executor

    Dev ->> JC: Trigger build (manual, webhook, schedule)
    JC ->> JC: Read Jenkinsfile
    JC ->> Q: Add job to queue
    JC ->> A: Select best agent
    A ->> EX: Start executor thread
    EX ->> A: Checkout code
    EX ->> A: Run stages (build, test, deploy)
    A ->> JC: Send logs + artifacts
    JC ->> Dev: Display build status
```

---

## ğŸªˆ Jenkins Pipeline Architecture

There are two pipeline types:

### 1. Declarative Pipeline

Simple, structured, opinionated.

### 2. Scripted Pipeline

**Groovy-based**, flexible, fully programmable.

Both use:

- **Stages**
- **Steps**
- **Nodes**
- **Agents**
- **Libraries**

### Example of Declarative Pipeline:

```groovy
pipeline {
    agent { label 'linux' }

    stages {
        stage('Checkout') {
            steps {
                git 'https://github.com/repo.git'
            }
        }

        stage('Build') {
            steps {
                sh 'mvn clean package'
            }
        }

        stage('Test') {
            steps {
                sh 'mvn test'
            }
        }

        stage('Deploy') {
            steps {
                sh './deploy.sh'
            }
        }
    }
}
```

---

## ğŸŒ Jenkins Distributed Build Architecture

<div align="center" style="background-color:#fff; border-radius: 10px; border: 2px solid">
   <img src="image/1765292887599.png" alt="GitHub Actions Matrix Build" style="width: 80%">
</div>

### Why distributed?

- âœ” Parallel builds
- âœ” Load distribution
- âœ” Language/platform diversity
- âœ” Better scalability
- âœ” No bottlenecks on controller

---

## ğŸ” Credential Architecture

Jenkins stores credentials in:

- Keystore (encrypted)
- Credentials binding plugin
- Credentials scoped per folder/pipeline

Types include:

- Username/password
- SSH keys
- Secrets
- Tokens
- Certificates

Credentials flow:

<div align="center" style="background-color:#fff; border-radius: 10px; border: 2px solid">

```mermaid
flowchart LR
    Pipeline[Jenkinsfile] --> CredentialRequest
    CredentialStore[ğŸ” Jenkins Credential Store] --> CredentialRequest
    CredentialRequest --> Agent[ğŸ§° Agent Uses Credential]
```

</div>

---

## ğŸš€ Real-World Architecture Example

Letâ€™s design a modern enterprise Jenkins setup.

### ğŸ§  Controller (small machine)

- 1â€“2 vCPUs
- 4â€“8 GB RAM
- No executors

### ğŸ‹ï¸ Agents

- Linux Build Agent
- Windows Build Agent
- Docker Cloud Agents
- Kubernetes Ephemeral Pods
- On-prem Agents for legacy applications

### ğŸ—‚ Storage

- NFS or S3 for artifacts
- External logging (ELK / Splunk)

### ğŸ”’ Security

- RBAC
- LDAP/AD Integration
- Folder-level permissions
- Credentials scoped

---

## ğŸ¯ Putting It All Together: Final Architecture Diagram

<div align="center" style="background-color:#fff; border-radius: 10px; border: 2px solid">
   <img src="image/1765292903940.png" alt="GitHub Actions Matrix Build" style="width: 80%">
</div>

---

## ğŸ”š Short, Human Explanation to Remember

Think of Jenkins as:

> **A boss (controller) with many employees (agents).  
> The boss assigns tasks, workers do the tasks, and everyone reports back.**

- Controller = Manager
- Agents = Employees
- Executors = Employee hands
- Build Queue = Waiting room
- Pipelines = Task instructions
- Plugins = Extra skills
