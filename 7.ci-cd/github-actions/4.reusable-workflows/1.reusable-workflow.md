# ğŸ§© Introduction to Reusable Workflows in GitHub Actions

## âš™ï¸ Official Definition

> A **reusable workflow** is a workflow that can be called by other workflows using the `workflow_call` event.
> It allows you to define CI/CD logic **once** and **reuse it** across multiple repositories, teams, or environments.

---

<div align="center" style="background-color:#fff; border-radius: 10px; border: 2px solid">
   <img src="image/1762756779134.png" alt="GitHub Actions Matrix Build" style="width: 80%">
</div>

---

## ğŸ’¡ Why Reusable Workflows Exist

Before reusable workflows, large orgs had a **nightmare**:

- Every repo had to duplicate the same `build.yml` or `test.yml`.
- Updating logic (e.g., new build step) meant editing **dozens of files** manually.
- CI/CD was inconsistent across teams.

Reusable workflows fix that.
They let you **centralize** logic like this:

```ini
.github/
â””â”€â”€ workflows/
    â”œâ”€â”€ build.yml       â† reusable build logic
    â”œâ”€â”€ test.yml        â† reusable test logic
    â””â”€â”€ deploy.yml      â† reusable deploy logic
```

Then other repos (or workflows in the same repo) simply **call** these workflows like functions. ğŸ¯

---

<div align="center" style="background:#343739ff; border-radius:20px">

```mermaid
graph TD
    A["ğŸ’» Repo A (Frontend)"] --> B["âš™ï¸ Reusable build.yml"]
    C["ğŸ’» Repo B (Backend)"] --> B
    D["ğŸ’» Repo C (Mobile)"] --> B
    B --> E["ğŸš€ Shared Build Logic (one source of truth)"]
```

</div>

---

## ğŸ§  Think of It Like This:

- **Composite Action:** like a **function** (a small reusable step group).
- **Reusable Workflow:** like a **module** (a full pipeline that can include jobs, actions, and steps).

<div align="center" style="background:#343739ff; border-radius:20px">

| Concept               | Purpose                            | Scope                       |
| --------------------- | ---------------------------------- | --------------------------- |
| **Action**            | Reuse small steps or scripts       | Within a single job         |
| **Reusable Workflow** | Reuse entire workflows (multi-job) | Across repositories or orgs |

</div>

---

## ğŸ§± Basic Structure

Hereâ€™s the simplest form of a reusable workflow:

ğŸ“„ `.github/workflows/build.yml`

```yaml
name: ğŸ”§ Reusable Build Workflow

on:
  workflow_call:
    inputs:
      node-version:
        required: true
        type: string
    secrets:
      TOKEN:
        required: true

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: ${{ inputs.node-version }}
      - name: Install and Build
        run: |
          npm ci
          npm run build
```

Letâ€™s decode it:

<div align="center" style="background:#343739ff; border-radius:20px">

| Key                 | Meaning                                                      |
| ------------------- | ------------------------------------------------------------ |
| `on: workflow_call` | Marks this as reusable â€” it wonâ€™t run on push/pull by itself |
| `inputs`            | Variables that can be passed by the caller                   |
| `secrets`           | Secure values required from caller                           |
| `jobs`              | The actual workflow logic (can have multiple jobs)           |

</div>

---

## ğŸ”— How You Call It (From Another Workflow)

ğŸ“„ `.github/workflows/main.yml`

```yaml
name: ğŸ§© Main CI

on:
  push:
    branches: [main]

jobs:
  use-build-workflow:
    uses: ./.github/workflows/build.yml
    with:
      node-version: 18
    secrets:
      TOKEN: ${{ secrets.MY_GITHUB_TOKEN }}
```

ğŸ§  Thatâ€™s it â€” one line (`uses: ./.github/workflows/build.yml`) replaces an entire CI definition!

---

<div align="center" style="background:#343739ff; border-radius:20px">

```mermaid
sequenceDiagram
    participant M as ğŸ§© main.yml
    participant R as ğŸ”§ build.yml (reusable)
    participant A as âš™ï¸ Actions Runner

    M->>R: Call reusable workflow with inputs + secrets
    R->>A: Executes build steps
    A-->>R: Returns status (success/failure)
    R-->>M: Outputs back to main workflow
```

</div>

---

## ğŸ” Where You Can Store Reusable Workflows

<div align="center" style="background:#343739ff; border-radius:20px">

| Location                     | Scope                       | Example Reference                                       |
| ---------------------------- | --------------------------- | ------------------------------------------------------- |
| **Same repo**                | For internal reuse          | `uses: ./.github/workflows/build.yml`                   |
| **Org-level `.github` repo** | Shared across all org repos | `uses: my-org/.github/.github/workflows/build.yml@main` |
| **Another repo**             | Shared across projects      | `uses: my-org/devops/.github/workflows/test.yml@v2`     |

</div>

---

This is what makes them **super scalable** in enterprise setups.

---

## ğŸ§© When to Use vs. When Not To

<div align="center" style="background:#343739ff; border-radius:20px">

| Use Reusable Workflows Whenâ€¦                      | Avoid Whenâ€¦                                   |
| ------------------------------------------------- | --------------------------------------------- |
| You want to reuse logic across repos              | Workflow is unique to a project               |
| You have multiple environments (dev, stage, prod) | Only one pipeline exists                      |
| You need parameterized builds/tests               | Steps depend heavily on repo-specific context |
| You maintain org-wide CI standards                | Prototype or one-off builds                   |

</div>

---

## âš™ï¸ Permissions and Security

Reusable workflows use **the callerâ€™s permissions** by default â€” this is great for security.
You can control it via the `permissions:` block.

```yaml
permissions:
  contents: read
  packages: write
  id-token: write
```

When calling across repos, ensure the caller has access to the target workflow repo.

---

## ğŸ’¬ Human TL;DR

> Reusable workflows are like shared **pipeline templates**.  
> Instead of copy-pasting your CI logic across 10 repos, you define it once and call it everywhere â€” clean, consistent, and scalable.  
> They turn GitHub Actions into a proper **DevOps architecture layer**.

---

<div align="center" style="background:#343739ff; border-radius:20px">

```mermaid
graph TD
    A["ğŸ“ Org .github repo"] --> B["ğŸ§© Reusable Workflows (build.yml, test.yml, deploy.yml)"]
    B --> C["ğŸ—ï¸ App Repo 1"]
    B --> D["ğŸš€ App Repo 2"]
    B --> E["ğŸ”¬ App Repo 3"]
    C & D & E --> F["ğŸ¯ Unified CI/CD Standards"]
```

</div>
