# âš™ï¸ **What is an â€œActionâ€?**

Think of a GitHub workflow (`.github/workflows/*.yml`) as a **recipe** ğŸ³.

Each **step** in that recipe can either:

1. Run a shell command you write yourself
   ğŸ‘‰ `run: npm install`
2. **Use** an existing **Action**, which is a reusable unit of logic
   ğŸ‘‰ `uses: actions/checkout@v4`

Formally:

> ğŸ”¹ **An action** is a reusable unit of code that performs a specific task inside a GitHub Actions workflow.
> It can be **created by GitHub**, **the community**, or **you**.

---

<div align="center" style="background-color:#fff; border-radius: 10px; border: 2px solid">
   <img src="image/1762679735567.png" alt="GitHub Actions Matrix Build" style="width: 80%">
</div>

---

## ğŸ”´ **What Happens Without Actions?**

Without `uses:`, youâ€™d have to manually:

- Clone the repo (`git clone` with tokens)
- Set up your programming language (Node, Python, .NET)
- Authenticate to cloud or package registries
- Upload artifacts manually with `curl`
- And a hundred other chores ğŸ˜©

Example â€” workflow **without** any prebuilt actions:

```yaml
steps:
  - run: git clone https://github.com/${{ github.repository }} .
  - run: sudo apt install nodejs npm
  - run: npm install
  - run: npm test
```

Thatâ€™s painful, brittle, and repetitive.

Using **Actions**, you simply do:

```yaml
steps:
  - uses: actions/checkout@v4
  - uses: actions/setup-node@v4
    with:
      node-version: 20
  - run: npm ci
  - run: npm test
```

ğŸ§  **Why?**  
Because `actions/checkout` handles cloning, auth, shallow depth, submodules, etc.  
`actions/setup-node` installs Node versions, configures cache, and so on.  
These are **building blocks** you can mix and match.

---

## ğŸ«€ **Anatomy of an â€œActionâ€**

Every action has:

```ini
name: <friendly name>
description: <short summary>
inputs: { optional, for configuration }
outputs: { optional, for exposing results }
runs:
  using: [composite|node20|docker]
  main|steps|image|args|...
```

Example (simplified `checkout`):

```yaml
name: "Checkout"
description: "Checks out your repository under $GITHUB_WORKSPACE"
inputs:
  fetch-depth:
    description: "Number of commits to fetch"
    default: 1
runs:
  using: "node20"
  main: "dist/index.js"
```

---

## âš™ï¸ **How â€œuses:â€ Works**

When you write:

```yaml
- uses: actions/checkout@v4
```

GitHub does the following behind the scenes:

1. Looks for the `actions/checkout` repo on GitHub.
2. Pulls version **`v4`** (which maps to a tag or commit SHA).
3. Reads its `action.yml` file.
4. Executes it inside the workflowâ€™s runner environment.

If the action type is:

- **Node** â†’ runs Node.js script defined in `main:`
- **Docker** â†’ builds or pulls the specified Docker image and runs it
- **Composite** â†’ executes multiple steps directly in your workflow context

---

## âš”ï¸ **Difference Between `run:` and `uses:`**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Keyword | Purpose                         | Example                     | Scope                        |
| ------- | ------------------------------- | --------------------------- | ---------------------------- |
| `run:`  | Execute inline shell commands   | `run: npm test`             | Your current shell           |
| `uses:` | Run an external reusable Action | `uses: actions/checkout@v4` | Executes another repoâ€™s code |

</div>

---

**Analogy:**  
`run:` â†’ â€œIâ€™ll cook this dish myself.â€  
`uses:` â†’ â€œOrder from a pre-made recipe on Uber Eats.â€ ğŸ”

---

## ğŸ§° **Commonly Used Official Actions (must-know list)**

<div align="center" style="background-color:#fff; border-radius: 10px; border: 2px solid">
   <img src="image/1762679703986.png" alt="GitHub Actions Matrix Build" style="width: 80%">
</div>

---

### ğŸ§¾ Repository Management

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Action                                                    | Description                                                                         |
| --------------------------------------------------------- | ----------------------------------------------------------------------------------- |
| **`actions/checkout@v4`**                                 | Clone your repo into the runner. Supports submodules, sparse checkout, fetch depth. |
| **`actions/upload-artifact@v4` / `download-artifact@v4`** | Save and restore build outputs between jobs.                                        |
| **`actions/cache@v4`**                                    | Cache dependencies (npm, pip, etc.) for faster builds.                              |
| **`actions/github-script@v7`**                            | Run short JavaScript using GitHub API with context access.                          |

</div>

### ğŸ’» Environment Setup

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Action                        | Description                                     |
| ----------------------------- | ----------------------------------------------- |
| **`actions/setup-node@v4`**   | Install Node.js & npm/yarn; auto cache support. |
| **`actions/setup-python@v5`** | Install Python & manage versions.               |
| **`actions/setup-dotnet@v3`** | Setup .NET SDKs.                                |
| **`actions/setup-java@v4`**   | Setup JDKs with caching (Gradle/Maven).         |
| **`actions/setup-go@v5`**     | Install Go versions.                            |

</div>

### â˜ï¸ Cloud & Deployment

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Action                                     | Description                      |
| ------------------------------------------ | -------------------------------- |
| `aws-actions/configure-aws-credentials@v4` | OIDC or key-based AWS auth.      |
| `azure/login@v2`                           | Azure CLI login (supports OIDC). |
| `google-github-actions/auth@v2`            | Google Cloud authentication.     |
| `docker/login-action@v3`                   | Log into Docker registry.        |
| `docker/build-push-action@v5`              | Build & push Docker images.      |

</div>

### ğŸ”„ Utilities

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Action                               | Description                            |
| ------------------------------------ | -------------------------------------- |
| `actions/setup-node@v4`              | Node setup.                            |
| `peter-evans/create-pull-request@v6` | Automate PR creation.                  |
| `softprops/action-gh-release@v2`     | Create GitHub releases.                |
| `actions/stale@v9`                   | Close stale issues/PRs automatically.  |
| `actions/labeler@v4`                 | Auto-label PRs based on changed paths. |

</div>

---

## ğŸ“ **Example: Using Actions Together**

```yaml
name: Node CI
on: [push]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: npm
      - run: npm ci
      - run: npm audit --audit-level=high || true # Your own shell command
```

In this case:

- **`actions/checkout@v4`**
  Clones your repo â†’ now your files exist on the runner.

- **`actions/setup-node@v4`**
  Prepares Node.js environment.

- **`run: npm audit --audit-level=high || true`**
  Runs a shell command that audits dependencies; `|| true` ensures workflow doesnâ€™t fail even if vulnerabilities exist.

If you omit checkout, the runner starts empty (no code).  
Your `npm audit` would fail because `package.json` doesnâ€™t exist. âŒ

---

## ğŸ”¨ **Creating Your Own Custom Actions**

There are **3 types** of custom actions you can create:

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Type          | Runs Using         | Example Use                           | File                                      |
| ------------- | ------------------ | ------------------------------------- | ----------------------------------------- |
| **Composite** | YAML + shell steps | Combine multiple existing actions     | `.github/actions/my-composite/action.yml` |
| **Node.js**   | Node 20 runtime    | Write JS logic, call APIs, parse data | `action.yml` + `index.js`                 |
| **Docker**    | Custom container   | Specialized tools or binaries         | `action.yml` + `Dockerfile`               |

</div>

---

### ğŸ”¹ 1. Composite Action (Easiest & Recommended)

ğŸ“ `.github/actions/lint-and-test/action.yml`

```yaml
name: "Lint and Test"
description: "Run consistent lint + test sequence"
inputs:
  node:
    default: 20
runs:
  using: "composite"
  steps:
    - uses: actions/setup-node@v4
      with:
        node-version: ${{ inputs.node }}
    - run: npm ci
      shell: bash
    - run: npm run lint
      shell: bash
    - run: npm test
      shell: bash
```

Use it in a workflow:

```yaml
- uses: ./.github/actions/lint-and-test
  with:
    node: 20
```

---

### ğŸ”¹ 2. JavaScript (Node) Action

ğŸ“ structure:

```ini
.github/actions/hello-world/
â”œâ”€ action.yml
â””â”€ index.js
```

**action.yml:**

```yaml
name: "Hello JS Action"
description: "Greets the world"
inputs:
  who-to-greet:
    description: "Who to greet"
    required: true
runs:
  using: "node20"
  main: "index.js"
```

**index.js:**

```js
const core = require("@actions/core");
try {
  const name = core.getInput("who-to-greet");
  console.log(`ğŸ‘‹ Hello ${name}!`);
  const time = new Date().toTimeString();
  core.setOutput("time", time);
} catch (error) {
  core.setFailed(error.message);
}
```

**Usage:**

```yaml
- uses: ./.github/actions/hello-world
  with:
    who-to-greet: "GitHub"
```

---

### ğŸ”¹ 3. Docker Action

ğŸ“ structure:

```ini
.github/actions/hello-docker/
â”œâ”€ action.yml
â””â”€ Dockerfile
```

**action.yml:**

```yaml
name: "Hello Docker Action"
description: "Say hello from a container"
inputs:
  who-to-greet:
    required: true
runs:
  using: "docker"
  image: "Dockerfile"
  args:
    - ${{ inputs.who-to-greet }}
```

**Dockerfile:**

```dockerfile
FROM alpine:latest
RUN apk add --no-cache bash
COPY entrypoint.sh /entrypoint.sh
ENTRYPOINT ["/entrypoint.sh"]
```

**entrypoint.sh:**

```bash
#!/bin/sh
echo "ğŸ‘‹ Hello $1 from Docker!"
```

---

## ğŸš€ **Publishing an Action to Marketplace**

1. Create a **public** repo (recommended).
2. Place your `action.yml` in the root.
3. Tag it:

   ```bash
   git tag -a v1 -m "first release"
   git push origin v1
   ```

4. Users can now `uses: yourusername/your-action@v1`.

You can also submit it to the [GitHub Marketplace](https://github.com/marketplace?type=actions).

---

## âœ… **Best Practices (Action Mastery)**

- âœ… **Pin versions** (`@v4`, or better, commit SHA).
- âœ… Keep composite actions lightweight (donâ€™t re-checkout code).
- âœ… Reuse your own composite actions for CI patterns.
- âœ… Avoid `sudo` inside actions â€” they already run as privileged users.
- âœ… For security, prefer **OIDC** authentication over secrets.
- âœ… Use **`core.setOutput()`** to pass results.
- âœ… Use **composite actions** over Node actions when possible (faster, simpler).

---

## ğŸ–¼ï¸ **Visual Map**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

```mermaid
flowchart TD
  W[Workflow YAML] -->|"uses:"| A1["actions/checkout@v4"]
  W -->|"uses:"| A2["actions/setup-node@v4"]
  W -->|"run:"| S1[npm audit]
  subgraph Runner
    A1 --> CodeDir[Cloned Repo]
    A2 --> Env[Node Installed]
    S1 --> Result[Audit Output]
  end
```

</div>

---

## ğŸ **Summary**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Concept              | Key Idea                         | Example                     |
| -------------------- | -------------------------------- | --------------------------- |
| `run:`               | Inline shell commands            | `run: npm test`             |
| `uses:`              | External or local reusable logic | `uses: actions/checkout@v4` |
| **Composite Action** | Mini workflow of steps           | `runs.using: composite`     |
| **Node Action**      | JS logic using `@actions/core`   | `runs.using: node20`        |
| **Docker Action**    | Runs in container                | `runs.using: docker`        |

</div>
