# ğŸ›³ï¸ **Sharing Data in GitHub Actions Workflows**

## ğŸ“ƒ **Overview**

In GitHub Actions, workflows often need to **pass data between steps, jobs, or even workflows**. This guide covers all supported mechanisms for sharing data, including:

- Step-to-step sharing (same job)
- Job-to-job sharing (different runners)
- Workflow-to-workflow sharing
- Environment variables, outputs, and artifacts
- Best practices, edge cases, and security

---

## 1ï¸âƒ£ **Step-to-Step Sharing** (Same Job)

All steps in a job run on the **same runner**, so they share:

- **Filesystem**: You can write/read files between steps.
- **Environment variables**: Use `$GITHUB_ENV` to persist values.
- **Step outputs**: Use `$GITHUB_OUTPUT` to expose values.

### ğŸ§ª Example: Share a file and env var

```yaml
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Generate version file
        run: echo "version=1.2.3" > version.txt

      - name: Set env var
        run: echo "VERSION=1.2.3" >> $GITHUB_ENV

      - name: Use both
        run: |
          cat version.txt
          echo "Version is $VERSION"
```

> âœ… No need for artifacts â€” steps share the same workspace.

---

## 2ï¸âƒ£ **Job-to-Job Sharing** (Different Runners)

Each job runs on a **separate runner**, so you must use:

- **Job outputs**: For small strings (e.g., version, flags)
- **Artifacts**: For files, binaries, logs

---

### ğŸ”¹ **1. Sharing via Job Outputs**

Use `$GITHUB_OUTPUT` and `outputs:` to expose small strings.

#### ğŸ”§ Producer Job

```yaml
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - id: set_version
        run: echo "version=1.2.3" >> $GITHUB_OUTPUT
    outputs:
      version: ${{ steps.set_version.outputs.version }}
```

#### ğŸ”§ Consumer Job

```yaml
deploy:
  needs: build
  runs-on: ubuntu-latest
  steps:
    - run: echo "Deploying version ${{ needs.build.outputs.version }}"
```

> âš ï¸ Step `id:` is mandatory to reference outputs.

---

#### ğŸ§ª **Setting Multiple Outputs**

```yaml
- id: set-multiple
  run: |
    echo "version=1.2.3" >> $GITHUB_OUTPUT
    echo "env=production" >> $GITHUB_OUTPUT
```

Reference them:

```yaml
outputs:
  version: ${{ steps.set-multiple.outputs.version }}
  env: ${{ steps.set-multiple.outputs.env }}
```

---

### ğŸ”¹ **2. Sharing via Artifacts**

Use `actions/upload-artifact` and `actions/download-artifact`.

#### ğŸ§ª Example: Share file between jobs

```yaml
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - run: echo "version=1.2.3" > version.txt
      - uses: actions/upload-artifact@v3
        with:
          name: version-file
          path: version.txt

  deploy:
    needs: build
    runs-on: ubuntu-latest
    steps:
      - uses: actions/download-artifact@v3
        with:
          name: version-file
      - run: cat version.txt
```

> âœ… Artifacts persist across jobs and can be downloaded post-workflow.

---

## 3ï¸âƒ£ **Workflow-to-Workflow Sharing**

Use **repository-level artifacts** or **external storage** (e.g., S3, GCS) to persist data across workflows.

### ğŸ§ª Example: Persist version for next workflow

```yaml
- uses: actions/upload-artifact@v3
  with:
    name: version
    path: version.txt
    retention-days: 5
```

Then in another workflow:

```yaml
- uses: actions/download-artifact@v3
  with:
    name: version
```

---

## ğŸ” **Secrets and Secure Data**

Use `secrets:` in `env:` or directly in steps:

```yaml
env:
  API_KEY: ${{ secrets.MY_API_KEY }}
```

> âœ… Secrets are masked and never exposed in logs.

---

## ğŸ” **Advanced Techniques**

### ğŸ“Œ Use `workflow_call` to pass inputs/outputs between reusable workflows

```yaml
on:
  workflow_call:
    inputs:
      version:
        required: true
        type: string
    outputs:
      result:
        value: ${{ jobs.build.outputs.result }}
```

---

### ğŸ“Œ Use `matrix` to share config across jobs

```yaml
strategy:
  matrix:
    env: [dev, staging, prod]
```

---

## âœ… **Best Practices**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Practice                      | Why It Matters                     |
| ----------------------------- | ---------------------------------- |
| Use `id:` for output steps    | Required to reference outputs      |
| Prefer outputs for strings    | Faster and simpler than artifacts  |
| Use artifacts for files       | Reliable across jobs and workflows |
| Avoid secrets in outputs      | Outputs are visible in logs        |
| Use `workflow_call` for reuse | Modular and scalable workflows     |

</div>

---

## ğŸ **Summary**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Scope                | Tool                 | Use Case               | Notes                           |
| -------------------- | -------------------- | ---------------------- | ------------------------------- |
| Step-to-step         | `$GITHUB_ENV`, files | Env vars, temp files   | Same runner                     |
| Job-to-job           | `outputs`, artifacts | Strings, binaries      | Different runners               |
| Workflow-to-workflow | artifacts, storage   | Persist config/version | Use retention or external store |
| Secrets              | `secrets`            | Secure values          | Masked in logs                  |

</div>
