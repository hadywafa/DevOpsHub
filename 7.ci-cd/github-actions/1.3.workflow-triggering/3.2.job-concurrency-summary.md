# ‚öôÔ∏è **GitHub Actions Job Concurrency**

## üìñ **What is Concurrency?**

- **Concurrency** in GitHub Actions means limiting simultaneous runs of jobs or workflows that share the same **concurrency group**.
- By default, GitHub allows multiple workflows/jobs to run in parallel.
- With `concurrency`, you can:
  - Prevent duplicate runs (e.g., multiple builds for the same branch).
  - Cancel older runs when a new one is triggered.
  - Ensure only one active job/workflow per group.

---

## ‚öôÔ∏è **How to Use Concurrency**

### 1. **Workflow-Level Concurrency**

Defined at the top of the workflow:

```yaml
concurrency:
  group: ci-${{ github.ref }}
  cancel-in-progress: true
```

- **group**: Identifier for the concurrency group (can use expressions like branch name).
- **cancel-in-progress**: If `true`, cancels any currently running job in the group when a new one starts.

üëâ Example: Only one CI run per branch at a time. If you push new commits, the old run is canceled.

---

### 2. **Job-Level Concurrency**

Defined inside a job:

```yaml
jobs:
  build:
    runs-on: ubuntu-latest
    concurrency:
      group: build-${{ github.ref }}
      cancel-in-progress: true
    steps:
      - uses: actions/checkout@v3
      - run: npm install
      - run: npm test
```

üëâ Ensures only one `build` job per branch runs at a time.

---

## ‚ùì **Why Concurrency Matters**

| Scenario               | Benefit                                          |
| ---------------------- | ------------------------------------------------ |
| **Frequent commits**   | Prevents multiple redundant builds/tests         |
| **Long pipelines**     | Saves runner minutes and avoids blocking         |
| **Deployments**        | Ensures only one deployment job runs at a time   |
| **Onboarding clarity** | Explains why jobs cancel when new commits arrive |

---

## üß† **Best Practices**

- **Use branch-based groups**: `ci-${{ github.ref }}` ensures concurrency per branch.
- **Enable `cancel-in-progress`** for CI pipelines to save resources.
- **Separate groups** for different workflows (e.g., `deploy-${{ github.ref }}` vs `test-${{ github.ref }}`).
- **Document behavior**: New engineers should know why jobs auto-cancel.

---

## üìÑ **Example: CI Workflow with Concurrency**

```yaml
name: CI Pipeline

on: [push]

concurrency:
  group: ci-${{ github.ref }}
  cancel-in-progress: true

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - run: npm install
      - run: npm run build

  test:
    runs-on: ubuntu-latest
    needs: build
    steps:
      - run: npm test
```

üëâ Only one CI run per branch at a time. If you push new commits, the old run is canceled and replaced.

---

**Sources:** GitHub Docs on [workflow concurrency](https://docs.github.com/en/actions/how-tos/write-workflows/choose-when-workflows-run/control-workflow-concurrency), Stack Overflow explanations on [job concurrency](https://stackoverflow.com/questions/74737407/what-is-concurrency-in-github-actions), and tutorials on [limiting concurrency and canceling jobs](https://futurestud.io/tutorials/github-actions-limit-concurrency-and-cancel-in-progress-jobs).
