# ðŸ’­ **Use Cases Examples**

## ðŸ“Œ **Use Case One**

You have:

```yaml
concurrency:
  group: ci-${{ github.ref }}
  cancel-in-progress: true

on:
  push:
    branches:
      - dev
      - alpha
      - main
    tags:
      - "v[0-9]+.[0-9]+.[0-9]+"
```

### Step 1: Push a commit to `main`

- Trigger: `refs/heads/main`
- Concurrency group: `ci-refs/heads/main`
- Workflow starts under that group.

### Step 2: Create a tag (e.g. `v1.0.0`) and push it

- Trigger: `refs/tags/v1.0.0`
- Concurrency group: `ci-refs/tags/v1.0.0`
- Workflow starts under a **different group**.

---

### âš¡ Key Insight

- **Branch runs and tag runs do NOT share the same concurrency group.**
- That means:
  - Your `main` branch workflow (`ci-refs/heads/main`) will continue running.
  - Your tag workflow (`ci-refs/tags/v1.0.0`) will start independently.
- **No cancellation occurs between them**, because the group strings are different.

---

### ðŸ§  Why This Matters

- If you want **branch and tag runs to cancel each other**, you need to normalize the concurrency group.
- Example: Use `github.ref_name` instead of `github.ref`.

```yaml
concurrency:
  group: ci-${{ github.ref_name }}
  cancel-in-progress: true
```

- `github.ref_name` resolves to just `main` or `v1.0.0`, so:
  - Push to `main` â†’ group `ci-main`
  - Push tag `v1.0.0` â†’ group `ci-v1.0.0`
- Still separate groups, but cleaner names.

ðŸ‘‰ If you want **tags and branches to share the same group** (e.g., cancel branch run when a release tag is pushed), youâ€™d need to hardcode or design a custom grouping strategy, like:

```yaml
concurrency:
  group: ci-release
  cancel-in-progress: true
```

That way, all release-related runs (branch + tag) share the same group.

---

### âœ… Summary

- With `ci-${{ github.ref }}`, branch runs (`refs/heads/main`) and tag runs (`refs/tags/v1.0.0`) are **different groups**.
- So pushing a commit to `main` and then pushing a tag will run **two independent workflows** â€” neither cancels the other.
- If you want them to cancel each other, you need to unify the concurrency group logic (e.g., use `github.ref_name` or a fixed group string).
