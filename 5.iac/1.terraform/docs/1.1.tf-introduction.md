# ğŸŒ Terraform â€“ Infrastructure as Code (IaC)

<div style="text-align: center">
  <img src="images/tf-iac.png" alt="Terraform - Infrastructure as Code" style="width: 100%; border-radius: 10px" />
</div>

---

## âš™ï¸ DevOps Tasks Before Automation

Before Infrastructure as Code (IaC), DevOps teams manually:

- Logged into cloud consoles or servers
- Created VMs, networks, firewalls manually
- Configured applications by hand
- Maintained lengthy setup docs and inconsistent environments

> âŒ This process was **slow**, **error-prone**, and **hard to scale**.

### âœ… 3 Main Categories of DevOps Tasks

1. **Infrastructure Provisioning**

   - Creating VMs, networks, storage, security groups

2. **Configuration of Provisioned Infrastructure**

   - Installing software, setting up services, OS hardening

3. **Application Deployment**

   - Deploying and managing app releases (versioned, staged)

> ğŸ“Œ **Container technologies** (like Docker, Kubernetes) often **merge step 2 & 3**, since apps are pre-configured in images.

---

## ğŸ“– What is IaC

ğŸ› ï¸ **IaC** stands for **Infrastructure as Code** â€” a powerful approach in IT and DevOps that lets you manage and provision infrastructure using code instead of manual processes.

### ğŸš€ What IaC Does

- Automates the setup of servers, networks, databases, and other infrastructure components
- Uses configuration files (like YAML, JSON, or HCL) to define the desired state of your infrastructure
- Enables consistent, repeatable deployments across environments (development, staging, production)

### ğŸ’¡ Why Itâ€™s Useful

- **Speed**: Deploy environments in minutes, not hours
- **Consistency**: Avoid human errors and configuration drift
- **Version Control**: Track changes and roll back if needed
- **Scalability**: Easily replicate or scale infrastructure

### ğŸ”§ Popular IaC Tools

| Tool               | Approach                 | Highlights                          |
| ------------------ | ------------------------ | ----------------------------------- |
| Terraform          | Declarative              | Multi-cloud support, modular design |
| AWS CloudFormation | Declarative              | Deep AWS integration                |
| Ansible            | Imperative & Declarative | Agentless, simple YAML playbooks    |
| Puppet             | Declarative              | Strong for complex configurations   |
| Chef               | Imperative               | Ruby-based, highly customizable     |

---

<div style="text-align: center">
  <img src="images/iac-tools-types.png" alt="iac-tools-types" style="width: 100%; border-radius: 10px" />
</div>

---

## ğŸ§  Choosing the Right IaC Tool

Choosing between tools like **Terraform**, **Ansible**, **Chef**, or **Puppet** depends on 3 key factors:

### ğŸ§¾ Declarative vs Procedural

- **Declarative (Terraform, Puppet):**

  > You declare _what_ you want (desired state) â€” the tool figures out _how_ to get there.

- **Procedural (Ansible, Shell):**

  > You describe _how_ to get there step-by-step.

### ğŸ§ª Mutable vs Immutable Infrastructure

- **Mutable:** Modify existing infrastructure (e.g., update live servers)
- **Immutable:** Recreate from scratch (e.g., replace entire server/image)

> Terraform is **mostly immutable** by design â€” ensures clean, reproducible state.

### ğŸ”— Agent vs Agentless

- **Agent-based (e.g., Puppet, Chef):**

  - Requires agent to run on target nodes

- **Agentless (e.g., Ansible, Terraform):**

  - Uses SSH or cloud APIs â€” no software installed on target systems

---

## ğŸ”¨ What Is Terraform?

Terraform is a **declarative, open-source Infrastructure as Code (IaC) tool** developed by HashiCorp.

<div style="text-align: center">
  <img src="images/why-terraform.png" alt="why terraform" style="width: 100%; border-radius: 10px" />
</div>

---

It uses a language called **HCL (HashiCorp Configuration Language)** to describe the desired state of your infrastructure.

### ğŸŒ You can use Terraform to provision:

- AWS / Azure / GCP resources
- Networks, VPCs, load balancers, S3 buckets, EC2s
- DNS records, Kubernetes clusters
- Even SaaS integrations like GitHub or Cloudflare!

---

## âš”ï¸ Terraform vs Ansible

| Feature          | **Terraform**                   | **Ansible**                       |
| ---------------- | ------------------------------- | --------------------------------- |
| Focus            | Infrastructure provisioning     | Configuration + Application setup |
| Language         | Declarative (HCL)               | Procedural (YAML with modules)    |
| Agentless?       | âœ… Yes (uses API)               | âœ… Yes (uses SSH or WinRM)        |
| State Management | âœ… Built-in state tracking      | âŒ No state tracking              |
| Idempotent       | âœ… Yes (reconciles state)       | âœ… Yes (if coded carefully)       |
| Typical Use      | Create & manage cloud resources | Setup software, deploy apps       |

> ğŸ’¡ Use **Terraform** to create the machine, **Ansible** to configure it.

---

## ğŸ§± Terraform Commands for Different Stages

Hereâ€™s a simple Terraform flow with its stages and commands:

### ğŸ”„ `refresh`

```bash
terraform refresh
```

- Syncs Terraformâ€™s state file with actual resources in the cloud

---

### ğŸ§  `plan`

```bash
terraform plan
```

- Shows **what Terraform will do** without actually doing it
- Helps you **review** and **prevent mistakes**

---

### ğŸš€ `apply`

```bash
terraform apply
```

- Applies the plan: creates or updates infrastructure

---

### ğŸ’£ `destroy`

```bash
terraform destroy
```

- Destroys all resources defined in the current `.tf` files

---

## ğŸ“„ Example HCL (Terraform Config)

```ini
provider "aws" {
  version = "~> 2.0"
  region  = "us-east-1"
}

resource "aws_vpc" "example" {
  cidr_block = "10.0.0.0/16"
}
```

This example:

- Configures the AWS provider
- Provisions a new VPC in `us-east-1` with the CIDR block `10.0.0.0/16`

---

## ğŸ§  Terraform Summary

| Concept        | Terraform Does This...                       |
| -------------- | -------------------------------------------- |
| Define state   | Using `.tf` files to describe desired state  |
| Track state    | Saves state in `.tfstate` file               |
| Plan execution | Show changes before applying                 |
| Apply changes  | Provision/update infrastructure in the cloud |
| Destroy        | Cleanly tear down infrastructure             |

---

## âš”ï¸ Terraform vs. Ansible

While both **Terraform** and **Ansible** are powerful Infrastructure as Code (IaC) tools, they serve **different purposes** and operate at **different layers** of the DevOps stack. Understanding when and why to use each is key for effective automation.

---

### ğŸ¯ Purpose

- **Terraform** is used for **provisioning infrastructure** (e.g., creating VMs, networks, storage, DNS).
- **Ansible** is used for **configuring infrastructure** (e.g., installing packages, updating configs, managing services).

---

### ğŸ§  Comparison Table

| Feature                  | **Terraform**                            | **Ansible**                               |
| ------------------------ | ---------------------------------------- | ----------------------------------------- |
| ğŸ”§ **Primary Use**       | Infrastructure provisioning (IaC)        | Configuration management & app deployment |
| ğŸ“œ **Language Type**     | Declarative (HCL)                        | Procedural (YAML + modules)               |
| ğŸš« **Agent Requirement** | Agentless (uses cloud APIs)              | Agentless (uses SSH / WinRM)              |
| ğŸ“¦ **State Management**  | âœ… Maintains state (`.tfstate` file)     | âŒ No native state tracking               |
| ğŸ“‚ **Idempotency**       | Built-in: plans before apply             | Requires careful coding for idempotency   |
| â˜ï¸ **Cloud Support**     | All major clouds, SaaS, custom providers | Also supports cloud but via roles/modules |
| ğŸ› ï¸ **Tool Role**         | "Create the machine"                     | "Configure the machine"                   |
| ğŸ” **Workflow**          | plan â†’ apply â†’ destroy                   | playbook â†’ tasks â†’ handlers               |
| ğŸ§© **Integrations**      | Easily integrates with CI/CD & Packer    | Integrates well with Jenkins, Tower, AWX  |

---

### ğŸ§ª Example Workflow

- **Terraform:**

  ```bash
  terraform init
  terraform plan
  terraform apply
  ```

  â†’ Provisions an AWS EC2 instance

- **Ansible:**

  ```bash
  ansible-playbook webserver.yml
  ```

  â†’ Installs Nginx, updates packages on the EC2 instance

---

### ğŸ§  When to Use What?

| Scenario                                | Best Tool        |
| --------------------------------------- | ---------------- |
| Provisioning cloud infrastructure       | âœ… Terraform     |
| Managing software/config inside servers | âœ… Ansible       |
| Full-stack automation                   | âœ… Both Together |

> ğŸ’¡ **Pro Tip:** Use Terraform to provision resources, and hand off IPs to Ansible for configuration.
