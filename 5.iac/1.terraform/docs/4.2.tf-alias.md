# ðŸ§  What is Terraform `alias`?

_Using Multiple Provider Configurations in One Project!_

---

## ðŸ“Œ Summary

The `alias` keyword in Terraform lets you configure **multiple instances of the same provider** (e.g., AWS, Azure) â€” each with different settings such as region, credentials, or environment. Itâ€™s essential when managing:

- ðŸ—ºï¸ Multi-region infrastructure
- ðŸ‘¥ Multi-account deployments
- ðŸ”„ Multiple roles or profiles

---

## ðŸ§± Basic Syntax

```ini
provider "aws" {
  alias  = "west"
  region = "us-west-1"
}

provider "aws" {
  alias  = "east"
  region = "us-east-1"
}
```

You can now use the aliases like this:

```ini
resource "aws_instance" "web_west" {
  provider      = aws.west
  ami           = "ami-west123"
  instance_type = "t3.micro"
}
```

---

## ðŸ› ï¸ Why Use `alias`?

| Use Case                        | Example                                        |
| ------------------------------- | ---------------------------------------------- |
| ðŸŒ Multi-region deployments     | Deploy EC2 in both `us-west-1` and `us-east-1` |
| ðŸ§ª Test vs Prod environments    | Separate resources in two AWS accounts         |
| ðŸ” Different IAM roles/profiles | Assume different roles for audit/admin         |
| ðŸ§ª Use mock vs real provider    | In testing scenarios                           |

---

## âš™ï¸ Practical Example: Multi-Region Setup

### âœ… Providers Configuration

```ini
provider "aws" {
  alias  = "east"
  region = "us-east-1"
}

provider "aws" {
  alias  = "west"
  region = "us-west-2"
}
```

### âœ… Resource Definitions

```ini
resource "aws_instance" "web_east" {
  provider      = aws.east
  ami           = "ami-12345678"
  instance_type = "t3.micro"
}

resource "aws_instance" "web_west" {
  provider      = aws.west
  ami           = "ami-87654321"
  instance_type = "t3.micro"
}
```

---

## ðŸ‘¥ Example: Multi-Account Deployment (Profiles)

```ini
provider "aws" {
  alias   = "dev"
  region  = "us-east-1"
  profile = "dev-profile"
}

provider "aws" {
  alias   = "prod"
  region  = "us-east-1"
  profile = "prod-profile"
}
```

Use them like this:

```ini
resource "aws_s3_bucket" "dev_bucket" {
  bucket   = "my-dev-bucket"
  provider = aws.dev
}

resource "aws_s3_bucket" "prod_bucket" {
  bucket   = "my-prod-bucket"
  provider = aws.prod
}
```

---

## ðŸ“¦ Using Aliased Providers in Modules

### âœ… In the Root Module

```ini
provider "aws" {
  alias  = "west"
  region = "us-west-1"
}

module "web" {
  source = "./modules/web"
  providers = {
    aws = aws.west
  }
}
```

### âœ… In the Module (no alias required inside)

```ini
resource "aws_instance" "myapp" {
  ami           = "ami-abc123"
  instance_type = "t3.micro"
}
```

> âœ… The root module injects the aliased provider into the module.

---

## â— Common Pitfall: Why Not Use `var.region` in Provider?

You **canâ€™t** dynamically switch regions using a variable inside the provider:

```ini
provider "aws" {
  region = var.region  # âŒ This works for one region only
}
```

> Terraform initializes each provider statically â€” so multiple dynamic configurations are not possible without aliases.

---

## âœ… Best Practices

| Best Practice                    | Reason                                  |
| -------------------------------- | --------------------------------------- |
| Use descriptive alias names      | e.g., `aws_prod`, `aws_dev`, `aws_use1` |
| Use `providers = {}` for modules | Explicit and avoids confusion           |
| Keep alias logic in root module  | Donâ€™t duplicate inside modules          |
| Use aliases for multi-env setups | Promotes clean and scalable design      |

---

## ðŸ§ª CLI Tip to List Providers

You can verify what providers and aliases are used:

```bash
terraform providers
```

Example Output:

```txt
.
â”œâ”€â”€ provider[registry.terraform.io/hashicorp/aws]
â”œâ”€â”€ provider[registry.terraform.io/hashicorp/aws] (alias "dev")
â”œâ”€â”€ provider[registry.terraform.io/hashicorp/aws] (alias "prod")
```

---

## ðŸš€ Real-World Use Case: Centralized Logging in Multi-Region

You could:

- Deploy EC2s in `us-east-1` and `us-west-1`
- Attach CloudWatch logs in both regions
- Upload logs to S3 in a **central region**

Using `alias`, you can manage all those seamlessly in one config.

---

## ðŸ§  Summary

| Feature          | Benefit                                 |
| ---------------- | --------------------------------------- |
| `alias`          | Enables multi-region/account deployment |
| `provider =`     | Explicit control per resource/module    |
| `providers = {}` | Clean modular provider injection        |

> Use `alias` when you need **flexible, scalable, and multi-context Terraform code**.
