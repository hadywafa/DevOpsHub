# ğŸ§  What `docker run` Does

When you run:

```bash
docker container run [OPTIONS] IMAGE [COMMAND] [ARG...]
```

Youâ€™re telling Docker:

> â€œCreate a container from this image, apply these options, and start it with this command.â€

Behind the scenes, `docker run` =
**`docker create` + `docker start` + (optional) `docker attach`**

---

## ğŸ§© Basic Command Structure

| Part                   | Description                                         |
| ---------------------- | --------------------------------------------------- |
| `docker container run` | The main command                                    |
| `[OPTIONS]`            | Configurations that control how the container runs  |
| `IMAGE`                | The image you want to run (e.g., `nginx`, `ubuntu`) |
| `[COMMAND] [ARG...]`   | Optional: the command to run inside the container   |

---

## âš™ï¸ Most Common & Useful Parameters (with examples)

Letâ€™s go through the most-used flags in a friendly, simple way ğŸ‘‡

---

## ğŸ§± 1. `-d` â†’ Detached Mode (Run in Background)

```bash
docker run -d nginx
```

- Runs the container **in the background**.
- You get the container ID immediately, not logs.
- Container keeps running even after you close your terminal.

ğŸ§  Think: _â€œdaemon mode.â€_

---

## ğŸ–¥ï¸ 2. `-it` â†’ Interactive + TTY (Attach to Shell)

```bash
docker run -it ubuntu bash
```

- `-i`: interactive (keeps STDIN open)
- `-t`: allocates a pseudo-TTY (makes it look like a real terminal)
- Together, this lets you open a shell inside the container.

ğŸ§  Think: _â€œGive me a terminal inside the container.â€_

---

## ğŸ”Œ 3. `-p` â†’ Port Mapping (Expose to Host)

```bash
docker run -d -p 8080:80 nginx
```

- Maps **host port 8080 â†’ container port 80**.
- Format: `HOST_PORT:CONTAINER_PORT`.

ğŸ§  Think: _â€œMake this containerâ€™s port visible on my computer.â€_

Example:
Visit `http://localhost:8080` to access Nginx.

---

## ğŸ·ï¸ 4. `--name` â†’ Assign a Custom Container Name

```bash
docker run -d --name myweb nginx
```

- Assigns a readable name instead of random ID.
- Makes commands simpler:

  ```bash
  docker stop myweb
  docker logs myweb
  ```

ğŸ§  Think: _â€œGive it a nickname.â€_

---

## ğŸ’¾ 5. `-v` or `--volume` â†’ Mount Storage

```bash
docker run -d -v /host/data:/container/data nginx
```

- Mounts a **host directory** or a **Docker volume** into the container.
- Format: `host_path:container_path`

ğŸ§  Think: _â€œAttach this folder to the container.â€_

---

## ğŸŒ 6. `--network` â†’ Connect to a Network

```bash
docker run -d --network mynet nginx
```

- Joins the container to a specific Docker network.
- Use `docker network ls` to list networks.

ğŸ§  Think: _â€œPlug this container into a virtual LAN.â€_

---

## ğŸŒ 7. `-e` â†’ Environment Variables

```bash
docker run -d -e MYSQL_ROOT_PASSWORD=secret mysql
```

- Sets environment variables inside the container.

ğŸ§  Think: _â€œSet app configuration values.â€_

---

## ğŸ—‚ï¸ 8. `--rm` â†’ Auto-remove After Exit

```bash
docker run --rm ubuntu echo "Hello"
```

- Container is deleted automatically when it exits.
- Useful for temporary tasks or debugging.

ğŸ§  Think: _â€œDonâ€™t leave garbage behind.â€_

---

## ğŸ§± 9. `--restart` â†’ Restart Policy

```bash
docker run -d --restart always nginx
```

Common options:

| Policy           | Behavior                          |
| ---------------- | --------------------------------- |
| `no`             | Never restart (default)           |
| `always`         | Restart always, even after reboot |
| `on-failure`     | Restart only if exit code â‰  0     |
| `unless-stopped` | Restart unless manually stopped   |

ğŸ§  Think: _â€œKeep my service alive.â€_

---

## ğŸ” 10. `--log-driver` â†’ Logging Method

```bash
docker run -d --log-driver json-file nginx
```

- Control where logs go (`json-file`, `syslog`, `journald`, etc.)

---

## ğŸ”’ 11. `--privileged` â†’ Full Access to Host

```bash
docker run -it --privileged ubuntu bash
```

- Gives container extended permissions (like mounting devices).
  âš ï¸ Dangerous â€” use only for trusted containers.

---

## ğŸ§ 12. `--user` â†’ Run as Specific User

```bash
docker run -u 1000:1000 myapp
```

- Runs container processes as a non-root user.

---

## ğŸ§¾ 13. `--entrypoint` â†’ Override Default Entrypoint

```bash
docker run --entrypoint /bin/bash ubuntu
```

- Replaces the default entrypoint defined in the image.

ğŸ§  Think: _â€œStart with this command instead.â€_

---

## ğŸ” Common Combinations

| Use Case                        | Example                                                    |
| ------------------------------- | ---------------------------------------------------------- |
| Run and connect to shell        | `docker run -it ubuntu bash`                               |
| Run background web app          | `docker run -d -p 8080:80 nginx`                           |
| Run named MySQL container       | `docker run -d --name db -e MYSQL_ROOT_PASSWORD=123 mysql` |
| Temporary container for testing | `docker run --rm -it alpine sh`                            |
| Run and attach volume           | `docker run -v /data:/var/lib/mysql mysql`                 |

---

## ğŸ§­ Quick Summary Table

| Option      | Description            | Example                      |
| ----------- | ---------------------- | ---------------------------- |
| `-d`        | Run in background      | `docker run -d nginx`        |
| `-it`       | Interactive terminal   | `docker run -it ubuntu bash` |
| `-p`        | Port mapping           | `-p 8080:80`                 |
| `--name`    | Custom name            | `--name myapp`               |
| `-v`        | Mount volume           | `-v /data:/app/data`         |
| `-e`        | Env variables          | `-e APP_ENV=prod`            |
| `--rm`      | Auto-remove after exit | `--rm`                       |
| `--network` | Attach to network      | `--network mynet`            |
| `--restart` | Restart policy         | `--restart always`           |

---

## âš™ï¸ Bonus: What Happens Internally When You Run It

<div align="center">

```mermaid
---
config:
  theme: dark
  look: handDrawn
title: "docker run internal workflow"
---
sequenceDiagram
    participant CLI as ğŸ³ docker CLI
    participant Daemon as ğŸ§  dockerd
    participant Containerd as âš™ï¸ containerd
    participant Runc as ğŸ”© runc
    participant OS as ğŸ§¬ Linux Kernel

    CLI->>Daemon: POST /containers/create
    Daemon->>Containerd: Create container metadata
    Containerd->>Runc: Set up namespaces, cgroups, rootfs
    Runc->>OS: clone() new process
    OS->>Runc: Container process started
    CLI->>Daemon: Attach/logs if needed
```

</div>

---

## ğŸš€ TL;DR Summary

> `docker container run` = create + configure + start a container.

âœ… Most-used flags:

```ini
-d       Run in background
-it      Interactive terminal
--name   Assign custom name
-p       Map ports
-v       Mount storage
-e       Set environment variables
--rm     Auto-remove on exit
--restart Manage restart policy
```
