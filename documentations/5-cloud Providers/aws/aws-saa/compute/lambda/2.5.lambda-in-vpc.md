# Lambda In A VPC

## Public Lambda Function (Default)

Lambda functions launch in a Lambda VPC managed by AWS by default.

- By default, Lambda functions have access to the internet. Therefore, they have access to AWS services’ public endpoints.
  ![Lambda Problem with Private Resources](images/lambda-problem-with-private-resources.png)

## Private Lambda Function

- Once we configure the VPC, Subnet ID, and Security Group for the Lambda function, AWS Lambda will launch an ENI in the VPC to allow the Lambda function to communicate
  ![private-lambda-function](images/private-lambda-function.png)

- Lambda gets permissions to create this ENI through the AWSLambdaVPCAccessExecutionRole
- The security groups in the VPC must allow traffic from the Lambda ENI’s security group

## Private Lambda with access to internet

- A Lambda in a VPC does not have internet connectivity by default.
- To connect a Lambda in a private VPC to the Internet, use a NAT gateway in a public subnet inside the VPC.
- To connect a Lambda in a private VPC securely to AWS services, use VPC endpoints.
- We can include more than one subnet in the configuration supplied, this will cause one ENI per subnet to be created (High Availability)
  ![private-lambda-function-with-igw](images/private-lambda-function-with-igw.png)
