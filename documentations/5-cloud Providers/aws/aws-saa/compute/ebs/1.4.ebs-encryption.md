# **EBS Encryption üîê**

Amazon Elastic Block Store (EBS) encryption offers seamless data security by encrypting data at rest using **AWS Key Management Service (KMS)**. The encryption process ensures your data is secure from unauthorized access, both when stored and in transit to and from the EBS volumes. EBS encryption is fully integrated into the EC2 and EBS services without needing additional management from your side.

## **How EBS Encryption Works üîÑ**

The encryption process involves several components working together to ensure your data remains secure. Here‚Äôs how encryption works step-by-step:

![EBS Encryption Lifecycle](images/ebs-encryption.png)

### **Encryption Lifecycle**

- **KMS** generates a **data encryption key** (DEK) that is used to encrypt data.
- **Host encryption module** encrypts the data and decrypts it when necessary.
- **EC2 instance** generates data and sends it to the host encryption module for encryption.
- The **EBS volume** stores the encrypted data.

### **Steps in the Encryption Process**

1. **Data Generation by EC2 Instance**: The EC2 instance generates the data that needs to be stored securely.
   ![Step 1: EC2 sends data to host encryption module](images/ebs-encryption-1.png)

2. **Data Encryption by Host Encryption Module**: The host encryption module uses the encryption key from KMS to encrypt the data before sending it to the EBS volume.
   ![Step 2: Host encryption module encrypts data](images/ebs-encryption-2.png)

3. **Encrypted Data Stored in EBS Volume**: The encrypted data is stored on the EBS volume, where it remains protected at rest.
   ![Step 3: Encrypted data sent to EBS volume](images/ebs-encryption-3.png)

4. **Data Decryption When Accessed**: When the EC2 instance needs to read the data, the host encryption module decrypts the data using the data key and sends it back to the instance.
   ![Step 4: Decrypted data sent to EC2 instance](images/ebs-encryption-4.png)

## **Copying EBS Snapshots üì∏**

- **Snapshots** are point-in-time backups of your EBS volumes that are stored in **Amazon S3** and automatically encrypted at rest.
- You can copy snapshots **within the same region** or **across different regions**. However, to create a volume from a snapshot in another region, you must first copy the snapshot to that region.

**Snapshot Copy Use Cases:**

- **Geographic expansion** üåç
- **Disaster recovery** ‚ö†Ô∏è
- **Migration to another region** üöö
- **Data retention and compliance** üìú

## **Encryption Status of Volumes and Snapshots üîç**

### **1. Encrypting a Volume:**

- When you encrypt a volume using a KMS Key, all the **snapshots**, **volumes restored from snapshots**, and **copies of snapshots** are encrypted automatically.  
  ![Create Encrypted EBS Volume](images/ebs-encryption-use-case-1.png)

### **2. Creating an Encrypted Volume from an Unencrypted Snapshot:**

- You can create an encrypted EBS volume directly from an unencrypted snapshot by enabling encryption during the creation process.  
  ![Copy and Encrypt an Unencrypted Snapshot](images/ebs-encryption-use-case-2.png)

### **3. Re-encrypting an Encrypted Snapshot:**

- While you cannot change the encryption status of an existing volume or snapshot, you can **copy** the snapshot to apply a new KMS key for encryption.  
  ![Re-encrypt Snapshot with New KMS Key](images/ebs-encryption-use-case-3.png)

### **4. Restoring an Encrypted Volume from an Unencrypted Snapshot:**

- You can restore an encrypted volume from an unencrypted snapshot, but it requires copying and enabling encryption during the process.  
  ![Restore from Unencrypted Snapshot](images/ebs-encryption-use-case-4.png)

### **5. Unencrypting an Encrypted Volume:**

Although there‚Äôs no direct way to decrypt an encrypted volume, you can indirectly unencrypt a volume by:

1. **Attaching a second unencrypted volume** to the same EC2 instance.
2. **Migrating the data** from the encrypted volume to the unencrypted volume.
3. Once data is migrated, **delete the encrypted volume** if no longer needed.  
   ![Process of Unencrypting Volume](images/ebs-encryption-use-case-5.png)

## **Account-Level Default Encryption üîí**

### **Enforcing Encryption by Default:**

- You can enable **encryption by default** at the AWS account level for EBS volumes in any region.
- **What happens when it's enabled**:
  - **All new volumes** created will be encrypted by default.
  - **Snapshots and copies** of unencrypted snapshots will be automatically encrypted.
- **Note**: Encryption by default only applies to **new resources**. It does not retroactively encrypt existing volumes or snapshots.
