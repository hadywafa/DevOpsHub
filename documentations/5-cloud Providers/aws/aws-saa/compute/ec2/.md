# EC2 AMIs

## Creating an AMI From an EBS-Backed EC2 Instance

![Creating AMIs Process](x.png)

We can launch an instance and
customize it; then create our own
customized/approved AMI(s) (Golden
AMI)

This include installing monitoring and
security agents, software packages,
applications..etc
The process we follow depends on
the instance’s root volume type.

•The custom AMI includes snapshots
of all attached EBS volumes, and
they get stored in S3.

•The root storage volume of the instance determines the process we follow to
create an AMI.

•For EBS-backed instances, it is recommended to reboot the instance then start the
AMI creation process to ensure data consistency and integrity, then create the AMI.

•For EBS backed instances, AWS registers the created AMIs automatically

•During the AMI-creation process, Amazon EC2 creates snapshots of the instance's
root volume and any other EBS volumes attached to the instance.

## Sharing EC2 AMIs with Other AWS Accounts

•When sharing an AMI that has encrypted volumes, we need to provide permissions
on the KMS keys used to encrypt those volumes’ snapshots.

•If we want to share an AMI with an account in a different region, we need to copy
the AMI to that region first.

•Sharing an AMI does not change its ownership. The owning account is charged for
the storage of the AMI.

1. **Step 1**: Grant the receiving account permissions on the KMS key used to encrypt the ami.
2. **Step 2**: Share the ami privately with the account.
3. **Step 3**: Instruct the receiving account to copy the ami and re-encrypt it with their own KMS key.
4. **Step 4**: Remove the receiving account's access to your KMS key.

![alt text](image.png)

## Copying an EC2 AMI


•We can copy an AMI within the same account in the same region or across
AWS regions.
•We can copy AMIs with encrypted snapshots, AWS will enforce changing the
encryption key to a key(s) in the new region during the process.
AMIs from the marketplace (with billing product codes) and Windows AMIs
can’t be copied to another account.
•To work around that, launch an instance from the AMI, then create an AMI
from that EC2 instance.


