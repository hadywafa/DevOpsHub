# **CloudFront - Origin Server and TTL** üåê

## **Static vs Dynamic Traffic** ‚ö°

Amazon CloudFront is a global Content Delivery Network (CDN) service that securely and cost-effectively delivers content worldwide. CloudFront is optimized for both **static** and **dynamic** content, making it a versatile solution for a wide range of use cases.

### **Supported Content Types:**

- **Static Content**: Files like `.html`, `.js`, `.css`, images, and other resources that don‚Äôt change frequently.
- **Dynamic Content**: Content that changes frequently based on user interactions, such as personalized pages, API responses, and real-time data.
- **Video Streaming**: Both **Live Streaming** and **Video on Demand (VoD)**.
- **APIs**: CloudFront can accelerate API responses, making it ideal for API gateways and microservices.

### **Key Benefits:**

- CloudFront **integrates** with AWS services like **WAF** (Web Application Firewall) and **AWS Shield** to enhance security.
- Delivering content via CloudFront is generally more **cost-effective** than serving it directly from **S3** or **EC2**.

### **Dynamic Traffic Considerations:**

For dynamic content, CloudFront doesn't always provide the same caching benefits, but it still offers **advanced security** features such as encryption and DDoS protection for sensitive and frequently changing content.

## **Origin Server** üñ•Ô∏è

The **Origin Server** is the source of content that CloudFront distributes to its edge locations around the globe.

### **Origin Server Overview:**

- An **origin server** is the actual location where CloudFront fetches the content from when a request is made.
- CloudFront supports up to **25 origins** per distribution (soft limit), allowing for flexible content management and distribution.
  ![Origin Server](images/cdn-origin-server.png)

### **Types of Origins:**

CloudFront can pull content from a variety of origin sources, including:

- **S3 Buckets**
- **S3 Static Websites**
- **EC2 Instances**
- **ALB (Application Load Balancer)**
- **Media Store** or **Media Share** services
- **HTTP Servers** (Inside or outside of AWS)

You can configure **path patterns** in CloudFront to route requests to the correct origin. For example, requests for images might go to an S3 bucket, while API requests go to an EC2 instance.

### **Protocol Support:**

- CloudFront supports **HTTP** and **HTTPS** for communication with both the **viewers** (end users) and **origins** (where the content resides).

## **Custom Domain for Content Delivery** üåç

CloudFront allows you to use **custom domains** for content delivery, providing a branded experience for your users.

### **How Custom Domains Work:**

1. **DNS Resolution**: A user requests an object, like `tree1.jpg`, through a DNS query.
2. **Route to CloudFront Edge**: The DNS routes the request to the nearest CloudFront edge location.
3. **Cache Check**: CloudFront serves the object if it's cached, otherwise, it fetches the object from the **origin** and caches it for future requests.
4. **Reverse Proxy**: CloudFront acts as a reverse proxy, fetching content from your origin and serving it to users.

   ![Custom Domain for Content Delivery](images/cdn-custom-domain.png)

## **Time to Live (TTL)** ‚è≥

**Time to Live (TTL)** defines how long CloudFront will cache an object before checking with the origin server to see if the object has been updated. It helps manage cache behavior for different types of content.

### **TTL Behavior:**

- **Default TTL**: The default TTL is set to **one day** (86400 seconds), meaning CloudFront will cache content for 24 hours.

  ![CDN TTL](images/cdn-ttl.png)

- **TTL = 0**: When set to 0, CloudFront caches the content but checks with the origin server for updates with every new request. This is useful for **dynamic content** that changes frequently but still needs some caching.

### **Adjusting TTL:**

- **Lower TTL**: Lowering the TTL is ideal for dynamic content where frequent updates are required. However, this increases the load on your origin server as CloudFront has to verify content on every request.
- **Higher TTL**: For static content (e.g., images, videos), a higher TTL reduces load on the origin server and improves performance.

## **Key Takeaways** ‚úÖ

- **CloudFront** is ideal for delivering both **static** and **dynamic** content globally.
- **Origin Servers** are flexible and can include S3, EC2, ALBs, and other HTTP servers.
- **TTL settings** control how long CloudFront caches objects and when it checks for updates from the origin.
- Custom **domains** can be mapped to CloudFront distributions for a branded experience.
