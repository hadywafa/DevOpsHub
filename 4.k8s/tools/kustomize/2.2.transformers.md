# âš™ï¸ **Transformers in Kustomize**

## ğŸ”´ **Problem**

You have multiple YAML files â€” Deployment, Service, ConfigMap, etc.
And you need to apply the **same labels, annotations, image updates, or namespaces** across all of them.

Doing it manually means editing 10+ files â€” error-prone, hard to maintain. ğŸ˜©

---

## âœ… **Solution**: **Transformers**

Kustomize has built-in **Transformers** that automatically apply global metadata changes
to every resource defined in your `kustomization.yaml`.

They transform YAMLs _before_ deployment â€” cleanly and declaratively.

---

## ğŸ§° **Common Transformers**

### ğŸ·ï¸ 1. **CommonLabels**

Adds one or more labels to all resources.

```yaml
commonLabels:
  app: myapi
  environment: dev
```

---

<div align="center" style="background-color:#13191E; border-radius: 10px; border: 2px solid">
  <img src="image/1761140768359.png" alt="Kustomize" style="width: 80%">
</div>

---

> âœ… Every manifest (Deployment, Service, etc.) gets these labels.

---

### ğŸ“ 2. **CommonAnnotations**

Adds shared annotations across all resources.

```yaml
commonAnnotations:
  maintainer: devops@mycompany.com
  owner: backend-team
```

---

<div align="center" style="background-color:#13191E; border-radius: 10px; border: 2px solid">
  <img src="image/1761140780293.png" alt="Kustomize" style="width: 80%">
</div>

---

âœ… Great for audit, search, or custom tooling.

---

### ğŸ§© 3. **namePrefix / nameSuffix**

Adds a prefix or suffix to all resource names â€”
useful for separating environments or deployments.

```yaml
namePrefix: dev-
nameSuffix: -v1
```

---

<div align="center" style="background-color:#13191E; border-radius: 10px; border: 2px solid">
  <img src="image/1761140792105.png" alt="Kustomize" style="width: 80%">
</div>

---

> âœ… `Deployment` named `api` becomes `dev-api-v1`.

---

### ğŸ  4. **namespace**

Sets a namespace for all resources that support it.

```yaml
namespace: dev
```

âœ… Automatically adds:

```yaml
metadata:
  namespace: dev
```

---

<div align="center" style="background-color:#13191E; border-radius: 10px; border: 2px solid">
  <img src="image/1761140803212.png" alt="Kustomize" style="width: 80%">
</div>

---

> You no longer need to edit every YAML manually.

---

### ğŸ³ 5. **images**

Overrides image repository, tag, or digest for all matching resources.

```yaml
images:
  - name: myacr.azurecr.io/myapi
    newName: myacr.azurecr.io/myapi
    newTag: v1.2.3
```

âœ… Updates:

```yaml
containers:
  - image: myacr.azurecr.io/myapi:v1.2.3
```

---

<div align="center" style="background-color:#13191E; border-radius: 10px; border: 2px solid">
  <img src="image/1761140818592.png" alt="Kustomize" style="width: 80%">
</div>

---

> Useful for CI/CD pipelines â€” just patch the image version dynamically.

---

## ğŸ”§ Example: Putting It All Together

```yaml
resources:
  - deployment.yaml
  - service.yaml

commonLabels:
  app: myapi
  tier: backend

commonAnnotations:
  owner: dev-team
  contact: dev@mycompany.com

namePrefix: dev-
namespace: dev

images:
  - name: myacr.azurecr.io/myapi
    newTag: v2.0.0
```

âœ… When you run:

```bash
kubectl apply -k .
```

All manifests get:

- Updated image tag
- Prefixed names
- Namespace â€œdevâ€
- Shared labels and annotations

---

## ğŸ’¬ Summary

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Transformer                 | Purpose                               |
| --------------------------- | ------------------------------------- |
| **commonLabels**            | Add global labels                     |
| **commonAnnotations**       | Add global annotations                |
| **namePrefix / nameSuffix** | Rename resources globally             |
| **namespace**               | Set same namespace for all            |
| **images**                  | Override image tags or repos globally |

</div>

---

ğŸ§  **In short:**

> Transformers make your manifests consistent without editing each YAML manually.
