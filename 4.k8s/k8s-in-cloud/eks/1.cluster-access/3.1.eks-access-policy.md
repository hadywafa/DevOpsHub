# ‚ò∏Ô∏è **EKS Access Policies ‚Üî Kubernetes RBAC Mapping**

> üß† AWS didn‚Äôt replace RBAC ‚Äî they **wrapped** it.  
> Each Access Policy maps internally to one or more Kubernetes ClusterRoles or RoleBindings with specific verbs.

---

## üß© **Core Access Policies**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| **Access Policy**             | **Kubernetes Scope** | **RBAC Verbs**                                                        | **Kubernetes Resources**                                         | **Equivalent K8s Role**  |
| ----------------------------- | -------------------- | --------------------------------------------------------------------- | ---------------------------------------------------------------- | ------------------------ |
| `AmazonEKSViewPolicy`         | Namespaced           | `get`, `list`, `watch`                                                | Pods, Services, ConfigMaps, Secrets, Deployments, Events         | `view`                   |
| `AmazonEKSEditPolicy`         | Namespaced           | `get`, `list`, `watch`, `create`, `update`, `patch`, `delete`         | Same as `view` + Deployments, ReplicaSets, Jobs                  | `edit`                   |
| `AmazonEKSAdminPolicy`        | Cluster + Namespace  | All verbs on namespaced resources; limited cluster-scope (no `nodes`) | All core resources except node/system ones                       | Custom admin clusterrole |
| `AmazonEKSClusterAdminPolicy` | Cluster-wide         | `*` (all verbs)                                                       | All API resources, including Nodes, CRDs, cluster-scoped objects | `cluster-admin`          |

</div>

---

## ‚öôÔ∏è **Networking & Load Balancing Policies**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| **Access Policy**                     | **Scope**  | **RBAC Verbs**                                       | **Resources**                               | **Purpose**               |
| ------------------------------------- | ---------- | ---------------------------------------------------- | ------------------------------------------- | ------------------------- |
| `AmazonEKSNetworkingPolicy`           | Namespaced | `get`, `list`, `watch`, `create`, `update`, `delete` | Services, Endpoints, NetworkPolicies        | App-level networking      |
| `AmazonEKSNetworkingClusterPolicy`    | Cluster    | `*`                                                  | Services, Endpoints, IngressClasses, CNI    | Full cluster networking   |
| `AmazonEKSLoadBalancingPolicy`        | Namespaced | `get`, `list`, `watch`, `create`, `update`, `delete` | Services (LoadBalancer), Ingress            | Manage app load balancers |
| `AmazonEKSLoadBalancingClusterPolicy` | Cluster    | `*`                                                  | IngressControllers, LBs, shared controllers | Cluster-wide ingress mgmt |

</div>

---

## üíæ **Storage Policies**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| **Access Policy**                    | **Scope**  | **RBAC Verbs**                             | **Resources**             | **Purpose**           |
| ------------------------------------ | ---------- | ------------------------------------------ | ------------------------- | --------------------- |
| `AmazonEKSBlockStoragePolicy`        | Namespaced | `get`, `list`, `watch`, `create`, `delete` | PersistentVolumeClaims    | App storage mgmt      |
| `AmazonEKSBlockStorageClusterPolicy` | Cluster    | `*`                                        | PVs, PVCs, StorageClasses | Storage admin control |

</div>

---

## üßÆ **Compute Policies**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| **Access Policy**               | **Scope**  | **RBAC Verbs**             | **Resources**                        | **Purpose**                   |
| ------------------------------- | ---------- | -------------------------- | ------------------------------------ | ----------------------------- |
| `AmazonEKSComputePolicy`        | Namespaced | `*` except cluster objects | Pods, Deployments, Jobs, ReplicaSets | App workload management       |
| `AmazonEKSComputeClusterPolicy` | Cluster    | `*`                        | Same as above + DaemonSets, CRDs     | Platform workload management  |
| `AmazonEKSAutoNodePolicy`       | Cluster    | `get`, `patch`             | Nodes                                | Node lifecycle (cordon/drain) |

</div>

---

## üß† **Observability & Hybrid**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| **Access Policy**       | **Scope** | **RBAC Verbs**         | **Resources**                   | **Purpose**             |
| ----------------------- | --------- | ---------------------- | ------------------------------- | ----------------------- |
| `AmazonEKSEventPolicy`  | Cluster   | `get`, `list`, `watch` | Events                          | Observability tools     |
| `AmazonEKSHybridPolicy` | Cluster   | `*`                    | Hybrid (EKS Anywhere) resources | On-prem cluster control |

</div>

---

## üß∞ **Integration & Data Policies**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| **Access Policy**                              | **Scope** | **RBAC Verbs**          | **Resources**                       | **Purpose**                |
| ---------------------------------------------- | --------- | ----------------------- | ----------------------------------- | -------------------------- |
| `AmazonMRJobPolicy`                            | Namespace | `*`                     | EMR-on-EKS Jobs                     | Data processing workloads  |
| `AmazonSagemakerHyperpodClusterPolicy`         | Cluster   | `*`                     | SageMaker CRDs                      | Cluster mgmt for HyperPod  |
| `AmazonSagemakerHyperpodControllerPolicy`      | Cluster   | `get`, `list`, `update` | SageMaker CRDs                      | Controller sync jobs       |
| `AmazonSagemakerHyperpodSystemNamespacePolicy` | Namespace | Restricted              | `amazon-sagemaker-system` resources | SageMaker internal control |
| `AmazonAIOpsAssistantPolicy`                   | Cluster   | `*`                     | AIOps custom resources              | AI Ops automation          |

</div>

---

## üß≠ **Visual Overview**

<div align="center" style="background-color: #2b3436ff; border-radius: 10px; border: 2px solid">

```mermaid
graph LR
IAMRole["AWS IAM Role"] --> AccessEntry["EKS Access Entry"]
AccessEntry --> AccessPolicy["EKS Access Policy"]
AccessPolicy --> RBAC["Kubernetes RBAC (ClusterRole/RoleBinding)"]
RBAC --> Resources["Pods / Nodes / PVC / Ingress / etc."]
```

</div>

üü¢ AWS IAM authenticates  
üîµ EKS Access Policy decides scope and verbs  
üü£ RBAC enforces detailed resource-level permissions

---

## üèÅ **Summary of Hierarchy**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Layer             | Managed By        | Example                     | Purpose                    |
| ----------------- | ----------------- | --------------------------- | -------------------------- |
| **IAM**           | AWS IAM           | `arn:aws:iam::...:role/...` | Authentication             |
| **Access Entry**  | AWS EKS           | Role-to-policy mapping      | Bridge IAM ‚Üí RBAC          |
| **Access Policy** | AWS EKS (Managed) | `AmazonEKSAdminPolicy`      | Simplified permission sets |
| **RBAC**          | Kubernetes        | ClusterRoles, RoleBindings  | Fine-grained enforcement   |

</div>

---

## ‚ö° **TL;DR**

> AWS Access Policies are **managed, opinionated RBAC bundles** that AWS maps internally to Kubernetes roles and verbs.  
> Kubernetes RBAC still applies ‚Äî AWS just automated the bridge between IAM and the RBAC model to reduce friction, risk, and YAML editing.

---

## üéâ **Amazon EKS Access Policies ‚Äî Complete 2025 Edition**

> üìö These are **EKS-native Access Policies**, attached via the **EKS Access Entry** system (not IAM).  
> Each policy grants specific Kubernetes API actions that map to typical AWS/EKS use cases.

---

<div align="center" style="background-color:#131920; border-radius: 10px; border: 2px solid">
    <img src="image/1761548867291.png" alt="EKS Access Policy" style="width: 40%">
</div>

---

### 1Ô∏è‚É£ Core EKS Management Policies

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Policy                            | Description                                                                                   | Typical Use                    |
| --------------------------------- | --------------------------------------------------------------------------------------------- | ------------------------------ |
| **`AmazonEKSViewPolicy`**         | Read-only access to cluster resources (list/get/watch). No write/delete actions.              | Auditors, QA, monitoring tools |
| **`AmazonEKSEditPolicy`**         | Allows create/update/delete for most namespaced resources (Pods, Deployments, Services, etc.) | Developers or CI/CD pipelines  |
| **`AmazonEKSAdminPolicy`**        | Broad admin rights across the cluster but not node-level or system components                 | Platform/DevOps engineers      |
| **`AmazonEKSClusterAdminPolicy`** | Full `cluster-admin` access (includes node viewing and cluster-scoped resources)              | SREs, cluster owners           |

</div>

---

### 2Ô∏è‚É£ EKS Infrastructure Component Policies

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Policy                                    | Description                                                                                | Typical Use                                           |
| ----------------------------------------- | ------------------------------------------------------------------------------------------ | ----------------------------------------------------- |
| **`AmazonEKSComputePolicy`**              | Grants permissions to manage compute workloads (Pods, ReplicaSets, StatefulSets).          | For teams operating app workloads directly.           |
| **`AmazonEKSComputeClusterPolicy`**       | Extends `ComputePolicy` cluster-wide, including cluster-scoped objects related to compute. | Cluster-wide workload administrators.                 |
| **`AmazonEKSLoadBalancingPolicy`**        | Manages Kubernetes Services of type `LoadBalancer`, Ingress, and related annotations.      | Teams deploying internet-facing services.             |
| **`AmazonEKSLoadBalancingClusterPolicy`** | Cluster-wide load balancer management, including shared ingress controllers.               | Network/ingress teams.                                |
| **`AmazonEKSNetworkingPolicy`**           | Manages network resources like Services, Endpoints, and NetworkPolicies in a namespace.    | App developers managing networking for their apps.    |
| **`AmazonEKSNetworkingClusterPolicy`**    | Cluster-wide networking administration (includes CNI, policies, ingress).                  | Network administrators or cluster networking teams.   |
| **`AmazonEKSBlockStoragePolicy`**         | Manage PersistentVolumeClaims (PVCs) in namespaces.                                        | App teams attaching block storage to pods.            |
| **`AmazonEKSBlockStorageClusterPolicy`**  | Cluster-wide block storage operations (PVCs and PVs).                                      | Storage or platform team managing volumes.            |
| **`AmazonEKSAutoNodePolicy`**             | Grants permissions to manage EKS-managed node operations (cordon/drain).                   | Node automation and lifecycle management controllers. |
| **`AmazonEKSComputeClusterPolicy`**       | Full compute management across namespaces including DaemonSets, Jobs, CronJobs.            | Platform team managing workloads across cluster.      |
| **`AmazonEKSLoadBalancingClusterPolicy`** | Cluster-wide management of ingress controllers and LB services.                            | Network/SRE teams ensuring service exposure.          |
| **`AmazonEKSNetworkingClusterPolicy`**    | Full networking management (IngressClass, ServiceAccount networking, CNI configs).         | Network administrators.                               |

</div>

---

### 3Ô∏è‚É£ Specialized EKS Functionality Policies

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Policy                          | Description                                                                   | Typical Use                                 |
| ------------------------------- | ----------------------------------------------------------------------------- | ------------------------------------------- |
| **`AmazonEKSEventPolicy`**      | Allows reading cluster `Events` for monitoring and troubleshooting.           | Observability tools, Prometheus, Datadog.   |
| **`AmazonEKSHybridPolicy`**     | Grants access for managing hybrid (on-prem + EKS Anywhere) cluster resources. | EKS Anywhere / hybrid cloud management.     |
| **`AmazonEKSNetworkingPolicy`** | Namespace-scoped network management (NetworkPolicy, Services).                | Dev teams managing app-level network rules. |

</div>

---

### 4Ô∏è‚É£ Storage & Node Policies

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Policy                                   | Description                                     | Typical Use                     |
| ---------------------------------------- | ----------------------------------------------- | ------------------------------- |
| **`AmazonEKSBlockStoragePolicy`**        | Manage namespace-scoped PersistentVolumeClaims. | Stateful app owners (DB, etc.). |
| **`AmazonEKSBlockStorageClusterPolicy`** | Manage PersistentVolumes across cluster.        | Storage or platform engineers.  |
| **`AmazonEKSComputePolicy`**             | Manage Pods, Deployments, StatefulSets, Jobs.   | App developers.                 |
| **`AmazonEKSComputeClusterPolicy`**      | Manage compute workloads cluster-wide.          | Platform engineers.             |

</div>

---

### 5Ô∏è‚É£ Integration & Supporting Policies

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Policy                                             | Description                                                                   | Typical Use                                 |
| -------------------------------------------------- | ----------------------------------------------------------------------------- | ------------------------------------------- |
| **`AmazonAIOptsAssistantPolicy`**                  | Access policy for AI Ops Assistant integration.                               | AI Ops automation within EKS clusters.      |
| **`AmazonARCRegionSwitchScalingPolicy`**           | Allows auto-scaling and region-switch operations (for ARC-enabled workloads). | Multi-region EKS ARC scaling.               |
| **`AmazonEKSHybridPolicy`**                        | Used for hybrid EKS Anywhere clusters.                                        | On-prem extension management.               |
| **`AmazonMRJobPolicy`**                            | Access for managing EMR-on-EKS Jobs.                                          | Data engineering workloads with EMR-on-EKS. |
| **`AmazonSagemakerHyperpodClusterPolicy`**         | Controls cluster-level management of SageMaker HyperPod.                      | SageMaker distributed training infra.       |
| **`AmazonSagemakerHyperpodControllerPolicy`**      | Allows SageMaker controllers to manage HyperPod jobs.                         | SageMaker infrastructure automation.        |
| **`AmazonSagemakerHyperpodSystemNamespacePolicy`** | Restricts access to the `amazon-sagemaker-system` namespace.                  | SageMaker internal controller components.   |

</div>

---

### üìä Diagram: Policy Category Breakdown

<div align="center" style="background-color: #2b3436ff; border-radius: 10px; border: 2px solid">

```mermaid
graph TD
A[EKS Access Entry] --> B[Core Access Policies]
A --> C[Infra Component Policies]
A --> D[Storage & Compute Policies]
A --> E[Integration Policies]
B --> B1[View / Edit / Admin / ClusterAdmin]
C --> C1[LoadBalancing]
C --> C2[Networking]
C --> C3[BlockStorage]
D --> D1[Compute]
E --> E1[AI Ops Assistant]
E --> E2[SageMaker / EMR Integration]
```

</div>

---

### üìÉ **Quick Summary Table by Category**

| Category              | Example Policies                                          | Key Permissions                         | Typical Users      |
| --------------------- | --------------------------------------------------------- | --------------------------------------- | ------------------ |
| **Core Access**       | `View`, `Edit`, `Admin`, `ClusterAdmin`                   | Basic RBAC across cluster               | Devs, Admins, SREs |
| **Compute**           | `ComputePolicy`, `ComputeClusterPolicy`                   | Manage workloads                        | DevOps, Platform   |
| **Networking**        | `NetworkingPolicy`, `NetworkingClusterPolicy`             | Manage Services, Ingress, NetworkPolicy | Network Teams      |
| **Load Balancing**    | `LoadBalancingPolicy`, `LoadBalancingClusterPolicy`       | Manage Ingress/LB                       | Platform Team      |
| **Storage**           | `BlockStoragePolicy`, `BlockStorageClusterPolicy`         | Manage PVC/PV                           | Storage Admins     |
| **Observability**     | `EventPolicy`                                             | Read events                             | Monitoring tools   |
| **Hybrid & Advanced** | `HybridPolicy`, `AutoNodePolicy`, `AIOptsAssistantPolicy` | Hybrid ops, AI integration              | Cluster automation |
| **External Services** | `SagemakerHyperpod*`, `MRJobPolicy`                       | EKS-integrated services                 | ML/Big Data teams  |

---

### ‚ÅâÔ∏è Why Your `kubectl get nodes` Fails for AmazonEKSAdminPolicy

Your access entry has:

```ini
AmazonEKSAdminPolicy
```

üëâ That policy **does not include node-level (cluster-scoped) permissions**.  
Only these policies can view/manage nodes:

- `AmazonEKSClusterAdminPolicy`
- `AmazonEKSComputeClusterPolicy`
- Possibly `AmazonEKSAutoNodePolicy` (for node lifecycle).

So, to fix your issue:

```bash
aws eks associate-access-policy \
  --cluster-name your-cluster \
  --principal-arn arn:aws:sts::account:role/orchida-tax-eks-admin \
  --policy-arn arn:aws:eks::aws:cluster-access-policy/AmazonEKSClusterAdminPolicy \
  --access-scope type=cluster
```
