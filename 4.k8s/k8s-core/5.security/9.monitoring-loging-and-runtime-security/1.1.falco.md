# ğŸº **Falco â€” Runtime Security for Kubernetes**

_Falco is the â€œsecurity cameraâ€ of your containers and Kubernetes cluster._

---

## ğŸ“– **What is Falco?**

**Falco** (originally by Sysdig, now a CNCF project) is a **runtime threat detection tool** for:

- Kubernetes clusters
- Linux hosts
- Containers
- Cloud-native workloads

Falco continuously monitors **syscalls** (system calls) in real time and triggers alerts when suspicious activity occurs.

---

<div align="center" style="background-color:#F1F1F1; border-radius: 10px; border: 2px solid">
<img src="image/1763555401305.png" alt="OpenSSL" style="width: 60%">
</div>

---

<div align="center" style="background-color:#F1F1F1; border-radius: 10px; border: 2px solid">
<img src="image/1763555419353.png" alt="OpenSSL" style="width: 60%">
</div>

---

## ğŸ¥ **Think of Falco As:**

> â€œA security camera + intrusion detection system for your containers.â€

Where tools like **Trivy** scan **images**,
**Falco** catches attacks **while containers are running**.

---

## ğŸ” **What Falco Detects**

Falco detects behaviors such as:

- âœ” A container spawning a shell
- âœ” Unexpected file or directory changes
- âœ” Sensitive files being read
- âœ” Privilege escalation attempts
- âœ” Network connections to unknown IPs
- âœ” Writing to `/etc/passwd`
- âœ” Using `curl/wget` inside a pod
- âœ” Cryptomining indicators
- âœ” Exec into pods (`kubectl exec`)
- âœ” Kernel module loading (rootkits)

---

## â‰ï¸ **How Falco Actually Works**

Falco uses:

### **A. eBPF or Kernel Module (Syscall Capture)**

Falco attaches to the Linux kernel to watch system calls such as:

- `execve()`
- `open()`
- `read()`
- `write()`
- `connect()`

### **B. Rules Engine**

If a syscall violates a rule â†’ **Alert**

### **C. Outputs**

- logs
- events
- Slack notifications
- Webhooks
- Alert managers
- SIEM (Splunk, ELK, Datadog)

---

## âš™ï¸ **Falco Architecture**

<div align="center" style="background-color:#F1F1F1; border-radius: 10px; border: 2px solid">
<img src="image/1763555531097.png" alt="OpenSSL" style="width: 60%">
</div>

---

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

```mermaid
---
config:
  theme: dark
  look: handDrawn
title: "Falco Runtime Security in Kubernetes"
---

flowchart TD
    A["â˜¸ï¸ Kubernetes"]
    B["ğŸ“¦ Pod Runtime Activity"]
    C["ğŸ•µï¸ Falco (eBPF)<br>Monitors Syscalls"]
    D["ğŸ“œ Applies Falco Rules"]
    E["ğŸš¨ Alerts / Actions"]

    A --> B
    B --> C
    C --> D
    D --> E
```

</div>

---

## ğŸ“ **Example Behaviors Falco Detects**

### 1ï¸âƒ£ Container spawning a shell

âŒ Dangerous behavior

```ini
Rule: Terminal shell in container
Condition: container.id != host and proc.name in (bash, sh, zsh)
Output: Container shell spawned
```

### 2ï¸âƒ£ Writing to `/etc/shadow`

âŒ Very suspicious

```ini
Rule: Modify shadow file
Condition: fd.name="/etc/shadow" and evt.type in (write)
```

### 3ï¸âƒ£ Suspicious outbound network call

```ini
Rule: Contacting suspicious IP
Condition: evt.type=connect and fd.sip in (known_bad_ips)
```

---

## ğŸ“¦ Installation

### 1ï¸âƒ£ Install Falco as Systemd Service

> better of k8s comprimise and falco need to work independtly

```bash
# add falco repo
curl -s https://falco.org/repo/falcosecurity-3672BA8F.asc | sudo apt-key add -
echo "deb https://downloads.falco.org/packages/deb stable main" | sudo tee -a /etc/apt/sources.list.d/falcosecurity.list

# update
sudo apt-get update -y
sudo apt-get install -y linux-headers-$(uname -r)

# install falco
sudo apt-get install -y falco
sudo systemctl start falco
```

---

### 2ï¸âƒ£ Install Falco as Kubernetes DaemonSet (use Helm)

```bash
helm repo add falcosecurity https://falcosecurity.github.io/charts
helm repo update
helm install falco falcosecurity/falco --namespace falco --create-namespace
```

---

## ğŸ§ª **Test Falco** (Generate Alerts)

### If you installed Falco as a Systemd Service

See Service Profile:

```bash
sudo cat /lib/systemd/system/falco.service
```

Run:

```bash
sudo systemctl status falco
```

See Logs:

```bash
journalctl -u falco -f
```

---

### If you installed Falco as a Kubernetes DaemonSet

After installation, run:

```bash
kubectl exec -it <pod> -- bash
```

Falco will detect:

```ini
Falco alert: Terminal shell in container
```

Another test:

Inside a container:

```bash
touch /etc/shadow
```

Falco alert:

```ini
Falco alert: Write below etc detected (user=root)
```

---

## ğŸ“œ **Falco Rules (How You Customize Security)**

Falco uses rule files in YAML format:

### ğŸ”¹ Example: detect if a container uses `curl`

```yaml
- rule: Unexpected Curl Command
  desc: Detect curl in containers (data exfil)
  condition: evt.type=execve and container.id != host and proc.name=curl
  output: "Container using curl (user=%user.name container=%container.id)"
  priority: NOTICE
```

### ğŸ”¹ Example: prevent running as root

```yaml
- rule: Container Started As Root
  condition: container and user.uid=0
  output: "Pod running as root: %container.name"
  priority: WARNING
```

---

## ğŸ“¦ **Falco Sidekick** (For Sending Alerts)

Falco can integrate with many outputs using **Falco Sidekick**:

### Install Sidekick

```bash
helm install falcosidekick \
     falcosecurity/falcosidekick \
     --namespace falco
```

### Sidekick Targets:

- Slack
- Teams
- Discord
- Kafka
- AWS SNS
- S3
- Webhook
- Elasticsearch
- Datadog
- Prometheus

---

## âš”ï¸ **Falco vs Other Tools**

| Tool               | Purpose                                         |
| ------------------ | ----------------------------------------------- |
| **Trivy**          | Scans vulnerabilities (CVE) in images/files/IaC |
| **Grype**          | Image CVE scanner                               |
| **KubeLinter**     | YAML static security checks                     |
| **Kubesec**        | YAML risk scoring                               |
| **Falco**          | Runtime detection (live monitoring)             |
| **OPA/Gatekeeper** | Admission control policies                      |

> ğŸ§  Think as:
> **Trivy/KubeLinter/Kubesec = Prevent security issues before deployment** > **Falco = Detect attacks after deployment**

---

## ğŸ›¡ï¸ **Typical DevSecOps Workflow**

- 1ï¸âƒ£ Build image -> Scan with Trivy
- 2ï¸âƒ£ Validate YAML -> KubeLinter
- 3ï¸âƒ£ Enforce policies -> OPA/Gatekeeper
- 4ï¸âƒ£ Deploy
- 5ï¸âƒ£ Monitor runtime -> Falco
- 6ï¸âƒ£ Incident Response -> Alerting / dashboards

Falco is the **runtime** part of the pipeline.

---

## ğŸ¯ When You Should Use Falco

Use Falco when you want:

- Real-time detection of suspicious actions
- Protection against zero-day attacks
- Monitoring of pod exec activity
- Defense against container escape attempts
- Detection of malicious scripts
- Runtime compliance & audit

Falco is essential for production-grade Kubernetes security.

---

## ğŸ Final Summary

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Feature          | Explanation                                        |
| ---------------- | -------------------------------------------------- |
| **Falco**        | Runtime security engine for Kubernetes & nodes     |
| **Monitors**     | Syscalls (via eBPF)                                |
| **Detects**      | Suspicious behavior, privilege escalation, malware |
| **Strength**     | Zero-day behavior detection                        |
| **Rules**        | YAML-based, fully customizable                     |
| **Installation** | Helm-based DaemonSet                               |
| **Integrations** | Slack, SIEM, Prometheus, Webhooks                  |

</div>

> Falco is the **runtime security brain** of modern Kubernetes environments.

---

## ğŸ”— References:

- <https://falco.org/docs/getting-started/installation/>
- <https://github.com/falcosecurity/charts/tree/master/falco>
- <https://falco.org/docs/rules/supported-fields/>
- <https://falco.org/docs/rules/default-macros/>
- <https://falco.org/docs/configuration/>

---

If you want next:

- ğŸ”¸ **Falco + Falcosidekick with Slack notifications**
- ğŸ”¸ **How to write custom Falco rules**
- ğŸ”¸ **Falco vs eBPF security tools like Cilium Tetragon**
- ğŸ”¸ **Full hands-on setup for production clusters**

Just tell me!
