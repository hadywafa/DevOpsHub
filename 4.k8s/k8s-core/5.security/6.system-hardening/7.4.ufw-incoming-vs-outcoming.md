# âœ… **UFW Incoming vs Outgoing Rules**

UFW manages **two types of traffic**:

- **Incoming traffic** â†’ traffic that _comes into your system_ (from the internet or other hosts)
- **Outgoing traffic** â†’ traffic that _your system sends out_

By default:

| Direction    | Default Policy      |
| ------------ | ------------------- |
| **Incoming** | **DENY** (blocked)  |
| **Outgoing** | **ALLOW** (allowed) |

---

## ğŸš¦ **1. Incoming Rules (Traffic coming to your machine)**

ğŸ‘‰ Used when **clients want to reach your application**.

### **Rule Syntax (Incoming)**

- âœ” Allow incoming on port

  ```bash
  sudo ufw allow 80
  ```

- âœ” Allow incoming with protocol

  ```bash
  sudo ufw allow 443/tcp
  ```

- âœ” Allow incoming from specific IP

  ```bash
  sudo ufw allow from 192.168.10.5
  ```

- âœ” Allow incoming from IP to specific port

  ```bash
  sudo ufw allow from 192.168.1.10 to any port 22 proto tcp
  ```

- âœ” Deny incoming

  ```bash
  sudo ufw deny 23
  ```

> âš ï¸ Notice:  
> We did NOT specify _in_ or _out_ â€” this is because `allow/deny` **assume incoming** unless you add `out`.

---

## ğŸš€ **Outgoing Rules (Traffic leaving your machine)**

ğŸ‘‰ Used when **you want to restrict what your server can access outside**  
(e.g., only allow outgoing 80/443, block SSH to outside, etc.)

### **Rule Syntax (Outgoing)**

- âœ” Allow outgoing on port

  ```bash
  sudo ufw allow out 443/tcp
  ```

- âœ” Deny outgoing traffic on a port

  ```bash
  sudo ufw deny out 25
  ```

- âœ” Allow outgoing to a specific IP

  ```bash
  sudo ufw allow out to 8.8.8.8 port 53
  ```

- âœ” Block outgoing DNS

  ```bash
  sudo ufw deny out 53
  ```

> âš ï¸ Outgoing rules **must** include `out`,Otherwise, the rule is for incoming.

---

## ğŸ§  **THE MAGIC RULE TO AVOID CONFUSION**

ğŸ‘‰ **If you want to allow/deny incoming traffic â†’ NO â€œoutâ€ keyword**  
ğŸ‘‰ **If you want to allow/deny outgoing traffic â†’ MUST use â€œoutâ€**

Examples:

### Incoming (NO â€œoutâ€)

```bash
ufw allow 22
ufw deny 3306
ufw allow from 1.2.3.4 to any port 80
```

### Outgoing (WITH â€œoutâ€)

```bash
ufw allow out 80
ufw deny out 25
ufw allow out to 8.8.8.8 port 53
```

---

## ğŸ”¥ **Default Policies**

View defaults:

```bash
sudo ufw status verbose
```

Set incoming default to ALLOW or DENY:

```bash
sudo ufw default deny incoming
```

Set outgoing default:

```bash
sudo ufw default deny outgoing
```

---

## ğŸ¯ **Example Scenarios**

### **Scenario A: Allow only HTTP/HTTPS incoming and block all others**

```bash
sudo ufw default deny incoming
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
```

### **Scenario B: Block all outgoing except DNS + HTTPS**

```bash
sudo ufw default deny outgoing
sudo ufw allow out 53
sudo ufw allow out 443
```

### **Scenario C: Block server from sending email**

```bash
sudo ufw deny out 25
sudo ufw deny out 587
```

### **Scenario D: Allow incoming SSH ONLY from a trusted IP**

```bash
sudo ufw allow from 203.0.113.7 to any port 22 proto tcp
```

---

## ğŸ“Œ **Helpful Monitoring Commands**

### List numbered rules

```bash
sudo ufw status numbered
```

### Delete rule

```bash
sudo ufw delete <rule-number>
```

### Disable / Enable

```bash
sudo ufw disable
sudo ufw enable
```

---

## ğŸ§© **Summary â€” The 5-Line Remember-Forever Guide**

| Purpose                   | Command Pattern                          |
| ------------------------- | ---------------------------------------- |
| **Incoming allow**        | `ufw allow <port>`                       |
| **Incoming deny**         | `ufw deny <port>`                        |
| **Outgoing allow**        | `ufw allow out <port>`                   |
| **Outgoing deny**         | `ufw deny out <port>`                    |
| **From/to specific host** | `ufw allow from <IP> to any port <port>` |

ğŸ‘‰ Only **outgoing** rules require **"out"**  
ğŸ‘‰ If "out" is missing â†’ rule applies to **incoming**
