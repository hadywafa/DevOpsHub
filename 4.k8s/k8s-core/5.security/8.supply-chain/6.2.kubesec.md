# ğŸ” **KubeSec (kubesec.io)**

## **ğŸ” What It Is**

**KubeSec** (by _ControlPlane_) is a **Kubernetes manifest security scanner**.
It performs **security-focused static analysis** of your YAML files and returns:

- A **risk score** (0â€“10)
- A list of **security issues**
- **Reasons + remediation** guidance

Unlike kube-score/kubectl lint tools, **KubeSec is 100% security-focused**, not best practices or production checks.

---

## ğŸ§© **KubeSec Focus Areas**

KubeSec checks Kubernetes YAML for **security misconfigurations**, specifically:

### ğŸ”¥ 1. **Privilege Escalation Risks**

- `securityContext.privileged: true`
- Capabilities like `NET_RAW`, `SYS_ADMIN`
- Containers running as **root**

### ğŸ”¥ 2. **Host Access Risks**

- `hostNetwork: true`
- `hostPath` mounted
- `hostPID` / `hostIPC`

### ğŸ”¥ 3. **Filesystem Risk**

- Writable `rootfs`
- No `readOnlyRootFilesystem`

### ğŸ”¥ 4. **Secrets Handling**

- Hardcoded secret values in ENV
- Secret keys mounted incorrectly

### ğŸ”¥ 5. **Network Risk**

- Missing NetworkPolicy
- Open traffic between namespaces

### ğŸ”¥ 6. **Missing Security Controls**

- Missing seccomp
- Missing AppArmor
- Missing capabilities drop
- No securityContext at all

---

## ğŸ§® **What KubeSec Output Looks Like**

Scan a YAML:

```bash
kubesec scan deployment.yaml
```

ğŸ” Example output:

```json
{
  "score": 4,
  "scoring": {
    "critical": [{ "selector": "containers[] .securityContext .privileged == true" }],
    "advise": ["Drop NET_RAW capability", "Use read-only root filesystem"],
    "passed": ["Image tag not latest"]
  }
}
```

- âœ” Score **4/10** â†’ bad
- âœ” Lists exact **dangerous fields**

---

## âœğŸ» **Hands-On Example**

Let's scan this unsafe Deployment:

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: insecure
spec:
  replicas: 1
  template:
    spec:
      containers:
        - name: app
          image: nginx:latest
          securityContext:
            privileged: true
            readOnlyRootFilesystem: false
          env:
            - name: SECRET
              value: "mysecret123"
```

Run:

```ini
kubesec scan insecure.yaml
```

Output:

```ini
score: 3
critical:
  - Privileged container
  - Hard-coded secrets in env
warn:
  - root filesystem is not readOnly
advise:
  - Avoid using latest tag
```

---

> ğŸš¨ **This is how KubeSec catches vulnerabilities before deploying.**

---

## ğŸ› ï¸ How to Install KubeSec

### Install via script:

```bash
curl -s https://raw.githubusercontent.com/controlplaneio/kubesec/master/install.sh | bash
```

### Or download binary:

```bash
curl -LO https://github.com/controlplaneio/kubesec/releases/latest/download/kubesec-linux-amd64
chmod +x kubesec-linux-amd64
sudo mv kubesec-linux-amd64 /usr/local/bin/kubesec
```

---

## ğŸ•¸ï¸ **How KubeSec Works Internally**

KubeSec uses a rules engine that checks:

### âœ” JSONPath selectors

Example:

```json
{
  "selector": "containers[].securityContext.privileged == true"
}
```

### âœ” Built-in rule categories:

- Critical
- Warning
- Advice
- Passed

### âœ” Final Score:

- Each violation decreases score
- Secure config += points

---

## ğŸ† **KubeSec vs KubeLinter**

| Feature                          | **KubeSec**                                   | **KubeLinter**                                |
| -------------------------------- | --------------------------------------------- | --------------------------------------------- |
| **Purpose**                      | PURE security scanning                        | Security + production readiness               |
| **Output**                       | **Score (0â€“10)**                              | Failures per rule                             |
| **Checks**                       | Privileged, capabilities, secrets, filesystem | Probes, resources, PSP/PSS, security, network |
| **Custom rules**                 | âŒ No                                         | âœ… Yes                                        |
| **Catches CVE risk?**            | âŒ No                                         | âŒ No (use Grype)                             |
| **Ingress/NetworkPolicy checks** | Limited                                       | Very strong                                   |
| **Target Users**                 | DevSecOps, Red Team                           | SRE, DevOps, Platform teams                   |
| **UI**                           | Web UI + CLI                                  | CLI only                                      |

### âš¡ TL;DR

- **KubeSec** â†’ Deep **security scanner** (privileged, host access, root, secrets).
- **KubeLinter** â†’ Broad **Kubernetes manifest linter** (probes, resources, PSS, best practices).

If you're doing cluster hardening:

ğŸ‘‰ **Use both.**

---

## ğŸ¯ When to Use KubeSec

Use KubeSec when you need to detect:

- âœ” Privileged containers
- âœ” Dangerous capabilities
- âœ” HostPath mounts
- âœ” Secrets in ENV
- âœ” Containers running as root
- âœ” Unconfined seccomp

It specializes in **pure security** â€” nothing else.

---

## ğŸ§µ Final Summary (Very Easy to Remember)

- **KubeSec = Security scanner (score-based)**
- **KubeLinter = Best-practices + security linter**
- KubeSec = focused only on dangerous configuration
- KubeLinter = works like a Kubernetes â€œlinting engineâ€

---

If you want, I can also generate:

- ğŸ”¥ A CI/CD pipeline integrating **KubeSec + KubeLinter + Syft + Grype + Cosign**
- ğŸ”¥ A complete **DevSecOps Kubernetes Hardening Playbook**
- ğŸ”¥ A comparison with **OPA Gatekeeper** and **Kyverno**

Just tell me!
