# ğŸ“ƒ Software Bill of Materials (SBOM)

A **Software Bill of Materials (SBOM)** is:

> **A complete list of all software components and dependencies that make up an application.**
> Including â†’ libraries, OS packages, frameworks, licenses, versions, and metadata.

It acts like a **"nutritional label"** but for software.

---

<div align="center" style="background-color:#F1F1F1; border-radius: 10px; border: 2px solid">
<img src="image/1763521040110.png" alt="OpenSSL" style="width: 80%">
</div>

---

<div align="center" style="background-color:#F1F1F1; border-radius: 10px; border: 2px solid">
<img src="image/1763520996601.png" alt="OpenSSL" style="width: 80%">
</div>

---

## ğŸ“– **What Is an SBOM?**

An SBOM contains **metadata** describing:

- Application information
- Package names
- Versions
- Dependencies
- Relationships
- Licenses
- Hashes (integrity)
- Supplier information

Example (VERY simple example):

```json
{
  "name": "payment-service",
  "version": "1.3.0",
  "components": [
    { "name": "openssl", "version": "1.1.1g", "license": "Apache-2.0" },
    { "name": "flask", "version": "1.1.2", "license": "BSD-3-Clause" }
  ]
}
```

Real SBOMs often contain **hundreds of components**.

---

## â“ **Why is an SBOM Important?**

Modern software is **70â€“90% third-party dependencies** (Open Source, vendor libraries).
This introduces:

- Unknown vulnerabilities
- Hidden outdated packages
- License violations
- Dormant malware or supply-chain attacks

SBOMs solve this by providing transparency.

## âœ… **Benefits**

### âœ” **1. Quick Vulnerability Detection**

- If a CVE appears (example: `Log4Shell`), you immediately know which apps include it.

### âœ” **2. Dependency Governance**

- Understand exactly _what_ and _why_ is inside your software.

### âœ” **3. License Compliance**

- Detect GPL, LGPL, Apache, MIT, proprietary licenses.

### âœ” **4. Stronger Supply Chain Security**

- Required by:

  - US Executive Order 14028
  - NIST
  - DHS
  - Many federal & enterprise customers

---

## ğŸ§© **SBOM Components**

<div align="center" style="background-color:#F1F1F1; border-radius: 10px; border: 2px solid">
<img src="image/1763521186409.png" alt="OpenSSL" style="width: 80%">
</div>

---

### âœ” Component name

- `openssl`, `log4j-core`, `libc6`

### âœ” Component type

- Library
- Container layer
- Application
- Kernel package

### âœ” Version

- Critical for identifying CVEs.

### âœ” Hashes (SHA-256 / SHA-512)

- You can verify no tampering occurred.

### âœ” Supplier / Owner

- Who created it?

  - Apache Foundation
  - RedHat
  - Docker

### âœ” Relationships

- Dependency graph:

  ```ini
  payment-service â†’ flask â†’ werkzeug â†’ markupsafe
  ```

### âœ” License

- Know if youâ€™re illegally using GPL software.

---

## ğŸ§¾ **SBOM Formats**

There are **two industry-standard formats**.

---

### ğŸ“„ 1. **SPDX (Linux Foundation)**

- Origin: **Linux Foundation**
- Very detailed, heavy specification
- Used by:

  - Linux distributions
  - ISO standardization
  - Enterprises requiring legal/OS compliance

Example SPDX snippet:

```text
PackageName: flask
PackageVersion: 1.1.2
PackageSupplier: Python Software Foundation
PackageLicenseDeclared: BSD-3-Clause
```

---

### ğŸŒ€ 2. **CycloneDX (OWASP)**

- Origin: **OWASP**
- Lightweight, fast
- Designed for security â†’ CVE detection pipelines
- Used by:

  - GitHub
  - GitLab
  - Dependency-Track
  - Anchore Grype

Example CycloneDX JSON:

```json
{
  "bomFormat": "CycloneDX",
  "components": [{ "name": "flask", "version": "1.1.2", "type": "library" }]
}
```

---

### âš”ï¸ **SPDX vs CycloneDX**

![1764785208096](image/4.SBOM/1764785208096.png)

---

| Feature        | SPDX                   | CycloneDX                        |
| -------------- | ---------------------- | -------------------------------- |
| **Origin**     | Linux Foundation       | OWASP                            |
| **Use Case**   | License compliance     | Security (CVE tracking)          |
| **Format**     | Tag/value              | JSON/XML/Protobuf                |
| **Complexity** | Heavy                  | Lightweight                      |
| **Tooling**    | Package-level tracking | App + container + infrastructure |

**For DevSecOps pipelines â†’ CycloneDX is the most popular.**

---

## ğŸ”¨ **SBOM Tools**

**You can generate an SBOM (Software Bill of Materials) in three main ways: from source code, from binaries or from containers each method fits different stages of the software lifecycle and security needs.**

---

### ğŸ”¹ 1. **From Source Code**

This method analyzes your codebase and dependencies directly.

ğŸ”§ Tools:

- **Syft** (`syft dir:.`)
- **CycloneDX CLI** (`cyclonedx-bom -o sbom.xml`)
- **FOSSA**, **Snyk**, **OWASP Dependency-Check**

âœ… Pros:

- High visibility into declared dependencies
- Easy to integrate into CI/CD pipelines

âš ï¸ Cons:

- May miss runtime or transitive dependencies
- Language-specific (e.g., npm, pip, go.mod)

---

### ğŸ”¹ 2. **From Binaries**

This scans compiled artifacts (e.g., `.exe`, `.jar`, `.so`) to infer components.

ğŸ”§ Tools:

- **Syft** (`syft file:myapp`)
- **Binary Analysis tools** like **Black Duck**, **Revenera**

âœ… Pros:

- Works even without source code
- Useful for third-party or legacy software

âš ï¸ Cons:

- Lower accuracy
- Harder to trace back to original source

---

### ğŸ”¹ 3. **From Container Images**

This inspects container layers to extract installed packages and libraries.

ğŸ”§ Tools:

- **Syft** (`syft docker:myimage`)
- **Trivy** (`trivy image --format cyclonedx`)
- **Anchore**, **Grype**

âœ… Pros:

- Captures OS packages and runtime deps
- Ideal for production-ready artifacts

âš ï¸ Cons:

- May include unnecessary layers
- Doesnâ€™t show build-time dependencies

---

## â™¾ï¸ **SBOM Workflows**

A secure SBOM pipeline has **6 steps**:

---

<div align="center" style="background-color:#F1F1F1; border-radius: 10px; border: 2px solid">
<img src="image/1763522744209.png" alt="OpenSSL" style="width: 80%">
</div>

---

### 1ï¸âƒ£ Generate SBOMs

<div align="center" style="background-color:#F1F1F1; border-radius: 10px; border: 2px solid">
<img src="image/1763522950518.png" alt="OpenSSL" style="width: 80%">
</div>

---

Generate SBOMs during build time.

Tools:

- âœ” Trivy

  ```bash
  trivy sbom --format cyclonedx --output sbom.json .
  ```

- âœ” Syft

  ```bash
  syft . -o cyclonedx-json > sbom.json
  ```

- âœ” Docker built-in (Docker SBOM)

  ```bash
  docker sbom myapp:latest
  ```

---

### 2ï¸âƒ£ Store SBOMs

<div align="center" style="background-color:#F1F1F1; border-radius: 10px; border: 2px solid">
<img src="image/1763522985797.png" alt="OpenSSL" style="width: 80%">
</div>

---

SBOMs must be **stored securely**.

Options:

- OCI registry (Harbor, ECR, GCR, ACR)
- Dependency-Track
- GitHub Artifacts
- S3 bucket
- Databases

Example:  
Store SBOM as OCI artifact:

```bash
oras push registry/repo/myapp-sbom:1.0 sbom.json
```

---

### 3ï¸âƒ£ Scan SBOMs

<div align="center" style="background-color:#F1F1F1; border-radius: 10px; border: 2px solid">
<img src="image/1763523047393.png" alt="OpenSSL" style="width: 80%">
</div>

---

Tools read SBOMs and find vulnerabilities:

- **Grype**
- **Dependency-Track**
- **OpenVEX**
- **Trivy**

Example:

```bash
grype sbom:sbom.json
```

Output (example):

```ini
CVE-2022-1234  flask 1.1.2 â†’ upgrade to 2.3.0
```

---

### 4ï¸âƒ£ Analyze SBOMs

<div align="center" style="background-color:#F1F1F1; border-radius: 10px; border: 2px solid">
<img src="image/1763523081035.png" alt="OpenSSL" style="width: 80%">
</div>

---

Analysis includes:

- âœ” CVE trends

  - Which dependencies are most problematic?

- âœ” License risks

  - GPL code? MIT? Apache?

- âœ” Version risk

  - Outdated packages?

- âœ” Dependency graph

  - Which app includes what?

  - Example graph:

    ```ini
    payment-service
    â”œâ”€â”€ flask 1.1.2 (CVE-2022-1234)
    â””â”€â”€ openssl 1.1.1g (CVE-2021-3712)
    ```

---

### 5ï¸âƒ£ Remediate SBOM Findings

<div align="center" style="background-color:#F1F1F1; border-radius: 10px; border: 2px solid">
<img src="image/1763523157942.png" alt="OpenSSL" style="width: 80%">
</div>

---

Typical actions:

- âœ” Upgrade vulnerable package

  - `flask â†’ 2.0.3`

- âœ” Switch base image

  - `ubuntu â†’ alpine`

- âœ” Remove unused libraries

  - Detected by `syft` or `trivy`

- âœ” Add security patches

  - (especially for OS-level packages)

---

### 6ï¸âƒ£ Monitor SBOMs

Once stored, keep monitoring:

- If new vulnerability shows up
- If a package becomes unmaintained
- If a license changes
- If a dependency version is deprecated

Tools:

- OWASP Dependency Track
- Anchore Enterprise
- Snyk Monitor
- GitHub Dependabot

Example:
Dependency Track continuously alerts:

```ini
New CVE found affecting component "openssl 1.1.1g"
Affected projects: payment-service, identity-service
```

---

## âœğŸ» **Practical End-to-End SBOM Example**

Letâ€™s generate â†’ store â†’ scan â†’ analyze an SBOM for a Node.js app.

### ğŸ”¹ **1. Generate SBOM**

```bash
syft node-app/ -o cyclonedx-json > sbom.json
```

### ğŸ”¹ **2. Scan for vulnerabilities**

```bash
grype sbom:sbom.json
```

Output (example):

```ini
CVE-2022-3517 lodash 4.17.19 â€” critical
```

### ğŸ”¹ **3. Fix dependency in `package.json`**

```json
"lodash": "^4.17.21"
```

### ğŸ”¹ **4. Regenerate SBOM**

```bash
syft node-app -o cyclonedx-json > sbom.json
```

### ğŸ”¹ **5. Upload SBOM to OCI registry**

```bash
oras push registry/apps/node-app-sbom:v2 sbom.json
```

### ğŸ”¹ **6. Continuous Monitoring**

Upload `sbom.json` to **Dependency Track** for continuous scanning.

---

## ğŸ **Summary**

| Topic                | Summary                                                       |
| -------------------- | ------------------------------------------------------------- |
| **SBOM**             | Full inventory of all software components                     |
| **Importance**       | Detect vulnerabilities, enforce licenses, secure supply chain |
| **Formats**          | SPDX (legal), CycloneDX (security)                            |
| **Generation Tools** | Syft, Trivy, Docker SBOM                                      |
| **Scanning Tools**   | Grype, Dependency-Track                                       |
| **Workflow**         | Generate â†’ Store â†’ Scan â†’ Analyze â†’ Remediate â†’ Monitor       |
| **Value**            | Faster CVE response, transparency, compliance                 |

---

## âœ… If you want next:

I can also explain any of these topics in your preferred style:

- âœ” **SBOM in Kubernetes**
- âœ” **SBOM + SLSA + Sigstore (Cosign)**
- âœ” **How to sign SBOMs with Cosign**
- âœ” **How SBOMs integrate into CI/CD (GitHub, GitLab, Azure, Jenkins)**
- âœ” **SBOMs for containers vs applications vs dependencies**

Just tell me!
