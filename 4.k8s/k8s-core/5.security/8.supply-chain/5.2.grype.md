# ğŸ›¡ï¸ **Grype â€“ Vulnerability Scanner for Container Images & SBOMs**

**Grype** is an **open-source vulnerability scanner** created by **Anchore**.
It scans:

- **Container images**
- **Filesystem directories**
- **SBOM files**
- **Repositories (OCI registries)**

â€¦to detect **known vulnerabilities (CVEs)** using a continuously updated vulnerability database.

Think of **Syft** + **Grype** as:

- **Syft** â†’ â€œWhat is inside the image?â€ (inventory of packages)
- **Grype** â†’ â€œAre those packages vulnerable?â€ (security scan)

---

## â­ Why Grype Is Important

Modern DevOps pipelines require:

- âœ” Secure container images
- âœ” Automated vulnerability scanning
- âœ” Early detection during CI/CD
- âœ” Compliance (NIST, SOC2, PCI, etc.)

Grype gives fast, accurate scans that work **locally**, **in CI**, or as part of your **Kubernetes security pipeline**.

---

## ğŸ“¦ What Grype Scans

Grype can scan **any of the following**:

| Type                           | Example                             |
| ------------------------------ | ----------------------------------- |
| **Container Images**           | `grype nginx:latest`                |
| **Local Docker Images**        | `grype docker:nginx:latest`         |
| **SBOM files**                 | `grype sbom:./sbom.json`            |
| **File systems / directories** | `grype /app`                        |
| **OCI registries**             | `grype registry:myrepo/myimage:1.0` |

---

## ğŸ” How Grype Finds Vulnerabilities

Grype uses these vulnerability sources:

- **Anchore Feed Service (default)**
- **NVD (National Vulnerability Database)**
- **Github Security Advisories**
- **Distro databases** (Alpine, Debian, Ubuntu, RHEL)
- **Language ecosystems**:

  - Python (PyPI)
  - Node.js (npm)
  - Java (Maven)
  - Go modules
  - Ruby gems
  - Rust crates

Grype automatically updates its vulnerability database **every day**.

---

## ğŸ§ª **Grype Flow (Simple Diagram)**

```mermaid
---
config:
  theme: dark
  look: handDrawn
title: "SBOM-Based Vulnerability Scanning"
---

flowchart TD
    A["ğŸ“¦ Image or SBOM"]
    B["ğŸ§¾ Syft SBOM<br><i>(optional â€” Grype can generate internally)</i>"]
    C["ğŸ§  Grype<br>Vulnerability Database"]
    D["ğŸ“Š Vulnerability Report"]

    A -->|Inventory of Packages| B
    B -->|Match packages to CVEs| C
    C --> D
```

---

## ğŸš€ **Installation**

### macOS (Homebrew)

```bash
brew install grype
```

### Linux (script)

```bash
curl -sSfL https://raw.githubusercontent.com/anchore/grype/main/install.sh \
  | sudo sh
```

### Windows

```bash
choco install grype
```

---

## ğŸ§¨ Basic Usage (Very Easy)

### 1ï¸âƒ£ Scan a Docker Image

```bash
grype nginx:latest
```

### 2ï¸âƒ£ Scan a local SBOM generated by Syft

```bash
syft myapp:1.0 -o json > sbom.json
grype sbom:sbom.json
```

### 3ï¸âƒ£ Scan a local directory

```bash
grype .
```

### 4ï¸âƒ£ Scan an image stored in a registry

```bash
grype registry:myrepo/myimage:latest
```

---

## ğŸ·ï¸ What a Grype Output Looks Like

Example:

```ini
NAME          INSTALLED  FIXED-IN   TYPE       VULNERABILITY
openssl       1.1.1n     1.1.1t     apk        CVE-2023-0286
busybox       1.31.1     1.33.0     binary     CVE-2021-42377
libxml2       2.9.10     2.9.12     rpm        CVE-2022-23308
```

Each row shows:

- Package name
- Installed version
- Vulnerable version
- Package type
- CVE ID
- Severity (low/medium/high/critical)

---

## âš™ï¸ Output Formats

You can export in many formats:

```bash
grype nginx:latest -o table
grype nginx:latest -o json
grype nginx:latest -o cyclonedx-json
grype nginx:latest -o sarif
```

SARIF is supported by GitHub Security Center.

---

## ğŸ¤ **Using Syft + Grype Together (Best Practice)**

### Step 1 â€” Generate SBOM with Syft

```bash
syft myimage:latest -o json > sbom.json
```

### Step 2 â€” Scan with Grype

```bash
grype sbom:sbom.json -o table
```

This is the best practice because:

- SBOM remains immutable
- Same SBOM can be scanned many times
- Compliance requires generated SBOMs for each build

---

## ğŸ§© Integration with CI/CD

You can integrate Grype into:

- **GitHub Actions**
- **GitLab CI**
- **Azure DevOps**
- **Jenkins**
- **Harness**
- **CircleCI**

Example GitHub Action:

```yaml
steps:
  - uses: anchore/grype-action@v1
    with:
      image: myapp:latest
      fail-on: critical
```

This pipeline fails if critical vulnerabilities exist.

---

## ğŸ” Policy Enforcement (Fail Build if Vulns Found)

Example:

```bash
grype nginx:latest --fail-on high
```

Supported levels:

`negligible | low | medium | high | critical`

---

## ğŸ§Š Example Use Cases

### âœ” DevSecOps Pipeline Enforcement

Break CI builds on high vulnerabilities.

### âœ” Kubernetes Image Admission

Scan before deploying to cluster.

### âœ” Security Compliance Reports

Generate daily/weekly vulnerability reports.

### âœ” Supply Chain Protection

Use SBOM â†’ Compare â†’ Scan â†’ Enforce.

---

## ğŸ†š **Grype vs. Trivy (Quick Comparison)**

| Feature             | Grype            | Trivy       |
| ------------------- | ---------------- | ----------- |
| SBOM-first workflow | â­ Strong        | Good        |
| Accuracy            | â­ High          | High        |
| Speed               | Medium           | Fast        |
| Scan Filesystem     | Yes              | Yes         |
| Scan Git Repos      | No               | Yes         |
| Policy engine       | Basic            | Advanced    |
| Ecosystem scanning  | Strong with Syft | Very strong |

---

## ğŸ¯ Summary (Easy to Remember)

- **Grype = Vulnerability Scanner**
- **Syft = SBOM Generator**
- Grype scans:

  - Images
  - SBOMs
  - Filesystems
  - Registries

- Supports many output formats
- Perfect for DevSecOps pipelines
- Uses well-known vulnerability databases
- Fast, accurate, open-source

---

If you'd like, I can also give you:

âœ… Full Diagram-based Explanation
âœ… Grype vs Syft Cheat Sheet
âœ… Step-by-step practical labs (Docker + CI/CD)
âœ… How to integrate Grype into Azure DevOps or GitHub Actions

Just tell me!
