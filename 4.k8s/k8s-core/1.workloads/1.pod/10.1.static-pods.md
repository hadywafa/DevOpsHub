# 🧺 **Static Pods — The Simple Explanation**

> _Static Pods are Pods **managed directly by the kubelet**, not by the API Server or controllers._

They are mostly used for **bootstrapping control-plane components** (like `kube-apiserver`, `etcd`, `kube-scheduler`, etc.) before the full Kubernetes cluster is ready.

---

## ⚙️ **Normal Pod vs Static Pod**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Feature                        | **Normal Pod**          | **Static Pod**                     |
| ------------------------------ | ----------------------- | ---------------------------------- |
| Created by                     | API Server              | Kubelet directly                   |
| Defined in                     | etcd (via API Server)   | YAML file on the node’s filesystem |
| Managed by                     | Controller Manager      | Kubelet only                       |
| Visible via `kubectl get pods` | ✅ Yes                  | ✅ Yes (but as “mirror pods”)      |
| Deleted from API               | Controller recreates it | Node recreates it                  |
| Commonly used for              | Apps in the cluster     | Core system components             |

</div>

---

## ⁉️ **Where They Come From**

Each **kubelet** on a node can be told:

> “Watch a folder on disk for pod YAML files.”

That folder is usually:

```ini
/etc/kubernetes/manifests/
```

Any YAML file you put in there becomes a **Static Pod** automatically.

---

## 🔧 **How It Works**

Let’s say your node has a file:

```bash
/etc/kubernetes/manifests/etcd.yaml
```

When kubelet starts, it:

1. Reads the file.
2. Creates the Pod locally (without talking to the API server).
3. Keeps watching the file — if it changes, the Pod restarts automatically.

✅ So kubelet = “mini-controller” for that Pod.

---

## 🧠 **Mirror Pods**

Even though static pods are not created through the API server,
the kubelet **creates a copy (mirror)** in the API server — so you can see it in `kubectl`.

For example:

```bash
kubectl get pods -n kube-system
```

You’ll see:

```ini
kube-apiserver-node1
kube-controller-manager-node1
etcd-node1
```

But these are just **mirror pods** — you can view them, but you **can’t delete** them with `kubectl delete pod`.

If you try:

```ini
kubectl delete pod kube-apiserver-node1 -n kube-system
```

You’ll get:

```ini
pod "kube-apiserver-node1" deleted
```

…but the kubelet will **recreate it immediately**, because the YAML still exists in `/etc/kubernetes/manifests`.

---

## 🧩 **Example — Creating a Static Pod**

Let’s say you create this YAML file:

```yaml
# /etc/kubernetes/manifests/nginx-static.yaml
apiVersion: v1
kind: Pod
metadata:
  name: nginx-static
  namespace: default
spec:
  containers:
    - name: nginx
      image: nginx
      ports:
        - containerPort: 80
```

Then restart the kubelet:

```bash
sudo systemctl restart kubelet
```

Now run:

```bash
kubectl get pods -A
```

You’ll see:

```ini
NAMESPACE   NAME                 READY   STATUS    NODE
default     nginx-static-node1   1/1     Running   node1
```

✅ That’s your static pod running, created directly by kubelet.

---

## 🎯 **Where They’re Used in Real Life**

Static Pods are most commonly used to run **Kubernetes control-plane components** before the cluster is fully functional:

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Component               | Static Pod File                                          |
| ----------------------- | -------------------------------------------------------- |
| kube-apiserver          | `/etc/kubernetes/manifests/kube-apiserver.yaml`          |
| etcd                    | `/etc/kubernetes/manifests/etcd.yaml`                    |
| kube-controller-manager | `/etc/kubernetes/manifests/kube-controller-manager.yaml` |
| kube-scheduler          | `/etc/kubernetes/manifests/kube-scheduler.yaml`          |

</div>

---

> ✅ Tools like **kubeadm** automatically create these files when initializing the cluster.

---

## ⚙️ **Lifecycle Behavior**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Event                           | What Happens                                               |
| ------------------------------- | ---------------------------------------------------------- |
| You modify the YAML file        | Kubelet restarts the Pod automatically                     |
| You delete the YAML file        | Kubelet deletes the Pod                                    |
| You restart the kubelet service | It re-creates Pods from the manifest files                 |
| API Server goes down            | Static Pods keep running (they don’t depend on API server) |

</div>

---

## 🔍 **View & Debug Commands**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Command                             | Description                               |
| ----------------------------------- | ----------------------------------------- |
| `kubectl get pods -A`               | See mirror pods                           |
| `sudo ls /etc/kubernetes/manifests` | List static pod definitions               |
| `sudo crictl ps`                    | See real containers running on the node   |
| `kubectl describe pod <name>`       | Check mirror pod details                  |
| `journalctl -u kubelet`             | Logs showing kubelet managing static pods |

</div>

---

## 🧠 **Why Are They Important?**

- They **bootstrap** the cluster when the API server isn’t ready yet.
- They **run independently** from the control plane.
- They ensure critical components like etcd and API server are **always alive**, even if the API itself crashes.
- They can be used in **disaster recovery** to bring the API back manually.

---

## 💭 **Analogy**

Imagine Kubernetes is a city:

- 🏗️ **Static Pods** = city infrastructure (power plant, water system) that runs no matter what.
- 🏢 **Normal Pods** = regular buildings managed by the city council (API server).

Even if the city council goes offline, power and water keep running — thanks to the static pods.

---

## ✅ **Summary**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Concept                      | Description                                        |
| ---------------------------- | -------------------------------------------------- |
| **Static Pod**               | Pod defined directly on a node (YAML file on disk) |
| **Managed by**               | Kubelet only                                       |
| **Visible in kubectl**       | As mirror pods                                     |
| **Control Plane Components** | Often run as static pods                           |
| **Path**                     | `/etc/kubernetes/manifests/`                       |
| **Useful for**               | Bootstrapping, recovery, node-level control        |

</div>
