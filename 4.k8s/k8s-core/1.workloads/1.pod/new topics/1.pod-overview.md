# ‚ò∏Ô∏è **Kubernetes Pods 101** ‚Äî Creation, Inspection & Lifecycle (Admin Essentials)

## üéØ **Goal**

Learn how to **create**, **manage**, and **inspect** pods ‚Äî the **smallest deployable unit** in Kubernetes.
You‚Äôll master every admin command and YAML field needed to manage pods confidently.

---

## üìñ **What is a Pod**

A **Pod** is the **smallest deployable unit** in Kubernetes that represents one or more containers running together on the same node.
They share:

- **Network namespace** (same IP, ports)
- **Storage volumes**
- **Lifecycle**

üí° Think of a Pod as a **wrapper** around your containers ‚Äî managing them as one logical unit.

---

## ‚öôÔ∏è **Pod Creation Methods**

You can create pods in 3 main ways:

### üü¢ A. Imperative (`kubectl run`)

```bash
kubectl run nginx --image=nginx
```

‚úÖ Creates a pod named `nginx` using the latest nginx image.  
‚ö†Ô∏è In newer Kubernetes versions, this creates a **Pod**, not a Deployment.

List pods:

```bash
kubectl get pods
```

---

### üü° B. Declarative (YAML File)

**pod.yaml:**

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: myapp
  labels:
    app: myapp
spec:
  containers:
    - name: myapp-container
      image: nginx:latest
      ports:
        - containerPort: 80
```

Apply it:

```bash
kubectl apply -f pod.yaml
```

Check:

```bash
kubectl get pods
```

---

### üîµ C. From a Template

```bash
kubectl run nginx --image=nginx --dry-run=client -o yaml > pod.yaml
```

Edit the YAML, then apply it.  
üß† Great trick for generating base manifests fast.

---

## üîé **Inspecting Pods**

### List All Pods

```bash
kubectl get pods
```

Add namespace:

```bash
kubectl get pods -n development
```

Get wide info (IP, node, status):

```bash
kubectl get pods -o wide
```

---

### Describe a Pod

```bash
kubectl describe pod myapp
```

Outputs detailed info:

- Node name
- Labels
- Containers
- Events (critical for troubleshooting)

---

### Get Pod YAML

```bash
kubectl get pod myapp -o yaml
```

Perfect for learning real configurations and debugging.

---

### Check Pod Logs

```bash
kubectl logs myapp
kubectl logs -f myapp
```

For multi-container pods:

```bash
kubectl logs myapp -c container-name
```

---

### Exec into a Pod (Interactive Debugging)

```bash
kubectl exec -it myapp -- bash
```

If container uses a minimal image:

```bash
kubectl exec -it myapp -- sh
```

---

## üîÑ **Pod Lifecycle Phases**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Phase         | Description                                                                                   |
| ------------- | --------------------------------------------------------------------------------------------- |
| **Pending**   | Kubernetes accepted the pod but it‚Äôs not scheduled yet (waiting for image pull or resources). |
| **Running**   | At least one container is running successfully.                                               |
| **Succeeded** | All containers terminated successfully (non-restartable).                                     |
| **Failed**    | At least one container terminated with an error.                                              |
| **Unknown**   | The node can‚Äôt be reached or status is unclear.                                               |

</div>

Check phase:

```bash
kubectl get pod myapp -o jsonpath='{.status.phase}'
```

---

## üîÅ **Pod Restart Policies**

Defined in `.spec.restartPolicy`
Options:

- **Always** (default): Restarts automatically ‚Äî typical for long-running apps.
- **OnFailure**: Restarts only if containers exit non-zero (good for Jobs).
- **Never**: Never restarts ‚Äî used for debugging/test pods.

Example:

```yaml
spec:
  restartPolicy: OnFailure
```

---

## üè∑Ô∏è **Labels**, **Selectors**, and **Annotations**

Add labels when creating:

```bash
kubectl run nginx --image=nginx --labels="env=dev,app=frontend"
```

List with labels:

```bash
kubectl get pods --show-labels
```

Filter:

```bash
kubectl get pods -l app=frontend
```

Add or modify later:

```bash
kubectl label pod nginx tier=frontend --overwrite
```

Add annotation (for metadata):

```bash
kubectl annotate pod nginx owner="ahmed@company.com"
```

---

## üëØ‚Äç‚ôÇÔ∏è **Multi-Container Pods**

Use when containers **must share network/storage** (e.g., app + sidecar).

Example:

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: sidecar-example
spec:
  containers:
    - name: web
      image: nginx
    - name: log-agent
      image: busybox
      command: ["sh", "-c", "tail -f /var/log/nginx/access.log"]
```

‚úÖ Both containers share the same `/var/log` volume and network namespace.

---

## üõª **Init Containers**

Run **before main containers**, typically for setup tasks.

Example:

```yaml
spec:
  initContainers:
    - name: init-script
      image: busybox
      command: ["sh", "-c", "echo Init complete > /work-dir/message"]
  containers:
    - name: app
      image: nginx
      volumeMounts:
        - name: workdir
          mountPath: /usr/share/nginx/html
  volumes:
    - name: workdir
      emptyDir: {}
```

Check init container status:

```bash
kubectl get pod sidecar-example -o jsonpath='{.status.initContainerStatuses[*].state}'
```

---

## üß∞ **Useful Admin Commands Cheat Sheet**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Task          | Command                                              |
| ------------- | ---------------------------------------------------- |
| Create Pod    | `kubectl run myapp --image=nginx`                    |
| Apply YAML    | `kubectl apply -f pod.yaml`                          |
| List Pods     | `kubectl get pods`                                   |
| Describe Pod  | `kubectl describe pod myapp`                         |
| View Logs     | `kubectl logs myapp`                                 |
| Exec into Pod | `kubectl exec -it myapp -- bash`                     |
| Delete Pod    | `kubectl delete pod myapp`                           |
| Export YAML   | `kubectl get pod myapp -o yaml`                      |
| Restart Pod   | `kubectl delete pod myapp` (controller recreates it) |
| Watch changes | `kubectl get pods -w`                                |

</div>

---

## üî¥ **Common Issues & Fixes**

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Problem               | Root Cause                       | Fix                                            |
| --------------------- | -------------------------------- | ---------------------------------------------- |
| **CrashLoopBackOff**  | Container keeps crashing         | Check logs: `kubectl logs <pod>`               |
| **ImagePullBackOff**  | Image name/auth invalid          | Verify image name and registry credentials     |
| **Pending**           | No node fits the Pod             | Check resources: `kubectl describe pod <name>` |
| **Evicted**           | Node under pressure              | Free disk/CPU, reschedule                      |
| **Completed**         | Job/Pod finished normally        | Normal for short-lived pods                    |
| **ContainerCreating** | Slow image pull or volume attach | Check node status and kubelet logs             |

</div>

---

## üß™ **Pod Restart Behavior**

Pods themselves **don‚Äôt restart** ‚Äî their **containers** do.
If you delete a pod manually:

```bash
kubectl delete pod myapp
```

Controllers like **Deployments** or **ReplicaSets** recreate it automatically.  
Standalone pods (no controller) won‚Äôt come back.

---

## ‚úçüèª **Admin Quick Tests** (Hands-On)

1Ô∏è‚É£ Create a Pod:

```bash
kubectl run testpod --image=nginx
```

2Ô∏è‚É£ Check IP and Node:

```bash
kubectl get pod testpod -o wide
```

3Ô∏è‚É£ Enter Pod:

```bash
kubectl exec -it testpod -- bash
```

4Ô∏è‚É£ Check Logs:

```bash
kubectl logs testpod
```

5Ô∏è‚É£ Delete It:

```bash
kubectl delete pod testpod
```

---

## üß≠ Next Deep Dives (Related Topics)

1Ô∏è‚É£ **Pods 102: Probes, Health & Graceful Shutdown**
2Ô∏è‚É£ **Pods 103: Scheduling, Placement & Disruption**
3Ô∏è‚É£ **Pods 104: Resource Limits & QoS**
4Ô∏è‚É£ **Pods 105: Networking & Storage at Pod Level**
5Ô∏è‚É£ **Pods 106: Debugging & Recovery Techniques**
