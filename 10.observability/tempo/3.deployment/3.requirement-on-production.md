# ðŸš€ **Production Environment â€“ Grafana Tempo (Azure)**

This guide provides a **worst-case production cost calculation** for **Grafana Tempo** based on ingestion rate, retention, and high availability requirements.

> This is a **budget-safe upper bound**. Real cost is usually lower.

---

## ðŸ›’ **Requirements**

## ðŸ§± **Cluster Sizing (based on Tempo guidelines)**

> Derived from Grafana Tempo sizing guidance and rounded up for HA, [References](https://grafana.com/docs/tempo/latest/set-up-for-tracing/setup-tempo/plan/size/)

### ðŸ“Œ **Replicas**

| Component      | Recommended       | Final |
| -------------- | ----------------- | ----- |
| Distributor    | 1 per 10 MB/s     | **1** |
| Ingester       | 1 per 3â€“5 MB/s    | **1** |
| Querier        | 1 per 1â€“2 MB/s    | **1** |
| Query-Frontend | 2 replicas for HA | **2** |
| Compactor      | 1 per 3â€“5 MB/s    | **1** |

---

### ðŸ“Œ **Resources (requests â†’ limits)**

| Component      | CPU   | Memory |
| -------------- | ----- | ------ |
| Distributor    | `2`   | `2Gi`  |
| Ingester       | `2.5` | `4Gi`  |
| Querier        | `1`   | `4Gi`  |
| Query-Frontend | `1`   | `4Gi`  |
| Compactor      | `1`   | `4Gi`  |

---

### ðŸ“Œ **PVCs**

(Tempo data itself lives in Blob Storage)
Used **only for WAL and compactor working directories**

| Component    | PVC Size | Tier | Replicas |
| ------------ | -------- | ---- | -------- |
| Ingester WAL | 30 Gi    | E4   | 1        |
| Compactor    | 10 Gi    | E2   | 1        |

> ðŸ“Œ **Worst-Case Disk Pricing Rule**  
> **Always use â€œMax total price per monthâ€**
> (transaction charges are capped)

---

## ðŸ’° **Total Monthly Cost â€“ Azure (UAE North)**

> Prices based on official Azure pricing pages
> Currency: **USD**

---

### ðŸ“Œ **1. Managed Disks Cost â€” `$16.65`**

> Azure Managed Disks â€“ Standard SSD ZRS

1. **Ingester WAL**
   - 1 Ã— E4 @ `$13.23` = **$13.23**

2. **Compactor**
   - 1 Ã— E2 @ `$3.33` = **$3.33**

âœ… **Total Disk Cost:**
**`$16.65`**

---

## ðŸ’° **Final Production Cost (Azure)**

| Category      | Cost                  |
| ------------- | --------------------- |
| Managed Disks | $31.34                |
| Blob Storage  | $98.59                |
| **TOTAL**     | **`$129.93 / month`** |

> âœ… Rounded and reported as **`$130 / month`**

---

## ðŸ“Ž Notes & Assumptions

- Costs **exclude**:
  - AKS nodes / VM compute
  - Network egress
  - Azure Monitor / Log Analytics
  - Redis / Memcached (if used)

- Smart Tier **can only reduce cost**, never increase it
- ZRS cost already includes multi-AZ replication (no multiplication)

---

## ðŸ’° **AWS Comparison (placeholder)**

> Same workload using S3 + gp3 + EKS

**Estimated:** `$??`
(To be calculated via AWS Pricing Calculator)
