# Size Estimate **logs** and **traces**

## 1. Estimating trace storage

### 1.1. Step 1 – Estimate trace size per request

1. **Estimate spans per request**
   - **Light flow:** 5–15 spans
   - **Medium:** 15–40 spans
   - **Heavy (microservices, DB, queues):** 40–100+ spans

2. **Estimate size per span**
   - Typical: **1–3 KB per span** (IDs, attributes, events)

3. **Compute average trace size**

   $$
   \text{Trace Size} \approx \text{Spans per Trace} \times \text{KB per Span}
   $$

   Example:
   - 30 spans × 2 KB ≈ **60 KB per trace**

Pick a **planning number** (e.g. 50–100 KB/trace).

---

### 1.2. Step 2 – Apply RPS and sampling

Define:

- \( R \) = requests per second (RPS)
- \( T \) = sampling rate (1.0 = 100%, 0.05 = 5%)
- \( Z\_{\text{trace}} \) = average trace size (KB)
- \( D \) = seconds per day = 86400

**Daily trace volume:**

$$
V*{\text{trace,day}} = R \cdot T \cdot D \cdot Z*{\text{trace}}
$$

**Retention (N days):**

$$
V*{\text{trace,total}} = N \cdot V*{\text{trace,day}}
$$

You can plug in any RPS, sampling, and retention.

---

## 2. Estimating log storage

### 2.1. Option A – Quick “per service per day” model

This is fastest for planning:

- **Light service:** 1–3 GB/day
- **Medium:** 3–10 GB/day
- **Heavy (API, billing, gateway):** 10–30+ GB/day

Then:

$$
V\_{\text{logs,day}} = \sum (\text{GB/day per service})
$$

$$
V*{\text{logs,total}} = V*{\text{logs,day}} \cdot N
$$

Where \( N \) = retention days.

---

### 2.2. Option B – More precise, based on log lines

If you know logging behavior:

1. **Estimate log lines per request**
   - Light: 5–10
   - Medium: 10–50
   - Heavy: 50–200

2. **Estimate size per log line**
   - Plain text: ~0.2–0.5 KB
   - JSON: ~0.5–2 KB

3. **Compute logs per request**

   $$
   \text{KB per Request} \approx \text{Lines per Request} \times \text{KB per Line}
   $$

4. **Apply RPS and retention**

Let:

- \( R \) = RPS
- \( Z\_{\text{log}} \) = KB logs per request
- \( D = 86400 \) seconds/day

**Daily log volume:**

$$
V*{\text{logs,day}} = R \cdot D \cdot Z*{\text{log}}
$$

**Retention (N days):**

$$
V*{\text{logs,total}} = N \cdot V*{\text{logs,day}}
$$

---

## 3. Practical rules of thumb

- **Traces:**
  - Use **50–100 KB per trace** as a default.
  - Always include **sampling** in the formula.
- **Logs:**
  - For quick planning: **3–10 GB/day per active microservice**.
  - JSON + DEBUG + payloads → use the high end (10–30 GB/day).

---

## 4. How to reuse this for any new app

For a new system, just answer:

1. **RPS?** (min/avg/peak)
2. **Spans per request?** (rough: light/medium/heavy)
3. **Sampling rate for traces?**
4. **Log verbosity?** (INFO vs DEBUG, JSON vs text)
5. **Retention days?**

Then plug into:

- Traces:
  $$
  R, T, Z*{\text{trace}}, N \Rightarrow V*{\text{trace,total}}
  $$
- Logs:  
  Either **GB/day per service × services × N**,  
  or **R, Z*{\text{log}}, N \Rightarrow V*{\text{logs,total}}**.
