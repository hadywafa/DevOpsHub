# üß© **Prometheus Stack Helm chart Components**

## üìå **1.Prometheus Stack CRD Components**

This section lists all **Custom Resource Definitions (CRDs)** installed and managed by the **Prometheus Operator** as part of the Prometheus Stack Helm chart (`kube-prometheus-stack`).  
These CRDs extend the Kubernetes API to let Prometheus dynamically discover scrape targets, alerting rules, and configuration objects.

---

### üß† 1.Core Monitoring CRDs

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| CRD Kind       | API Group               | Purpose / Description                                                           |
| -------------- | ----------------------- | ------------------------------------------------------------------------------- |
| `Prometheus`   | `monitoring.coreos.com` | Defines a Prometheus instance (replicas, retention, resources, storage, etc.).  |
| `Alertmanager` | `monitoring.coreos.com` | Defines an Alertmanager cluster, including replicas and configuration.          |
| `ThanosRuler`  | `monitoring.coreos.com` | Defines a Thanos Ruler instance for evaluating rules in a Thanos-enabled setup. |

</div>

> These are the **main managed workloads**.
> The Prometheus Operator watches these CRDs and automatically creates StatefulSets and Services accordingly.

---

### üì° 2.Metric Discovery CRDs

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| CRD Kind         | API Group               | Purpose / Description                                                                 |
| ---------------- | ----------------------- | ------------------------------------------------------------------------------------- |
| `ServiceMonitor` | `monitoring.coreos.com` | Defines how to scrape metrics from a Kubernetes Service (selectors, endpoints, etc.). |
| `PodMonitor`     | `monitoring.coreos.com` | Defines how to scrape metrics from individual Pods directly (useful for sidecars).    |
| `Probe`          | `monitoring.coreos.com` | Defines blackbox probing configuration (HTTP, TCP, ICMP) for synthetic monitoring.    |

</div>

> These CRDs **replace manual Prometheus scrape configs** ‚Äî they automatically register scrape targets based on label selectors and endpoints.

---

### üì£ 3.Alerting & Rule Management CRDs

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| CRD Kind         | API Group               | Purpose / Description                                                |
| ---------------- | ----------------------- | -------------------------------------------------------------------- |
| `PrometheusRule` | `monitoring.coreos.com` | Defines alerting and recording rules for Prometheus and ThanosRuler. |

</div>

> This CRD centralizes PromQL rule management ‚Äî enabling operators to create modular, version-controlled rule definitions.

---

### üîê 4.Secret Management CRDs

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| CRD Kind             | API Group               | Purpose / Description                                                                  |
| -------------------- | ----------------------- | -------------------------------------------------------------------------------------- |
| `AlertmanagerConfig` | `monitoring.coreos.com` | Defines Alertmanager routes, receivers, and notification templates within the cluster. |

</div>

> This allows **multi-tenant alert routing** and lets each team manage their own alert configuration securely without touching the global Alertmanager config.

---

### üß† Conceptual Diagram

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

```mermaid
graph TD
  A[Prometheus Operator] --> B[Prometheus CRD]
  A --> C[Alertmanager CRD]
  A --> D[ServiceMonitor CRD]
  A --> E[PodMonitor CRD]
  A --> F[PrometheusRule CRD]
  A --> G[AlertmanagerConfig CRD]
  A --> H[Probe CRD]
  A --> I[ThanosRuler CRD]

  B --> B1[Prometheus StatefulSet]
  C --> C1[Alertmanager StatefulSet]
  D --> B
  E --> B
  F --> B
  G --> C
  I --> I1[Thanos Ruler Deployment]
```

</div>

---

> The **Prometheus Operator** is the central controller that continuously watches these CRDs and reconciles their desired state into actual Kubernetes objects such as Deployments, StatefulSets, Services, and ConfigMaps.

---

## üìå **2.Prometheus Stack DaemonSet Components**

This section lists **DaemonSets** created by the Prometheus Stack Helm chart.

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| DaemonSet Name                        | Description                                                                                |
| ------------------------------------- | ------------------------------------------------------------------------------------------ |
| `prometheus-prometheus-node-exporter` | Runs on every node to collect system-level metrics such as CPU, memory, disk, and network. |

</div>

> The Node Exporter DaemonSet ensures **node-level observability** by deploying one pod per node.

---

## üìå **3.Prometheus Stack StatefulSet Components**

This section lists **StatefulSets** created by the Prometheus Stack Helm chart.

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| StatefulSet Name                          | Description                                                                      |
| ----------------------------------------- | -------------------------------------------------------------------------------- |
| `prometheus-kube-prometheus-prometheus`   | The main Prometheus server that scrapes metrics and stores time series data.     |
| `prometheus-kube-prometheus-alertmanager` | The Alertmanager cluster responsible for managing, grouping, and routing alerts. |

</div>

> StatefulSets ensure **stable pod identities and persistent storage**, which is crucial for Prometheus and Alertmanager reliability and data durability.

---

## üìå **4.Prometheus Stack Deploy Components**

This section lists all **Kubernetes Deployments** created by the Prometheus Stack Helm chart, grouped by function.

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Deployment Name                       | Description                                                                                        |
| ------------------------------------- | -------------------------------------------------------------------------------------------------- |
| `prometheus-kube-prometheus-operator` | The Prometheus Operator that manages CRDs like `Prometheus`, `Alertmanager`, and `ServiceMonitor`. |
| `prometheus-grafana`                  | Grafana dashboard UI for visualizing Prometheus metrics and alerts.                                |
| `prometheus-kube-state-metrics`       | Collects Kubernetes object-level metrics (pods, deployments, services, etc.).                      |

</div>

> These Deployments handle **control plane, visualization, and validation logic** ‚Äî they are typically stateless and can be scaled horizontally.

---

## üìå **5.Prometheus Stack Svc Components**

This section categorizes all Kubernetes services created by the Prometheus stack, grouped by their functional roles for clarity and future expansion (e.g. deployments, statefulsets, etc.).

---

### üîß Core Prometheus Services

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Service Name                            | Type      | Port     | Description                                                           |
| --------------------------------------- | --------- | -------- | --------------------------------------------------------------------- |
| `prometheus-kube-prometheus-prometheus` | ClusterIP | 9090/TCP | The main Prometheus server that scrapes metrics and serves the UI/API |
| `prometheus-operated`                   | Headless  | 9090/TCP | Internal service used by the operator to manage the Prometheus pod    |

</div>

> These two are tightly linked ‚Äî `prometheus-operated` is a headless service created by the operator to access the Prometheus pod directly.

---

### üß† Operator Service

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Service Name                          | Type      | Port    | Description                                                                                         |
| ------------------------------------- | --------- | ------- | --------------------------------------------------------------------------------------------------- |
| `prometheus-kube-prometheus-operator` | ClusterIP | 443/TCP | The Prometheus Operator that manages CRDs like `Prometheus`, `Alertmanager`, `ServiceMonitor`, etc. |

</div>

> This is the brain of the stack ‚Äî it watches CRDs and configures Prometheus and Alertmanager accordingly.

---

### üì£ Alertmanager Services

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Service Name                              | Type      | Port(s)                | Description                                                      |
| ----------------------------------------- | --------- | ---------------------- | ---------------------------------------------------------------- |
| `prometheus-kube-prometheus-alertmanager` | ClusterIP | 9093/TCP               | Public-facing Alertmanager service for Prometheus to send alerts |
| `alertmanager-operated`                   | Headless  | 9093/TCP, 9094/TCP/UDP | Internal service used by the operator to configure Alertmanager  |

</div>

> Just like Prometheus, Alertmanager has a public-facing service and an internal `-operated` service for operator access.

---

### üìä Visualization

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Service Name         | Type      | Port   | Description                                                        |
| -------------------- | --------- | ------ | ------------------------------------------------------------------ |
| `prometheus-grafana` | ClusterIP | 80/TCP | Grafana dashboard UI for visualizing Prometheus metrics and alerts |

</div>

> Grafana connects to Prometheus and optionally Alertmanager to display dashboards and alerts.

---

### üì¶ Metric Sources

<div align="center" style="background-color: #141a19ff;color: #a8a5a5ff; border-radius: 10px; border: 2px solid">

| Service Name                          | Type      | Port     | Description                                                           |
| ------------------------------------- | --------- | -------- | --------------------------------------------------------------------- |
| `prometheus-prometheus-node-exporter` | ClusterIP | 9100/TCP | Exposes node-level metrics like CPU, memory, and disk                 |
| `prometheus-kube-state-metrics`       | ClusterIP | 8080/TCP | Exposes Kubernetes object metrics (e.g., pods, deployments, services) |

</div>

> These are scraped by Prometheus via `ServiceMonitor` resources.
